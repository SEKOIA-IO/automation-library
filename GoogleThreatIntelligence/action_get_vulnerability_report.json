{
  "uuid": "b7c2d8e9-5f3a-4d2f-8e1b-7a6c5b4d3f55",
  "name": "Get Vulnerability Report",
  "description": "Retrieve a CVE vulnerability report from Google Threat Intelligence",
  "docker_parameters": "get_vulnerability_report",
  "arguments": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "properties": {
      "cve": {
        "type": "string",
        "description": "CVE query (e.g. CVE-2021-34527)"
      }
    },
    "required": ["cve"]
  },
  "results": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "Vulnerability Report Results",
    "properties": {
      "success": { "type": "boolean" },
      "data": {
        "type": "object",
        "properties": {
          "vuln_id": {
            "type": "string",
            "description": "Identifier of the vulnerability (vuln_id) used in the path"
          },
          "cve": {
            "type": "string",
            "description": "The assigned CVE identifier (e.g. CVE-2021-34527)"
          },
          "description": {
            "type": "string",
            "description": "Textual description of the vulnerability"
          },
          "published_date": {
            "type": "string",
            "format": "date-time",
            "description": "Publication timestamp of the vulnerability"
          },
          "last_modified": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp of the vulnerability record"
          },
          "cvss": {
            "type": "object",
            "properties": {
              "base_score": {
                "type": "number",
                "description": "CVSS base score (e.g. 9.8)"
              },
              "vector": {
                "type": "string",
                "description": "CVSS vector string (e.g. AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)"
              },
              "version": {
                "type": "string",
                "description": "CVSS version (e.g. 3.1)"
              }
            },
            "required": ["base_score","vector","version"]
          },
          "affected_products": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "vendor": { "type": "string" },
                "product": { "type": "string" },
                "version": { "type": "string" },
                "status": {
                  "type": "string",
                  "description": "Status of vulnerability for the product (e.g. vulnerable, not vulnerable, unknown)"
                }
              },
              "required": ["vendor","product","version"]
            },
            "description": "List of products/vendors affected by this vulnerability"
          },
          "references": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "url": { "type": "string", "format": "uri" },
                "source": { "type": "string" },
                "description": { "type": "string" }
              },
              "required": ["url"]
            },
            "description": "External references (advisories, vendor bulletins, technical analysis)"
          },
          "remediation": {
            "type": "object",
            "properties": {
              "description": {
                "type": "string",
                "description": "Suggested remediation or workaround for the vulnerability"
              },
              "patch_available": {
                "type": "boolean",
                "description": "Flag indicating whether a patch is available"
              },
              "patch_link": {
                "type": "string",
                "format": "uri",
                "description": "URL to vendor patch or browser advisory"
              }
            },
            "required": ["description"]
          },
          "metadata": {
            "type": "object",
            "properties": {
              "source_identifier": {
                "type": "string",
                "description": "Identifier of the data source (e.g. NVD, vendor, third-party)"
              },
              "tags": {
                "type": "array",
                "items": { "type": "string" },
                "description": "List of tags associated with the vulnerability (e.g. ‘disputed’, ‘exploit exists’)"
              }
            }
          }
        },
        "required": ["vuln_id","cve","description","published_date","cvss","affected_products"]
      }
    }
  },
  "slug": "get_vulnerability_report_in_gti"
}
