{
  "uuid": "fe3aa9b9-e922-4dcf-a3d5-c05a491f1c74",
  "name": "Scan File",
  "description": "Upload a file for scanning to Google Threat Intelligence (VirusTotal)",
  "docker_parameters": "scan_file",
  "arguments": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "properties": {
      "file_path": {
        "type": "string",
        "description": "Local path to the file to scan"
      }
    },
    "required": ["file_path"]
  },
  "results": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "Scan File Results",
    "properties": {
      "success": { "type": "boolean" },
      "data": {
        "type": "object",
        "properties": {
          "file_id": {
            "type": "string",
            "description": "Unique identifier for the file entry"
          },
          "file_name": {
            "type": "string",
            "description": "Original file name (if available)"
          },
          "file_hash": {
            "type": "string",
            "description": "Hash of the file (e.g. SHA-256) used to uniquely identify it"
          },
          "submitted_date": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the file was submitted or ingested"
          },
          "last_scanned": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of the last scan/analysis of the file"
          },
          "threat_score": {
            "type": "number",
            "description": "Numeric threat rating for the file (higher = more dangerous)"
          },
          "status": {
            "type": "string",
            "description": "Current status (e.g. benign, malicious, unknown)"
          },
          "file_size": {
            "type": "integer",
            "description": "File size in bytes"
          },
          "file_type": {
            "type": "string",
            "description": "MIME type or detected file type"
          },
          "metadata": {
            "type": "object",
            "properties": {
              "source": {
                "type": "string",
                "description": "Data source or feed name"
              },
              "tags": {
                "type": "array",
                "items": { "type": "string" },
                "description": "List of tags or labels applied to the file"
              }
            }
          },
          "references": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "url": { "type": "string", "format": "uri" },
                "description": { "type": "string" }
              },
              "required": ["url"]
            },
            "description": "External references (e.g. vendor advisory, sandbox report link)"
          }
        },
        "required": ["file_id","file_hash","submitted_date","status"]
      }
    }
  },
  "slug": "scan_file_in_gti"
}
