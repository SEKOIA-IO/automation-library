{
  "uuid": "c2f9b6a2-7a4c-4d9d-bb2f-5f9ef6b0a222",
  "name": "Get Vulnerability Associations",
  "description": "Retrieve vulnerabilities associated with an IP from Google Threat Intelligence",
  "docker_parameters": "get_vulnerability_assocations",
  "arguments": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "properties": {
      "ip": {
        "type": "string",
        "description": "IP address to query (e.g., 8.8.8.8)",
        "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"
      },
      "domain": {
        "type": "string",
        "description": "Domain name to query (e.g., google.com)",
        "pattern": "^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?\\.[a-zA-Z]{2,}$"
      },
      "url": {
        "type": "string",
        "description": "URL to query (e.g., https://example.com/path)",
        "format": "uri"
      },
      "file_hash": {
        "type": "string",
        "description": "File hash to query (MD5, SHA1, or SHA256)",
        "pattern": "^[a-fA-F0-9]{32}$|^[a-fA-F0-9]{40}$|^[a-fA-F0-9]{64}$"
      }
    },
    "oneOf": [
      {"required": ["ip"]},
      {"required": ["domain"]},
      {"required": ["url"]},
      {"required": ["file_hash"]}
    ]
  },
  "results": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "Vulnerability Associations Results",
    "properties": {
      "success": { "type": "boolean" },
      "data": {
        "type": "object",
        "description": "Container for vulnerability association data",
        "properties": {
          "vulnerabilities_count": {
            "type": "integer",
            "description": "Total number of vulnerabilities associated with the entity"
          },
          "unique_cves_count": {
            "type": "integer",
            "description": "Number of unique CVE identifiers found"
          },
          "high_severity_count": {
            "type": "integer",
            "description": "Number of HIGH or CRITICAL severity vulnerabilities"
          },
          "entity": {
            "type": "string",
            "description": "The entity (IP, domain, or file) that was queried"
          },
          "entity_type": {
            "type": "string",
            "description": "Type of entity queried",
            "enum": ["ip_addresses", "domains", "files"]
          },
          "cve_ids": {
            "type": "array",
            "description": "List of unique CVE identifiers found",
            "items": {
              "type": "string",
              "pattern": "^CVE-[0-9]{4}-[0-9]+$"
            }
          },
          "vulnerabilities": {
            "type": "array",
            "description": "Array of vulnerability objects",
            "items": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "description": "Type of the object (always 'vulnerability')",
                  "enum": ["vulnerability"]
                },
                "id": {
                  "type": "string",
                  "description": "Unique identifier for the vulnerability (typically the CVE ID)"
                },
                "cve_id": {
                  "type": "string",
                  "description": "Common Vulnerabilities and Exposures identifier",
                  "pattern": "^CVE-[0-9]{4}-[0-9]+$"
                },
                "title": {
                  "type": "string",
                  "description": "Title or summary of the vulnerability"
                },
                "description": {
                  "type": "string",
                  "description": "Detailed description of the vulnerability"
                },
                "published_date": {
                  "type": ["integer", "string"],
                  "description": "Date when the vulnerability was published (Unix timestamp or ISO 8601 string)"
                },
                "last_modification_date": {
                  "type": ["integer", "string"],
                  "description": "Date of the last modification to the vulnerability record"
                },
                "cvss": {
                  "type": "object",
                  "description": "Common Vulnerability Scoring System information",
                  "properties": {
                    "score": {
                      "type": "number",
                      "description": "CVSS base score (0.0-10.0)",
                      "minimum": 0,
                      "maximum": 10
                    },
                    "severity": {
                      "type": "string",
                      "description": "Severity rating based on CVSS score",
                      "enum": ["NONE", "LOW", "MEDIUM", "HIGH", "CRITICAL"]
                    },
                    "vector_string": {
                      "type": "string",
                      "description": "CVSS vector string (e.g., CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)"
                    },
                    "version": {
                      "type": "string",
                      "description": "CVSS version used",
                      "enum": ["2.0", "3.0", "3.1", "4.0"]
                    },
                    "base_metrics": {
                      "type": "object",
                      "description": "Detailed CVSS base metrics",
                      "properties": {
                        "attack_vector": {
                          "type": "string",
                          "description": "Attack Vector (NETWORK, ADJACENT, LOCAL, PHYSICAL)"
                        },
                        "attack_complexity": {
                          "type": "string",
                          "description": "Attack Complexity (LOW, HIGH)"
                        },
                        "privileges_required": {
                          "type": "string",
                          "description": "Privileges Required (NONE, LOW, HIGH)"
                        },
                        "user_interaction": {
                          "type": "string",
                          "description": "User Interaction (NONE, REQUIRED)"
                        },
                        "scope": {
                          "type": "string",
                          "description": "Scope (UNCHANGED, CHANGED)"
                        },
                        "confidentiality_impact": {
                          "type": "string",
                          "description": "Confidentiality Impact (NONE, LOW, HIGH)"
                        },
                        "integrity_impact": {
                          "type": "string",
                          "description": "Integrity Impact (NONE, LOW, HIGH)"
                        },
                        "availability_impact": {
                          "type": "string",
                          "description": "Availability Impact (NONE, LOW, HIGH)"
                        }
                      }
                    }
                  },
                  "required": ["score", "severity"]
                },
                "cvss_v2": {
                  "type": "object",
                  "description": "CVSS v2 score information (legacy)",
                  "properties": {
                    "score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 10
                    },
                    "vector_string": {
                      "type": "string"
                    }
                  }
                },
                "cvss_v3": {
                  "type": "object",
                  "description": "CVSS v3 score information",
                  "properties": {
                    "score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 10
                    },
                    "vector_string": {
                      "type": "string"
                    }
                  }
                },
                "cwe_id": {
                  "type": "string",
                  "description": "Common Weakness Enumeration identifier",
                  "pattern": "^CWE-[0-9]+$"
                },
                "references": {
                  "type": "array",
                  "description": "External references and resources about the vulnerability",
                  "items": {
                    "type": "string",
                    "format": "uri"
                  }
                },
                "vendor": {
                  "type": "string",
                  "description": "Affected vendor name"
                },
                "product": {
                  "type": "string",
                  "description": "Affected product name"
                },
                "affected_versions": {
                  "type": "array",
                  "description": "List of affected product versions",
                  "items": {
                    "type": "string"
                  }
                },
                "exploitability": {
                  "type": "object",
                  "description": "Information about exploit availability",
                  "properties": {
                    "exploit_available": {
                      "type": "boolean",
                      "description": "Whether a known exploit exists"
                    },
                    "exploit_types": {
                      "type": "array",
                      "description": "Types of available exploits",
                      "items": {
                        "type": "string"
                      }
                    },
                    "epss_score": {
                      "type": "number",
                      "description": "Exploit Prediction Scoring System score (0.0-1.0)",
                      "minimum": 0,
                      "maximum": 1
                    }
                  }
                },
                "tags": {
                  "type": "array",
                  "description": "Tags categorizing the vulnerability",
                  "items": {
                    "type": "string"
                  }
                },
                "mitre_attack_techniques": {
                  "type": "array",
                  "description": "MITRE ATT&CK techniques associated with exploitation",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "description": "MITRE technique ID (e.g., 'T1190')"
                      },
                      "name": {
                        "type": "string",
                        "description": "Name of the technique"
                      }
                    }
                  }
                }
              },
              "required": ["type", "id", "cve_id"]
            }
          },
          "links": {
            "type": "object",
            "description": "Pagination links for additional results",
            "properties": {
              "self": {
                "type": "string",
                "description": "Link to the current page of results"
              },
              "next": {
                "type": "string",
                "description": "Link to the next page of results (if available)"
              }
            }
          }
        },
        "required": ["vulnerabilities_count", "entity", "entity_type", "vulnerabilities"]
      }
    }
  },
  "slug": "get_vulnerability_associations_in_gti"
}
