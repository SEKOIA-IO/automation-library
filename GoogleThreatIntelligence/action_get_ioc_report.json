{
  "uuid": "6ac3766d-92ee-40ab-80f4-af3a2a73d44d",
  "name": "Get IoC Report",
  "description": "Get threat intelligence report for an IP address, domain, URL, or file hash from Google Threat Intelligence (VirusTotal)",
  "docker_parameters": "GTIIoCReport",
  "arguments": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "Arguments",
    "properties": {
      "ip": {
        "type": "string",
        "description": "IP address to query (e.g., 8.8.8.8)",
        "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"
      },
      "domain": {
        "type": "string",
        "description": "Domain name to query (e.g., google.com)",
        "pattern": "^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?\\.[a-zA-Z]{2,}$"
      },
      "url": {
        "type": "string",
        "description": "URL to query (e.g., https://example.com/path)",
        "format": "uri"
      },
      "file_hash": {
        "type": "string",
        "description": "File hash to query (MD5, SHA1, or SHA256)",
        "pattern": "^[a-fA-F0-9]{32}$|^[a-fA-F0-9]{40}$|^[a-fA-F0-9]{64}$"
      }
    },
    "oneOf": [
      {"required": ["ip"]},
      {"required": ["domain"]},
      {"required": ["url"]},
      {"required": ["file_hash"]}
    ]
  },
  "results": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "Results",
    "properties": {
      "success": {
        "type": "boolean",
        "description": "Whether the operation was successful"
      },
      "data": {
        "type": "object",
        "description": "IoC report data",
        "properties": {
          "entity_type": {
            "type": "string",
            "description": "Type of entity queried (ip_addresses, domains, urls, files)"
          },
          "entity": {
            "type": "string",
            "description": "The entity value that was queried"
          },
          "id": {
            "type": "string",
            "description": "VirusTotal object ID"
          },
          "reputation": {
            "type": "integer",
            "description": "Reputation score"
          },
          "last_analysis_stats": {
            "type": "object",
            "description": "Statistics from last analysis",
            "properties": {
              "harmless": {"type": "integer"},
              "malicious": {"type": "integer"},
              "suspicious": {"type": "integer"},
              "undetected": {"type": "integer"}
            }
          },
          "detections": {
            "type": "object",
            "description": "Detection summary",
            "properties": {
              "harmless": {"type": "integer"},
              "malicious": {"type": "integer"},
              "suspicious": {"type": "integer"},
              "undetected": {"type": "integer"}
            }
          },
          "country": {
            "type": "string",
            "description": "Country code (for IPs)"
          },
          "asn": {
            "type": "integer",
            "description": "Autonomous System Number (for IPs)"
          },
          "as_owner": {
            "type": "string",
            "description": "AS owner name (for IPs)"
          },
          "categories": {
            "type": "object",
            "description": "Domain categories"
          },
          "sha256": {
            "type": "string",
            "description": "SHA256 hash (for files)"
          },
          "md5": {
            "type": "string",
            "description": "MD5 hash (for files)"
          },
          "sha1": {
            "type": "string",
            "description": "SHA1 hash (for files)"
          },
          "size": {
            "type": "integer",
            "description": "File size in bytes (for files)"
          },
          "type_description": {
            "type": "string",
            "description": "File type description (for files)"
          }
        }
      }
    }
  },
  "slug": "get_ioc_report_in_gti"
}