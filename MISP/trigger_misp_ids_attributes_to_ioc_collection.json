{
  "uuid": "9bfd6d9d-3f64-4ec0-bdb5-6253677af677",
  "name": "MISP IDS Attributes to IOC Collection",
  "docker_parameters": "trigger-misp-ids-to-ioc-collection",
  "description": "Periodically retrieves IDS-flagged attributes from a MISP instance and pushes them to a Sekoia.io IOC Collection",
  "arguments": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "MISP IDS Attributes to IOC Collection Configuration",
    "properties": {
      "ioc_collection_server": {
        "type": "string",
        "description": "Sekoia.io API server URL for your region",
        "default": "https://api.sekoia.io",
        "examples": ["https://api.sekoia.io", "https://api.eu.sekoia.io"]
      },
      "ioc_collection_uuid": {
        "type": "string",
        "description": "UUID of the pre-created IOC Collection in Sekoia.io",
        "pattern": "^ioc-collection--[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",
        "examples": ["ioc-collection--12345678-1234-1234-1234-123456789abc"]
      },
      "sekoia_api_key": {
        "type": "string",
        "description": "Sekoia.io API key with write permissions to the IOC Collection",
        "pattern": "^sio_.*",
        "secret": true
      },
      "publish_timestamp": {
        "type": "string",
        "description": "Number of days from which IOCs should be retrieved (negative integer, e.g., '-7' for last 7 days)",
        "default": "1",
        "examples": ["1", "7", "30"]
      },
      "sleep_time": {
        "type": "integer",
        "description": "Time in seconds the trigger sleeps between checks for new attributes",
        "default": 300,
        "minimum": 60,
        "examples": [60, 300, 600]
      }
    },
    "required": [
      "ioc_collection_server",
      "ioc_collection_uuid",
      "sekoia_api_key"
    ]
  }
}