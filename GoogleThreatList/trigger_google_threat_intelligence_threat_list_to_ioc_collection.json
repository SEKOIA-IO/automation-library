{
  "uuid": "b2c3d4e5-6f7a-4b5c-9d0e-1f2a3b4c5d6e",
  "name": "Google Threat Intelligence Threat List to IOC Collection",
  "slug": "trigger-google-threat-intelligence-threat-list-to-ioc-collection",
  "description": "Google Threat Intelligence Threat List to IOC Collection",
  "docker_parameters": "trigger-google-threat-intelligence-threat-list-to-ioc-collection",
  "arguments": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "GoogleThreatIntelligenceThreatListToIOCCollectionTrigger Configuration",
    "properties": {
      "google_threat_list_url": {
        "type": "string",
        "description": "Google Threat Intelligence Server URL"
      },
      "google_threat_list_api_key": {
        "type": "string",
        "description": "API Key for authentication",
        "secret": true
      },
      "sleep_time": {
        "type": "integer",
        "default": 300,
        "description": "Time in seconds to wait between polling cycles"
      },
      "ioc_collection_uuid": {
        "type": "string",
        "description": "SEKOIA.IO IOC Collection UUID to populate"
      },
      "threat_list_id": {
        "type": "string",
        "description": "Single threat list to monitor",
        "enum": [
          "ransomware",
          "malicious-network-infrastructure",
          "malware",
          "threat-actor",
          "trending",
          "mobile",
          "osx",
          "linux",
          "iot",
          "cryptominer",
          "phishing",
          "first-stage-delivery-vectors",
          "vulnerability-weaponization",
          "infostealer"
        ]
      },
      "ioc_types": {
        "type": "array",
        "description": "Types of IoCs to retrieve",
        "default": ["file", "url", "ip_address", "domain"]
      },
      "max_iocs": {
        "type": "integer",
        "description": "Maximum number of IoCs to retrieve per execution",
        "default": 4000
      },
      "polling_frequency_hours": {
        "type": "integer",
        "description": "Hours between each poll (1-24)",
        "default": 1
      },
      "extra_query_params": {
        "type": "string",
        "description": "Advanced filtering query (optional)"
      },
      "sekoia_api_key": {
        "type": "string",
        "description": "SEKOIA.IO API Key for IOC Collection",
        "secret": true
      },
      "sekoia_base_url": {
        "type": "string",
        "description": "SEKOIA.IO API base URL",
        "default": "https://api.sekoia.io"
      }
    },
    "required": [
      "google_threat_list_url",
      "google_threat_list_api_key",
      "ioc_collection_uuid",
      "threat_list_id",
      "sekoia_api_key"
    ]
  },
  "results": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "title": "Event Output",
    "properties": {}
  }
}
