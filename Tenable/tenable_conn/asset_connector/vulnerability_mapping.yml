mapping:
  ocsf_class: "vulnerability_finding"
  version: "1.6.0"
  fields:
    - source: "vuln.state"
      target: "activity_id"
      type: "integer"
      description: "Vulnerability state mapped to OCSF activity ID (OPEN=1, REOPENED=2, FIXED=3)"

    - source: "vuln.state"
      target: "activity_name"
      type: "string"
      description: "Activity name derived from vulnerability state (Create, Updated, Close)"

    - source: "static: Findings"
      target: "category_name"
      type: "string"
      description: "Fixed OCSF category for security findings"

    - source: "static: 2"
      target: "category_uid"
      type: "integer"
      description: "OCSF category UID for Findings"

    - source: "static: Vulnerability Finding"
      target: "class_name"
      type: "string"
      description: "OCSF class for vulnerability findings"

    - source: "static: 2002"
      target: "class_uid"
      type: "integer"
      description: "OCSF class UID for Vulnerability Finding"

    - source: "computed: 200200 + activity_id"
      target: "type_uid"
      type: "integer"
      description: "Computed type UID: base 200200 + activity_id"

    - source: "computed: 'Vulnerability Finding: ' + activity_name"
      target: "type_name"
      type: "string"
      description: "Formatted type name including activity name"

    - source: "vuln.first_found"
      target: "time"
      type: "timestamp"
      description: "Primary event timestamp (first discovery date)"

    # METADATA
    - source: "static: Tenable"
      target: "metadata.product.name"
      type: "string"
      description: "Source product name"

    - source: "vuln.plugin.version"
      target: "metadata.product.version"
      type: "string"
      description: "Tenable plugin version"

    - source: "static: 1.6.0"
      target: "metadata.version"
      type: "string"
      description: "OCSF schema version used"

    # FINDING INFORMATION
    - source: "vuln.finding_id"
      target: "finding_info.uid"
      type: "string"
      description: "Unique Tenable finding identifier"

    - source: "vuln.plugin.type"
      target: "finding_info.types"
      type: "list[string]"
      description: "Tenable plugin type wrapped in a list"

    - source: "vuln.source"
      target: "finding_info.data_sources"
      type: "list[string]"
      description: "Tenable data source wrapped in a list"

    - source: "vuln.plugin.name"
      target: "finding_info.title"
      type: "string"
      description: "Plugin name as finding title"

    - source: "vuln.plugin.synopsis || vuln.plugin.description"
      target: "finding_info.desc"
      type: "string"
      description: "Plugin synopsis, falls back to description if absent"

    - source: "vuln.plugin.see_also[0]"
      target: "finding_info.src_url"
      type: "string"
      description: "First reference URL from plugin"

    - source: "vuln.first_found"
      target: "finding_info.first_seen_time"
      type: "timestamp"
      description: "First discovery date converted to Unix timestamp"

    - source: "vuln.last_found"
      target: "finding_info.last_seen_time"
      type: "timestamp"
      description: "Last observation date converted to Unix timestamp"

    - source: "vuln.plugin.publication_date"
      target: "finding_info.created_time"
      type: "timestamp"
      description: "Plugin publication date converted to Unix timestamp"

    - source: "static: Tenable Vulnerability Management"
      target: "finding_info.product.name"
      type: "string"
      description: "Vulnerability management product name"

    - source: "static: N/A"
      target: "finding_info.product.version"
      type: "string"
      description: "Product version (not available via API)"

    - source: "static: [{phase: Other, phase_id: 99}]"
      target: "finding_info.kill_chain"
      type: "list[object]"
      description: "Default kill chain phase (Other)"

    # VULNERABILITIES
    - source: "vuln.plugin.cve"
      target: "vulnerabilities[].cve.uid"
      type: "string"
      description: "Individual CVE identifiers (one object per CVE)"

    - source: "static: CVE"
      target: "vulnerabilities[].cve.type"
      type: "string"
      description: "Vulnerability type fixed to CVE"

    - source: "vuln.plugin.cvss_base_score"
      target: "vulnerabilities[].cve.cvss[]"
      type: "object"
      description: "CVSS v2.0 score wrapped in OCSF CVSS object"

    - source: "vuln.plugin.cvss3_base_score"
      target: "vulnerabilities[].cve.cvss[]"
      type: "object"
      description: "CVSS v3.0 score wrapped in OCSF CVSS object"

    - source: "vuln.plugin.description"
      target: "vulnerabilities[].cve.desc"
      type: "string"
      description: "Detailed plugin description"

    - source: "vuln.plugin.name"
      target: "vulnerabilities[].cve.title"
      type: "string"
      description: "Plugin name as CVE title"

    - source: "vuln.plugin.name"
      target: "vulnerabilities[].title"
      type: "string"
      description: "Vulnerability title"

    - source: "vuln.plugin.description"
      target: "vulnerabilities[].desc"
      type: "string"
      description: "Vulnerability description"

    - source: "vuln.plugin.see_also"
      target: "vulnerabilities[].references"
      type: "list[string]"
      description: "List of reference URLs"

    - source: "vuln.severity"
      target: "vulnerabilities[].severity"
      type: "string"
      description: "Tenable severity converted to lowercase"

    - source: "static: Tenable"
      target: "vulnerabilities[].vendor_name"
      type: "string"
      description: "Vulnerability vendor name"

    # DEVICE
    - source: "asset_info.id"
      target: "device.uid"
      type: "string"
      description: "Tenable asset UUID"

    - source: "asset_info.system_type[0]"
      target: "device.type"
      type: "string"
      description: "Device type mapped from system_type"

    - source: "asset_info.system_type[0]"
      target: "device.type_id"
      type: "integer"
      description: "OCSF device type ID"

    - source: "asset_info.hostname[0] || asset_info.name || asset_info.fqdn[0]"
      target: "device.hostname"
      type: "string"
      description: "Hostname with fallback to name then fqdn"

    - source: "asset_info.name"
      target: "device.name"
      type: "string"
      description: "Tenable asset name"

    - source: "asset_info.ipv4[0]"
      target: "device.ip"
      type: "ip"
      description: "First IPv4 address of the asset"

    - source: "asset_info.operating_system[0]"
      target: "device.os.name"
      type: "string"
      description: "Operating system name"

    - source: "asset_info.operating_system[0]"
      target: "device.os.type"
      type: "string"
      description: "OS type mapped from name"

    - source: "asset_info.operating_system[0]"
      target: "device.os.type_id"
      type: "integer"
      description: "OCSF OS type ID"

    - source: "asset_info.interfaces"
      target: "device.network_interfaces"
      type: "list[object]"
      description: "Network interfaces list built from interfaces[]"

    - source: "asset_info.aws_region[0] || azure_location[0] || gcp_zone[0]"
      target: "device.location.city"
      type: "string"
      description: "Cloud region as geographic location"

    - source: "asset_info.first_seen"
      target: "device.first_seen_time"
      type: "timestamp"
      description: "First observation of the asset"

    - source: "asset_info.last_seen"
      target: "device.last_seen_time"
      type: "timestamp"
      description: "Last observation of the asset"

    - source: "asset_info.created_at"
      target: "device.created_time"
      type: "timestamp"
      description: "Asset creation date in Tenable"

    - source: "asset_info.has_agent"
      target: "device.is_managed"
      type: "boolean"
      description: "Indicates if the asset has a Tenable agent installed"

    - source: "static: Tenable"
      target: "device.vendor_name"
      type: "string"
      description: "Device information vendor"

    # CONFIDENCE
    - source: "vuln.plugin.vpr_v2.score"
      target: "confidence_score"
      type: "integer"
      description: "VPR v2 score converted to integer"

    - source: "vuln.plugin.vpr_v2.score"
      target: "confidence"
      type: "string"
      description: "Textual confidence level based on VPR score"

    - source: "vuln.plugin.vpr_v2.score"
      target: "confidence_id"
      type: "integer"
      description: "OCSF confidence ID (3=High, 2=Medium, 1=Low)"
